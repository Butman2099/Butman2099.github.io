{"title":"Лабораторна робота № 6","markdown":{"yaml":{"title":"Лабораторна робота № 6"},"headingText":"Теоретичні відомості","containsRefs":false,"markdown":"\n\n\n\n\n**Тема.** Фрактальний аналіз складних систем.\n \n**Мета.** Навчитися використовувати методи монофрактального аналізу для дослідження нелінійних характеристик складних систем. \n\n\n\n\n### Означення фрактала\n\n**Фракталами** називають геометричні об'єкти: лінії, поверхні, просторові тіла, що мають сильно шорстку поверхню або форму і характеризуються властивістю самоподібності. Слово фрактал походить від латинського слова *fractus* і перекладається як дробовий, ламаний. Самоподібність як основна характеристика фрактала означає, що він більш-менш однорідно змінюється при широкому діапазоні масштабів. Так, при збільшенні маленькі фрагменти фрактала виходять дуже схожими на великі. В ідеальному випадку така самопподібність призводить до того, що  фрактальний об'єкт виявляється інваріантним щодо розтягувань, тобто йому, як кажуть, притаманна дилатаційна симетрія. Вона передбачає незмінність основних геометричних особливостей фрактала при зміні масштабу.\n\nОчевидно, що фрактальні об'єкти реального світу не є нескінченно самоподібними й існує мінімальний масштаб $l_{min}$, такий, що на масштабі $l \\approx l_{min}$ властивість самоподібності зникає. Окрім цього, на достатньо великих масштабах довжин $l > l_{max}$, де $l_{max}$ --- характерний геометричний розмір об'єктів, ця властивість самоподібності також порушується. Тому властивості природніх фракталів розглядаються лише на масштабах $l$, що задовільняють відношення $l_{min} \\ll l \\ll l_{max}$. Такі обмеження природні, оскільки, коли ми приводимо в якості прикладу фракталу --- ламану, негладку траєкторію броунівської частинки, то ми розуміємо, що цей образ представляє очевидну ідеалізацію. Справа в тому, що на малих масштабах приховується граничність маси і розмірів броунівської частнки, а також кінцевість часу зіткнення. При врахуванні цих обставин траєкторія броунівської частинки починає представляти гладку криву. \n\nВарто зазначити, що властивість точної самоподібності характерна лише для **регулярних фракталів**. Якщо замість детермінованого способу побудови включити в алгоритм їхнього створення деякий елемент випадковості (як це буває, наприклад, у багатьох процесах диференційованого зростання кластерів, електричному пробої тощо), то виникають так звані **випадкові фрактали**. Основна їхня відмінність від регулярних полягає в тому, що властивості самоподібності є справедливими тільки після відповідного усереднення за всіма статистично незалежними реалізаціями об'єкта. При цьому збільшена частина фрактала не точно ідентична вихідному фрагменту, проте їхні статистичні характеристики збігаються.\n\n### Довжина берегової лінії\n\n::: {#fig-costline}\n\n![](Images\\lab_6\\costline.jpg)\n\nВизначення довжини берегової лінії між точками А та В\n\n:::\n\nПершочергово поняття фрактала у фізиці виникло у зв'язку із завданням про визначення довжини берегової лінії. Під час її вимірювання за наявною картою місцевості з'ясувалася цікава деталь --- чим більш великомасштабна карта береться, тим довшою виявляється ця берегова лінія. Нехай, наприклад, відстань по прямій між розсташованими на береговій лінії точками А та В дорівнює R (див. @fig-costline). Тоді, щоб виміряти довжину берегової лінії між цима точками, ми розташуємо по берегу  жорстко пов'язані один з одним вузол так, що відстань між сусідніми вузлами дорівнювала б, наприклад, $l=10$ км. Довжину берегової лінії в кілометрах між точками А і В ми приймемо тоді рівною числу вузлів мінус 1, помноженому на 10. Наступне вимірювання цієї довжини ми зробимо так само, але відстань між сусідніми вузлами зробимо вже рівною $l=1$ км.\n\nВиявляється, що результат цих вимірювань буде різним. При зменшенні масштабу $l$ ми отримуватимемо все більші й більші значення довжини. На відміну від гладкої кривої, лінія морського узбережжя виявляється найчастіше настільки порізаною (аж до найменших масштабів), що зі зменшенням довжини ланки $l$ величина $L$ --- довжина берегової лінії --- не прагне до кінцевого межі, а збільшується за степеневим законом \n\n$$ \nL \\approx l\\left( \\frac{R}{l} \\right)^{D}, \\tag{1}\n$$\n\nде $D > 1$ --- деякий степеневий показник, котрий іменується **фрактальною розмірністю** берегової лінії. Чим більше значення $D$, тим більш ломаною або деталізованою представляється ця берегова лінія. Походження залежності (1) має бути інтуїтивно зрозумілим: чим менший масштаб ми використовуємо, тим меньші деталі узбережжя будуть враховані і тим менший вклад вони внесуть у вимірювану довжину. Навпаки, збільшуючи масштаб, ми \"розгортаємо\" узбережжя, зменшуючи довжину $L$. \n\nТаким чином, ми бачимо, що для визначення довжини берегової лінії $L$ за допомогою жорсткого масштабу $l$, необхідно зробити $N=L/l$ кроків, причому величина $L$ змінюється з $l$ так, що $N$ залежить від $l$ за законом $N \\approx (R/I)^{D}$. У результаті зі зменшенням масштабу довжина берегової лінії необмежено зростає. Ця обставина різко відрізняє фрактальну криву від звичайної гладкої кривої (типу кола, еліпса), для якої межа довжини апроксимованої ламаної $L$, яка апроксимує, за наближення до нуля довжини її ланки $l$ є скінченною. У результаті для гладкої кривої її фрактальна розмірність $D = 1$, тобто збігається з топологічною.\n\n\n### Фрактальна розмірність множин\n\nВище було введено поняття про фрактальну розмірність берегової лінії. Дамо тепер загальне визначення цієї величини. Нехай $d$ --- звичайна Евклідова розмірність простору, в якому розташований наш фрактальний об'єкт ($d=1$ --- лінія, $d=2$ --- площина, $d=3$ --- звичайний тривимірний простір). Покриємо тепер цей об'єкт цілком $d$-мірними \"кулями\" радіуса 1. Припустимо, що нам потребувалося для цього не менше, ніж $N(l)$ куль. Тоді, якщо за досить малих $l$ величина $N(l)$ змінюється з $l$ за степеневим законом\n\n$$\nN(l) \\sim \\frac{1}{l^D}, \\tag{2}\n$$\n\nтоді $D$ --- називається **хаусдорфовою** або **фрактальною розмірністю** цього об'єкта. Очевидно, що ця формула еквівалентна відношеню $N \\approx \\left( R/l \\right)^{D}$, що використовувалось вище для визначення довжини берегової лінії. \n\nФормулу (2) можна переписати у вигляді\n\n$$\nD = -\\lim_{l \\to 0} \\frac{\\ln{N(l)}}{\\ln{l}}. \\tag{3}\n$$\n\nЦе відношення й слугує загальним визначенням фрактальної розмірності $D$. У відповідності до нього величина $D$ представляє **локальну** характеристику досліджуваного об'єкта. \n\n### Процедури обчислення монофрактальних розмірностей\n\nНаразі існує багато визначень та методів вимірювання фрактальної розмірності. Найпоширенішими одновимірними фрактальними розмірностями є розмірність Хаусдорфа, розмірність Хігучі, розмірність Петросяна та Коробчаста розмірність. Розмірність Хаусдорфа є найпростішою фрактальною розмірністю. Але її обчислювальна складність є високою, що ускладнює її практичне застосування. Коробкова розмірність є відносно простою, і фрактальну розмірність сигналу можна отримати, регулюючи розмір довжини сторони коробки. Тому вона є широко впізнаваємою та застосовуваною. Який показник фрактальної розмірності найточніше описує складність сигналу та здатний ідентифікувати кризові явища і представляє ключовий момент цієї лабораторної роботи.\n\n#### *R/S*-аналіз\n\nМетод *R/S*-аналізу, розроблений Мандельбротом та Уоллесом, базується на попередньо створеному методі гідрологічного аналізу Херста, і дозволяє обчислювати параметр самоподібності $H$, який вимірює інтенсивність довготривалих залежностей у \nчасовому ряді. Коефіцієнт $H$, який називають коефіцієнтом Херста, містить мінімальні прогнози стосовно природи системи, що вивчається, і може класифікувати часові ряди. За допомогою цього показника розрізняють випадкові (гаусові) та невипадкові ряди; окрім того, він пов’язаний із фрактальною розмірністю, що, у свою чергу, характеризує ступінь згладженості графіка, побудованого на основі часового ряду. Методом *R/S*-аналізу можливо також виявити максимальну довжину інтервалу (цикл), на якому значення зберігають інформацію про початкові дані системи (довготривала пам’ять). \n\nАналіз починається з побудови ряду логарифмічних прибутковостей, $G(t) \\equiv \\ln{x(t + \\Delta t)} - \\ln{x(t)}$, де $x(t)$ --- значення вихідного часового ряду в момент $t$, $\\Delta t$ --- часовий крок. Отримана послідовність $G(t)$ розбивається на $d$ підпослідовностей довжини $n$. \n\nДля кожної підпослідовності $m=1,...,d$:\n\n1. шукається середнє значення $\\mu_m$ та стандартне відхилення $S_m$; \n2. дані нормалізуються шляхом віднімання середнього значення послідовності $X_{i,m}=G_{i,m}-\\mu_m$, $i=1,...,n$; \n3. знаходиться кумулятивна сума послідовності $X$ів: $Y_{i,m}=\\sum_{j=1}^{i}X_{j,m}$, $i=1,...,n$; \n4. у межах кожної підпослідовності знаходиться розмах між максимальним та мінімальним значеннями: $R_m = \\max\\{Y_{1,m},...,Y_{n,m}\\}-\\min\\{Y_{1,m},...,Y_{n,m}\\}$, який стандартизується середнім квадратичним відхиленням $R_{m}/S_{m}$; \n5. обчислюється середнє $(R/S)_n$ нормованих значень розмаху для всіх підпослідовностей довжини $n$.  \n\n*R/S*-статистика, обрахована таким чином, відповідає співвідношенню $(R/S)_{n} \\cong cn^{H}$, де значення $H$ може бути отримане шляхом обчислення $(R/S)_n$ для послідовностей інтервалів зі збільшенням часового горизонту:\n\n$$\n\\log{(R/S)}_{n} = \\log{c} + H\\log{n}. \\tag{4}\n$$\n\nЗнайти коефіцієнт Херста можна, побудувавши залежність $(R/S)_n$ vs. $n$ у подвійному логарифмічному масштабі і взявши коефіцієнт нахилу прямої, яка інтерполює точки отриманого графіка. Якщо значення $H=0.5$, говорять про послідовність, що представляє собою білий шум; $0.5 < H \\leq 1$ свідчить про персистентний ряд, коли існує тенденція слідування великих значень ряду за великими і навпаки; $H<0.5$ вказує на антиперсистентний ряд.\n\nПри збільшенні часового горизонту коефіцієнт нахилу інтерполюючої прямої повинен прямувати до значення $H=0.5$; сам процес переходу свідчить про втрату впливу початкових умов на поточні значення, і, таким чином, можна говорити про горизонт довгої пам’яті --- це точка, до якої коефіцієнт нахилу інтерполюючої прямої відмінний від 0.5, а після --- близько 0.5. \n\n::: {.callout-note}\n## Примітка до *R/S*-аналізу\n\nМіж фрактальною розмірністю та показником Херста також існує зв'язок\n\n$$\nD_f = 2-H. \n$$\n\nЯкщо для берегової лінії ми визначали масштабування її довжини $L$ в залежності від зміни $l$, то у випадку з *R/S*-аналізом ми визначаємо зміну нормованого розмаху значень ряду в межах масштабу $n$.\n \n:::\n\n#### Аналіз детрендованих флуктуацій\n\nАналіз детрендований флуктуацій (Detrended fluctuation analysis, DFA) базується на гіпотезі про те, що корельований часовий ряд може бути \nвідображений на самоподібний процес шляхом інтегрування. Таким чином, вимірювання властивостей самоподібності може непрямо свідчити про кореляційні властивості ряду. Переваги АДФ порівняно з іншими методами (спектральний аналіз, *R/S*-аналіз) полягають в тому, що він виявляє довгочасові кореляції нестаціонарних часових рядів, а також дозволяє ігнорувати очевидні випадкові кореляції, що є наслідком нестаціонарності. \n\nІснують DFA різних порядків, що відрізняються трендами, які вилучаються з даних. \n\nРозглянемо DFA найнижчого порядку.\n\n1. Для часового ряду довжини $N$ знаходиться кумулятивна сума, $y(k)=\\sum_{i=1}^{k}\\left( x_i - \\bar{x} \\right)$, де $x_i$ --- це $i$-те значення часового ряду, $\\bar{x}$ --- його середнє значення, $k=1,...,N$.\n2. Отриманий ряд $y(k)$ розбивається на $m$ підпослідовностей (вікон) однакової ширини $n$ і для кожної підпослідовності (у кожному вікні) виконується наступне:\n    - за допомогою методу найменших квадратів знаходиться локальний лінійний тренд $y_{t}(k)$;  \n    - підпослідовність детрендується шляхом віднімання значення локального тренду $y_{t}(k)$ від значень ряду $y(k)$, що належать послідовності $t$;\n    - знаходиться середнє $\\bar{y_t}$ детрендований значень. \n\nДля отриманих таким чином значень на всіх підпослідовностях знаходиться:\n\n$$\nF_n = \\sqrt{\\frac{1}{m}\\bar{y_t}}, \n$$\n\nде $n$ --- кількість точок у підпослідовності (ширина вікна), $m$ --- кількість підпослідовностей, $\\bar{y_t}$ --- середнє детрендованих значень для підпослідовності $t$. \n\nВказана процедура повторюється для різних значень $n$, внаслідок чого ми отримує набір залежностей $F_n$ від $n$. Побудова залежності $\\log{F(n)}$ від $\\log{n}$ та інтерполяція отриманих значень лінією регресії дає змогу обчислити показник скейлінга $\\alpha$, що є коефіцієнтом кута нахилу інтерполяційної прямої і характеризує зміну кореляцій флуктуацій часового ряду $F_n$ при збільшенні часового інтервалу $n$. \n\nПорівняно із *R/S*-аналізом, DFA дає більші можливості інтерпретації скейлінгового показника $\\alpha$: \n\n- для випадкового ряду (перемішаного чи \"сурогатного\") $\\alpha = 0.5$; \n- при наявності лише короткочасових кореляцій $\\alpha$ може відрізнятись від 0.5, проте має тенденцію прямувати до 0.5 при збільшенні розміру вікна;\n- Значення $0.5 < \\alpha \\leq 1.0$ показує персистентні довгочасові кореляції, що відповідають степеневому закону; \n- $0 < \\alpha < 0.5$ означає антиперсистентний ряд; \n- cпеціальний випадок, коли $\\alpha = 1$, означає наявність $1/f$ шуму. \n- для випадків, коли $\\alpha \\geq 1$, кореляції існують, проте перестають відображувати степеневу залежність;\n- випадок $\\alpha = 1.5$ свідчить про Броунівський шум, інтегрований білий шум.\n\nУ випадку степеневої залежності функції автокореляцій спостерігається спад автокореляції з показником $\\gamma$:\n\n$$\nC(L) \\sim L^{-\\gamma}.\n$$ \n\nНа додачу до цього, спектральна густина також спадає за степеневим законом: \n\n$$\nP(f) \\sim f^{-\\beta}. \n$$\n\nВідповідні показники виражаються через наступні відношення:\n\n- $\\gamma=2-2\\alpha$; \n- $\\beta=2\\alpha-1$. \n\nУ DFA другого порядку (DFA2) обчислюються відхилення $F^2(v,s)$ профілю від інтерполяційного многочлена другого порядку. Таким чином, вилучаються впливи \nможливих лінійних та параболічних трендів для масштабів, більших за розглядувані. Взагалі, у DFA порядку $n$ обчислюються відхилення профілю від інтерполяційного многочлена $n$-го порядку, що вилучає вплив всіх можливих трендів порядків до ($n-1$) для масштабів, більших від розміру вікна. \n\nПотім обчислюється найближчий поліном $y_{ν}(s)$ для профілю на кожному із $2N_s$ сегментів $v$ і визначається відхилення\n\n$$\nF^2(v,s) \\equiv \\frac{1}{s}\\sum_{i=1}^{s}\\left( x_{(v-1)s+i} - y_{i}(i) \\right)^{2}. \\tag{5}\n$$\n\nДалі знаходиться середнє значення флуктуацій всіх детрендованих профілів:\n\n$$\nF_2(s) \\equiv \\sqrt{\\left( \\frac{1}{2N_s} \\sum_{v=1}^{2N_s}F^{2}(v,s) \\right)}. \\tag{6}\n$$\n\nЗначення формули (6) можна трактувати як середньоквадратичний зсув (переміщення) точки випадкових блукань у ланцюжку після $s$ кроків. \n\n#### Фрактальна розмірність Хігучі\n\nФрактальна розмірність Хігучі --- це один з різновидів монофрактальної розмірності, яка визначається наступним чином:\n\nПрипустимо, що у нас є часовий ряд \n\n$$\nx(1), x(2),...,x(N)\n$$\n\nі реконструйований часовий ряд $x_{m}^{k}$: \n\n\\begin{align*}\nx_{m}^{k} = \\{ x(m), x(m+k), x(m+2k), ..., \\\\\n x\\left( m+\\left[ \\frac{N-m}{k} \\right] \\cdot k \\right) \\}, \n\\end{align*}\n\nдля $m=1,2,...,k$; де $m$ представляє початковий час; $k=2,...,k_{max}$ представляють ступінь часового зміщення. Позначення $[\\cdot]$ представляє цілу частину $x$. Для кожного реконструйованого часового ряду $x_{m}^{k}$ розраховується середня довжина часової послідовності $L_{m}(k)$: \n\n$$\nL_{m}(k) = \\frac{\\sum_{i=1}^{[\\frac{(N-m)}{k}]} | x(m+ik) - x(m+(i-1)\\cdot k) | \\cdot (N-1)}{[\\frac{N-m}{k}] \\cdot k}\n$$\n\nДалі, для всіх середніх довжин $L_{m}(k)$, знаходиться загальне середнє:\n\n$$\nL(k) = \\frac{1}{k}\\sum_{m=1}^{k}L_{m}(k). \n$$\n\nЗгідно методу Хігучі узагальне середнє значення $L(k)$ пропорційне масштабу $k$, тобто \n\n$$\nL(k) \\propto k^{-D}. \n$$\n\nДалі логарифмуємо обидві сторони й отримуємо наступну рівність:\n\n$$\n\\ln{L(k)} \\propto D \\cdot \\ln{\\left( \\frac{1}{k} \\right)}. \n$$\n\nІнтерполювавши лінію регресії через залежність $\\ln{L(k)}$ від $\\ln{\\left( \\frac{1}{k} \\right)}$, ми можемо отримати показник фрактальності $D$, отримавши кут нахилу цієї лінії. Показник $D$ і представлятиме фрактальну розмірність Хігучі. \n\n#### Фрактальна розмірність Петросяна\n\nСпочатку, для часового ряду $\\{ x_1, x_2,...,y_{N} \\}$, створюємо його дискретизовану (бінарну) версію, $z_i$: \n\n$$\nz_i = \n\\begin{cases}\n    1, & x_i > \\langle x \\rangle, \\\\\n    -1, & x_i \\leq \\langle x \\rangle. \n\\end{cases}\n$$\n\nФрактальну розмірність Петросяна може бути визначена як \n\n$$\nD = \\frac{\\log_{10}{N}}{\\log_{10} + \\log_{10}{\\left( \\frac{N}{N+0.4N_{\\Delta}} \\right)}}, \n$$\n\nде $N_{\\Delta}$ --- кількість загальних змін знаку змінної $z_i$: \n\n$$\nN_{\\Delta} = \\sum_{i=1}^{N-2} \\left|\\frac{z_{i+1}-z_i}{2}\\right|. \n$$\n\n\n\n#### Фрактальна розмірність Каца\n\nПредставимо, що сигнал складається з пари точок $\\left( x_i, y_i \\right)$. Тоді, фрактальна розмірність Каца визначається як\n\n$$\nD = \\frac{\\log{N}}{\\log{N} + \\log{\\frac{d}{L}}}, \n$$\n\nде $L$ визначається наступним чином:\n\n$$\nL = \\sum_{i=0}^{N-2}\\sqrt{\\left( y_{i+1}-y_{i} \\right)^{2} + \\left( x_{i+1}-x_{i} \\right)^{2}}. \n$$\n\nЗначення $d$ визначається як максимальна відстань від початкової точки $\\left( x_1, y_1 \\right)$ до всіх інших точок, а саме $d$ може бути розраховане наступним чином:\n\n$$\nd = \\max{\\left( \\sqrt{\\left( x_i - x_1 \\right)^{2} - \\left( y_i - y_1 \\right)^{2}} \\right)}.\n$$\n\n#### Фрактальна розмірність Севчика\n\nСпочатку, для множини значень $\\left( x_i, y_i \\right)$ виконується нормалізація:\n\n$$\nx_{i}^{*} = \\frac{x_i-x_{min}}{x_{max}-x_{min}}, \\; y_{i}^{*} = \\frac{y_i-y_{min}}{y_{max}-y_{min}}. \n$$\n\nФрактальна розмірність Севчика може бути визначена як\n\n$$\nD = 1 + \\frac{\\ln{L}}{\\ln{[2 \\cdot \\left( N-1 \\right)]}}, \n$$\n\nде $L$ --- це довжина сигналу, що може бути визначена як\n\n$$\nL = \\sum_{i=0}^{N-2}\\sqrt{\\left( y_{i+1}^{*}-y_{i}^{*} \\right)^{2} + \\left( x_{i+1}^{*}-x_{i}^{*} \\right)^{2}}. \n$$\n\n\n#### Фрактальна розмірність через нормалізовану щільність довжини\n\nДаний показник розраховується в наступний спосіб:\n\n1. Для часового ряду $\\{ x_1, x_2,...,x_n \\}$ виконується стандартизація: $y_i = \\frac{x_i - \\mu}{\\sigma}$, де $\\mu$ --- це середнє значення ряду, $\\sigma$ --- це стандартне відхилення. \n2. Розраховується нормалізована щільність довжини:\n\n$$\nNLD = \\frac{1}{N}\\sum_{i=2}^{N}\\left| y_i - y_{i-1} \\right|\n$$\n\nФактичний розрахунок фрактальної розмірності сигналу базується на побудові монотонної калібрувальної кривої, $D = f(NLD)$, за набором функцій Вейєрштрасса, для яких значення $D$ задаються теоретично.\n\n3. Для обчислювальних цілей необхідно створити математичну модель цієї залежності. Автори даного підходу тестували дві моделі:\n    - логарифмічну модель: $D = a \\cdot \\log{\\left(NLD - NLD_{0} \\right)} + C$\n    - степеневу модель: $D = a \\cdot \\left(NLD - NLD_{0} \\right)^{k}$. Бібліотека `neurokit2` використовує саме степеневу модель. Параметр $a=1.9079$, $k=0.18383$ і $NLD_{0}=0.097178$, згідно статті *Kalauzi et al. 2009*. \n\n\n\n#### Фрактальна розмірність через нахил спектральної щільності потужності\n\nФрактальну розмірність можна обчислити на основі аналізу нахилу спектральної щільності потужності (power spectral density slope, PSD) в сигналах, що характеризуються частотною степеневою залежністю.\n\nСпочатку виконується перетворення часового ряду до частотної області і далі сигнал розбивається на синусоїдальні та косинусоїдальні хвилі певної амплітуди, які разом \"складаються\", щоб представити вихідний сигнал. Якщо існує систематичний зв'язок між частотами в сигналі і потужністю цих частот, то в логарифмічних координатах це проявляється в лінійній залежності. Кут нахилу лінії регресії приймається як оцінка фрактальної розмірності.\n\nНахил 0 відповідає білому шуму, а нахил менше 0, але більше -1, відповідає рожевому шуму, тобто шуму $1/f$. Спектральні нахили крутіші за -2 вказують на дробовий броунівський рух, що є втіленням процесів випадкового блукання.\n\n#### Кореляційна розмірність \n\nКореляційна розмірність ($D_2$) --- це похідна величина від кореляційного інтеграла Кореляційний інтеграл (кореляційна сума) може бути поданий в такому вигляді:\n\n$$\nC(\\varepsilon) = \\frac{1}{N^{2}}\\sum_{\\substack{i,j=1 \\\\ i\\neq j}}^{N}\\Theta \\left( \\varepsilon - \\| \\vec{x}(i) - \\vec{x}(j) \\| \\right), \\; \\vec{x}(i) \\in \\Re^{m}. \n$$\n\nСама кореляційна розмірність може бути виведена з наступної степеневої залежності:\n\n$$\nC(\\varepsilon) \\sim \\varepsilon^{\\nu}, \n$$\n\nабо слідуючим чином:\n\n$$\nD_2 = \\lim_{M\\to\\infty}\\lim_{\\varepsilon\\to 0}\\frac{\\log{\\left( g_{\\varepsilon}/N^2 \\right)}}{\\log{\\varepsilon}}, \n$$\n\nде $g_{\\varepsilon}$ --- це сумарна кількість пар точок, відстань між якими менша за радіус $\\varepsilon$. \n\nЗа формулою $C(\\varepsilon)$ ми відбираємо $i$-ту траєкторію та всі інші $j$-ті траєкторії, і дивимося, чи потрапляють $j$-ті траєкторії в округ $i$-ої траєкторії з радіусом $\\varepsilon$. Якщо відстань між ними не перевищує округ зі згаданим радіусом, ми ставимо 1. Але якщо відстань між траєкторіями більша за $\\varepsilon$, тоді ставимо 0. Далі все це підсумовується, ділиться на загальну кількість траєкторій. По суті кореляційний інтеграл це середня ймовірність того, що дві розглянуті траєкторії фазового простору, що розглядаються, будуть знаходитися досить близько одна до одної. Чим тісніше розташовані точки фазового простору одна до одної, тим більше значення кореляційного інтеграла. Чим більш рівновіддаленими видаються траєкторії одна від одної, тим ближче значення кореляційного інтеграла до нуля.   \n\nЗначення кореляційної розмірності ми можемо відшукати аналогічно попередним фрактальним показникам: ми шукаємо залежність кореляційного інтеграла від значення $\\varepsilon$. Ця залежність будується в логарифмічному масштабі. \n\n::: {.callout-tip}\n## Додаткова інформація по кореляційні розмірності\n\nКореляційна розмірність за аналогією з попередніми показниками --- це теж тангенс кута нахилу лінії регресії, побудованої в логарифмічному масштабі, але для залежності кореляційного інтеграла від $\\varepsilon$. За аналогією з іншими показниками, кореляційна розмірність визначає швидкість зміни значення кореляційного інтеграла (крутість нахилу лінії регресії). \n\n:::\n\n\n\n::: {#fig-d2}\n\n![](Images\\lab_6\\corrdim.jpg)\n\nЗміна значення кореляційного інтеграла в залежності від ступеня розкиданості точок по фазовому простору системи\n\n:::\n\nЗа фазовим простором цієї хмари точок ( @fig-d2 ) можна бачити, що більша згуртованість точок одна до одної має асоціюватися з меншою кореляційною розмірністю. Рисунок (а) характеризується найвищою близькістю точок одна до одної, але при цьому найменшою кореляційною розмірністю. Це можна пояснити так: якщо ми будуємо сітку з кіл радіусом $\\varepsilon$ і поступово її збільшуємо, ми вже перестаємо бачити нові прилеглі траєкторії до тих $i$-их траєкторій, які ми розглядали із самого спочатку, на початкових значеннях $\\varepsilon$. На рисунках (b) і (c) видно, що хмара траєкторій фазового простору є більш рівномірно розподіленою. За поступового збільшення радіуса кіл із центрами в кожній $i$-ій траєкторії ми повинні спостерігати пропорційне збільшення значення кореляційного інтеграла. У даному випадку при поступовому збільшенні $\\varepsilon$ ми спостерігаємо появу все більшої і більшої кількості точок. \n\nУ періодичних системах кореляційна розмірність залишається постійною і дорівнює розмірності вкладення. Наприклад, для простої періодичної системи, такої як синусоїда, кореляційна розмірність дорівнюватиме 1 (оскільки вона лежить на одновимірній кривій), а якщо систему реконструюють у двовимірному фазовому просторі (за двома координатами), то кореляційна розмірність дорівнюватиме 2. У таких системах кореляційна розмірність не змінюється. \n\nДля хаотичних систем кореляційна розмірність має характерну поведінку, яка залежить від кількості змінних (розмірностей), необхідних для точного опису динаміки системи. На відміну від періодичних систем, кореляційна розмірність зростає в міру збільшення розмірності фазового простору, поки не досягне плато. \n\n**Електрокардіограма** (ЕКГ):\nЕКГ-сигнали відображають електричну активність серця. Складність ЕКГ-сигналу може бути оцінена за допомогою кореляційної розмірності. Очікується, що кореляційна розмірність ЕКГ здорового серця буде вищою через наявність складних патернів і варіабельності. З іншого боку, аномальні ЕКГ-сигнали, наприклад, від пацієнтів з аритміями або серцевими захворюваннями, можуть мати нижчу кореляційну розмірність через втрату складності сигналу.\n\n**Електроенцефалограма** (ЕЕГ):\nСигнали ЕЕГ реєструють електричну активність мозку. Кореляційна розмірність може використовуватися для аналізу складності мозкової активності, яка може змінюватися залежно від різних когнітивних станів, стадій сну або неврологічних розладів. У здорових людей сигнали ЕЕГ у стані бадьорості та уваги можуть мати вищу кореляційну розмірність порівняно з сигналами у стадії сну, коли активність мозку є більш регулярною і синхронізованою.\n\n**Дихальні сигнали**:\nДихальні сигнали, такі як частота дихання або повітряний потік, також можуть бути проаналізовані за допомогою кореляційної розмірності. Складність цих сигналів може змінюватися залежно від таких факторів, як стрес, фізичне навантаження або наявність респіраторних захворювань. За нормального дихання може спостерігатися вища кореляційна розмірність, тоді як порушення в дихальних сигналах, наприклад, за обструктивного апное уві сні або дихальних розладів, можуть призвести до зниження кореляційної розмірності.\n\n**Аналіз ходи**:\nКореляційна розмірність може бути використана для аналізу моделей ходи. Вона може допомогти в розумінні складності рухів людини під час ходьби або бігу. Зміни в кореляційній розмірності сигналів ходи можуть свідчити про зміну стабільності ходи або про наявність відхилень у ході, викликаних неврологічними або опорно-руховими захворюваннями.\n\n**Варіативність динаміки серцевого ритму** (ВСР):\nВСР являє собою зміну часових інтервалів між послідовними ударами серця. Вона перебуває під впливом вегетативної нервової системи і відображає адаптивність і складність серцево-судинної системи. Вищий рівень ВСР, що відповідає вищій кореляційній розмірності, зазвичай асоціюється з кращим станом серцево-судинної системи та її адаптивністю до фізіологічних змін і змін навколишнього середовища. Її падіння може асоціюватися з аномальною динамікою серця.\n\n**Послідовності ДНК**:\nКореляційна розмірність може бути використана і при аналізі послідовностей ДНК. Вона допомагає виявити самоподібні або фрактальні патерни всередині послідовностей, що може мати значення для розуміння генетичної складності, еволюційних зв'язків і регуляції генів. Висока кореляційна розмірність --- висока складність ланцюжка ДНК. Мала кореляційна розмірність --- спрощений ланцюжок ДНК.\n\n**Фінансові ринки**\nВища кореляційна розмірність у даних часових рядів фінансового ринку свідчить про більшу складність та існування в їхній основі самоподібних моделей або фрактальних структур. Хаотична поведінка цін на акції може бути пов'язана з періодами високої волатильності та непередбачуваності. З іншого боку, нижча величина кореляційної розмірності може свідчити про більш передбачувані та менш складні рухи цін, що відповідає періодам стабільності або менш волатильним ринковим умовам.\n\n::: {.callout-note}\n## Примітка по кореляційні розмірності\n\nКореляційна розмірність розглядає кількість інформації (кубиків, кіл), необхідну для опису **тільки пари точок** у фазовому просторі.  \n\n:::\n\n\n\n## Хід роботи\n\nРозглянемо як можна застосовувати зазначені показники в якості індикаторів кризових станів. \n\nСпочатку імпортуємо необхідні бібліотеки для подальшої роботи:\n\nДалі виконаємо налаштування формату виведення рисунків:\n\nУ даній роботі скористаємось монофрактальними показниками для ідентифікації кризових явищ на ринку золота. Розглянемо значення золота за весь період, що представляє Yahoo! Finance. Для цього нам не треба буде вказувати початкову та кінцеву дати:\n\nВиводимо досліджуваний ряд:\n\nВизначимо функцію `transformation()` для стандартизації ряду:\n\n### Обчислення показника Херста із використанням *R/S*-аналізу\n\nДля подальших розрахунків використовуватимемо бібліотеку `neurokit2` та `fathon`. Другу можна встановити в наступний спосіб:\n\nДалі імпортуємо саму бібліотеку та дотичні до неї модулі:\n\nБібліотека `neurokit` містить необхідний метод для *R/S*-аналізу --- `fractal_hurst`. Його синтаксис виглядає наступним чином:\n\n**`fractal_hurst(signal, scale='default', corrected=True, show=False)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень або датафрейму бібліотеки `pandas`.\n- **scale** (*list*) --- список, що містить довжини вікон (кількість точок даних у кожній підмножині ряду), на які розбито сигнал.\n- **corrected** (*bool*) --- якщо значення `True`, до вихідних даних буде застосовано поправочний коефіцієнт Аніса-Ллойда-Пітерса відповідно до очікуваного значення для окремих значень (*R/S*).\n- **show** (*bool*) --- якщо значення `True`, виводить залежність $(R/S)_n$ від $n$ (**scale**) у подвійному логарифмічному масштабі. \n\n**Повертає**\n\n- **h** (*float*) --- показник Херста.\n- **kwargs --- словник, що містить інформацію відносно використовуваних у процедурі параметрів.\n\nРозглянемо ступінь трендостійкості в динаміці фондового індексу золота, використовуючи весь часовий ряд. Далі знайдемо значення показника Херста в рамках віконної процедури.\n\n#### Увесь часовий ряд\n\nПершочергово знайдемо значення прибутковостей для нашого ряду та стандартизуємо їх. Після цього виконаємо обчислення. \n\nВиконуємо *R/S*-аналіз:\n\nЯк ми можемо бачити з @fig-gold-rs-all, значення $h=0.53$, що свідчить про подібність динаміки золота до випадкового блукання. Але оскільки закони, що регулюють ринок, змінюються з часом, мають змінюватись і кореляції всередині системи, а одже коефіцієнт Херста також має залежати від періоду в якому він розглядається.   \n\n#### Віконна процедура\n\nВизначимо функцію для побудови парних графіків:\n\nПриступимо до віконної процедури:\n\nВізуалізуємо результат:\n\nНа представленому рисунку ( @fig-gold-wind-rs ) можемо бачити, що показник Херста зростає в передкризовий період та спадає під час кризи. Перед кризою динаміка ринку характеризується зростанням трендостійкості (персистентності), що відзеркалює зростання скорельованості дій між трейдерами ринку. \n\n### Обчислення на основі DFA\n\nБібліотека `fathon` представляє інструментарій як для виконання класичного аналізу детрендованих флуктуацій, так і для його мультифрактального аналогу, мова про який піде в наступній лабораторній. \n\n#### Для всього ряду\n\nСпочатку представимо значення $\\alpha$ для всього ряду. Процедура розрахунків на основі бібліотеки `fathon` виглядатиме наступним чином: \n\n1. знаходимо стандартизовані прибутковості ряду\n\nВиводимо залежність функції флуктуацій від характеристичного масштабу:\n\nБудуємо залежність функції флуктуацій від масштабу в подвійному логарифмічному масштабі:\n\nПроцедура DFA показує, що значення індексу золота представляються скоріше антиперсистентними, але представлений результат доволі близький до того, що був отриманий за допомогою *R/S*-аналізу. Розглянемо значення $\\alpha$ в рамках алгоритму ковзного вікна. \n\n#### Віконна процедура\n\nВизначимо наступні параметри:\n\nЗнайдемо показник Херста ($\\alpha$), фрактальну розмірність ($D_f$), показник спектральної щільності ($\\beta$) та показник автокореляції ($\\gamma$):  \n\nЗберігаємо абсолютні значення показників до текстових файлів:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результати:\n\nЯкщо порівнювати з *R/S*-аналізом, @fig-gold-wind-alpha демонструє, що динаміка *узагальненого показника Херста* отриманого за допомогою DFA є набагато стабільнішою. Тепер ми здатні диференціювати значну частку крахових подій, що мали місце на ринку золота. Узагальнений Херст показує, що передкризові явища характеризуються зростанням трендостійкості ринку або, іншими словами, підвищенням ступеня самоорганізації системи. \n\n@fig-gold-wind-df показує, що $D_f$ характеризується спадом при кризових станах. Це є індикатором того, що вищий ступень організованості ринку відзеркалюється в більш згладженій або менш шорстких флуктуаціях досліджуваного сигналу.  \n\nНа даному рисунку ми бачимо динаміку показника $\\beta$, що відноситься до спектральної густини потужності ($P(f)=1/f^{\\beta}$), зростає в кризові періоди, що говорить про спад потужності сигналу, що припадає на одиничний інтервал частоти. Це також є свідченням зростання кореляційних властивостей системи. \n\nНа @fig-gold-wind-gamma видно, що показник $\\gamma$ спадає в кризові та передкризові періоди. Це є показником сповільнення спаду функції автокореляції, що в свою чергу також вказує на зростання корельованності динаміки системи. \n\n### Обчислення фрактальної розмірності Хігучі\n\nЯк уже зазначалося, фрактальна розмірність Хігучі є одним із різновидів фрактальної розмірності для часових рядів. Вона обчислюється шляхом реконструкції $k$-максимальної кількості нових наборів даних. Для кожного відновленого набору даних обчислюється довжина кривої і відкладається проти відповідного k-значення в логарифмічній шкалі. HFD відповідає нахилу лінійного тренду за методом найменших квадратів.\n\nРозрахуємо оптимальне значення $k$ для всього часового ряду. Бібліотека `neurokit2` представляє готову процедуру для автоматизованого підбору даного параметру. Оптимальний $k_{max}$ розраховується на основі точки, в якій значення фрактальної розмірності досягає плато для діапазону значень $k_{max}$ (див. Vega, 2015). \n\nСинтаксис даної функції виглядає наступним чином:\n\n**`complexity_k(signal, k_max='max', show=False)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **$k_{max}$** (*Union[int, str, list], optional*) --- максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити. Якщо  $k_{max}$=`default`, тоді вибирається максимально можливе значення, що відповідає половині довжини сигналу.\n- **show** (*bool*) --- візуалізовується нахил кривої для обраного значення $k_{max}$. \n\n**Повертає**\n\n- **k** (*float*) --- оптимальний $k_{max}$ часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення оптимального $k_{max}$.\n\n#### Для всього ряду\n\nДля подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків: \n\nІ тепер отримаємо оптимальне значення $k_{max}$ згідно зазначеної процедури:\n\nТепер побудуємо залежність довжини сигналу від часового зміщення в логарифмічному масштабі. Для фрактального сигналу має зберігатися лінійна залежність. Бібліотека `neurokit2` містить метод для розрахунку даної фрактальної розмірності. Синтаксис цієї процедури виглядає наступним чином:\n\n**`fractal_higuchi(signal, k_max='default', show=False, **kwargs)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **$k_{max}$** (*Union[int, str, list], optional*) --- максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити.\n- **show** (*bool*) --- візуалізовується нахил кривої для обраного значення $k_{max}$. \n\n**Повертає**\n\n- **HFD** (*float*) --- фрактальна розмірність Хігучі для досліджуваного часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Хігучі.\n\nУ подальшому будемо послуговуватись отриманим оптимальним значенням для розрахунку розмірності Хігучі в рамках алгоритму ковзного вікна. \n\n#### Віконна процедура\n\nСкористаємось наступними параметрами:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nЯк можна бачити з представленого рисунку, фрактальна розмірність Хігучі може працювати як індикатор або індикатор-передвісник кризових явищ. Видно, що даний показник починає спадати у передкризові періоди чи у сам момент кризи, вказуючи на зростання згладженності динаміки системи, ступеня кореляцій та трендостійкості динаміки ринку. \n\n### Обчислення фрактальної розмірності Петросяна\n\nПетросян (1995) запропонував швидкий метод оцінки фрактальної розмірності шляхом перетворення сигналу в двійкову послідовність, з якої оцінюється фрактальна розмірність. Існує кілька варіацій алгоритму (`neurokit2`, наприклад, пропонує `\"A\"`, `\"B\"`, `\"C\"` або `\"D\"`), що відрізняються насамперед способом створення дискретної (символьної) послідовності (див. `complexity_symbolize()` для деталей). Найпоширеніший метод (`\"C\"`, за замовчуванням) бінаризує сигнал за знаком послідовних різниць.\n\nБільшість з цих методів дискретизації припускають, що сигнал є періодичним (без лінійного тренду). Для усунення лінійних трендів може бути корисним лінійне детрендування.\n\nСинтаксис даної процедури має наступний вигляд:\n\n**`fractal_petrosian(signal, symbolize='C', show=False)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **symbolize** (*str*) - метод перетворення неперервного вхідного сигналу в символьний (дискретний) сигнал. За замовчуванням присвоює 0 та 1 значенням нижче та вище середнього. Може мати значення `None`, що припускає, що вхідний сигнал вже є дискретним.\n- **show** (*bool*) --- виводить дискретизацію сигналу. \n\n**Повертає**\n\n- **PFD** (*float*) --- фрактальна розмірність Петросяна для досліджуваного часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Петросяна.\n\nМи не розглядатимемо детально синтаксис функції `complexity_symbolize()`. Опишемо лише ті методи дискретизації, що дотичні до фрактальної розмірності Петросяна:\n- **Метод `A`** бінаризує сигнал за більшими та меншими значеннями порівняно із середнім значенням сигналу. Еквівалентом є `method=\"mean\"` (`method=\"median\"` також є допустимим).\n- **Метод `B`** використовує значення, що знаходяться в діапазоні $\\pm 1\\sigma$, проти значень, що виходять за межі цього діапазону.\n- **Метод `C`** обчислює різницю між послідовними вибірками та бінаризує їх залежно від знаку.\n- **Метод `D`** відокремлює послідовні відліки, що перевищують $1\\sigma$ сигналу, від інших менших змін.\n\nТепер розглянемо віконну динаміку даного показника. \n\n#### Віконна процедура\n\nОскільки більшість з даних методів дискретизації вимагаються детрендування ряду, тоді будемо виконувати розрахунки для прибутковостей індексу золота.Скористаємось наступними параметрами:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n@fig-gold-wind-petro показує, що показник Петросяна також спадає під час кризових подій, що вказує на зростання періодизації ринку та синхронізації активності трейдерів у відповідні моменти часу.\n\n### Обчислення фрактальної розмірності Каца\n\nТепер обчислюємо фрактальну розмірність Каца. Евклідові відстані між послідовними точками сигналу підсумовуються і усереднюються, а також визначається максимальна відстань між початковою точкою і будь-якою іншою точкою у вибірці.\n\nФрактальна розмірність варіюється від 1.0 для прямих ліній, приблизно до 1.15 для випадкових блукань і наближається до 1.5 для найбільш \"дивних\" форм сигналу.\n\nСинтаксис процедури для розрахунку даної розмірності виглядає наступним чином:\n\n**`fractal_katz(signal)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n\n**Повертає**\n\n- **KFD** (*float*) --- фрактальна розмірність Каца для досліджуваного часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nОскільки даний показник є параметронезалежним, нам достатньо буде лише розміру часового вікна, кроку та типу ряду:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nНа представленому рисунку видно, що фрактальна розмірність Каца також спадає у кризові та передкризові періоди. Це також є індикаторов зростання ступеня корельованості системи в дані періоди.\n\n### Обчислення фрактальної розмірності Севчика\n\nАлгоритм цієї фрактальної розмірності був запропонований для обчислення фрактальної розмірності сигналів Севчиком (1998). Цей метод можна використовувати для швидкого вимірювання складності та випадковості сигналу.\n\nСинтаксис методу, що ми використовуватимемо в подальшому, має наступний вигляд:\n\n**`fractal_sevcik(signal)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n\n**Повертає**\n\n- **SFD** (*float*) --- фрактальна розмірність Севчика для досліджуваного часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nДля цього показника нам також не потребується нічого зайвого:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nБачимо, що і фрактальна розмірність Севчика реагує спадом на крахові події на ринку золота. Особливо характерними є спади під час кризи 2008, 2011, 2015 та 2020 років, що є ключовими та дослідженими багатьма вченими. Динаміка індексу золота під час зазначених кризових подій також характеризувалися зростанням персистентності (кореляцій).\n\n### Обчислення фрактальної розмірності через нормалізовану щільність довжини\n\nЦе доволі простий показник, що відповідає середнім абсолютним послідовним різницям (стандартизованого) сигналу (`np.mean(np.abs(np.diff(std_signal)))`). Цей метод було розроблено для вимірювання складності сигналів дуже короткої тривалості (< 30 відліків), і його можна використовувати, наприклад, коли цікавлять безперервні зміни фрактальної розмірності сигналу, обчислюючи його в межах ковзних вікон.\n\nДля таких методів, як для фрактальної розмірності Хігучі, стандартне відхилення віконної фрактальної розмірності різко зростає, коли довжина ряду стає коротшою. Цей метод дає менше стандартне відхилення, особливо для коротших фрагментів, хоча і за рахунок меншої точності середнього значення фрактальної розмірності вікна.\n\nСинтаксис процедури має наступний вигляд:\n\n**`fractal_nld(signal, corrected=False)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **corrected** (*bool*) --- якщо значення `True`, змінює масштаб вихідного значення фрактальної розмірності відповідно до степеневої моделі, щоб зробити його більш порівнянним з \"істинним\" значенням: `FD = 1.9079*((NLD-0.097178)^0.18383)`. Зауважте, що це може призвести до `np.nan`, якщо результат різниці буде від'ємним.\n\n**Повертає**\n\n- **NLDFD** (*float*) --- фрактальна розмірність через нормалізовану щільність довжини.\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nДля цього показника нам також не потребується нічого зайвого:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n@fig-gold-wind-nld показує, що $NLDFD$ спадає під час кризових та передкризових подій, що вказує на зростання кореляцій у дані періоди. \n\n### Обчислення фрактальної розмірності через нахил спектральної щільності потужності\n\nСкористаємось наступним методом бібліотеки `neurokit2`:\n\n**`fractal_psdslope(signal, method='voss1988', show=False, **kwargs)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **method** (*str*) --- метод оцінки фрактальної розмірності за нахилом, може бути `\"voss1988\"` (за замовчуванням) або `\"hasselman2013\"`.\n- **show** (*bool*) --- якщо значення `True`, повертає графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі.\n- **kwargs** --- інші аргументи, які слід передати до `signal_psd()`.\n\n**Повертає**\n\n- **slope** (*float*) --- оцінка фрактальної розмірності, отримана в результаті аналізу нахилу спектральної щільності потужності.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для аналізу нахилу спектральної щільності потужності.\n\n#### Для всього ряду\n\nДля подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків: \n\nІ тепер виведемо графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі:\n\nЯк можна бачити з представленого графіку, спектральний нахил спектральної щільності потужності на різних частотах має лінійну залежність, а кут нахилу прямої, побудованої по спектру, близький до -2, що вказує на те, що динаміка індексу золота близька до дробового броунівського руху.\n\nТепер розглянемо варіацію кута нахилу спектра в рамках алгоритму ковзного вікна.\n\n#### Віконна процедура\n\nВстановимо наступні параметри:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nРисунок вище показує, що даний показник також реагує спадом у кризові та передкризові події, вказуючи на зростання автокореляції часового ряду під час даних подій. Також зрозуміло, що має місце варіації нахилу спектра щільності потужності. В одні моменти часу динаміка сигналу може бути подібна до броунівського руху, а в інші до білого шуму.\n\n### Обчислення кореляційної розмірності\n\nКореляційна розмірність (також позначається як $D_2$) є нижньою границею оцінки фрактальної розмірності досліджуваного фазового простору.\n\nСпочатку здійснюється реконструкція фазового простору сигналі згідно методу часової затримки, і далі обчислюються відстані між усіма точками траєкторії. Потім обчислюється \"кореляційна сума\", яка є часткою пар точок, відстань між якими менша за заданий радіус. Остаточна кореляційна розмірність апроксимується графіком залежності кореляційної суми від радіусу багатовимірного околу досліджуваних траєкторій, що будується в логарифмічному масштабі.\n\nЦю розмірність можна викликати через `fractal_correlation()`. Її синтаксис виглядає наступним чином:\n\n**`fractal_correlation(signal, delay=1, dimension=2, radius=64, show=False, **kwargs)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **delay** (*int*) --- часова затримка ($\\tau$).\n- **dimension** (*int*) --- розмірність вкладень ($m$).\n- **radius** (*Union[str, int, list]*) --- послідовність радіусів для перевірки. Якщо передано ціле число, буде отримано експоненціальну послідовність довжиною заданим скалярним значенням `radius` у межах від 2.5% до 50% від діапазону відстані. Методи, реалізовані в інших пакетах, можна використовувати, вказуючи `\"nolds\"`, `\"Corr_Dim\"` або `\"boon2008\"`.\n- **show** (*bool*) --- графік кореляційної розмірності, якщо `True`. За замовчуванням --- `False`.\n- **kwargs** --- інші аргументи для передачі (наразі не використовуються).\n\n**Повертає**\n\n- **cd** (*float*) --- кореляційна розмірність часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення кореляційної розмірності.\n\n#### Для всього часового ряду\n\nРозглянемо залежність кореляційної суми від радіусу для всього часового ряду. Перш за все виконаємо перетворення ряду:\n\nТепер розрахуємо кореляційну розмірність, побудувавши залежність кореляційної суми від радіусу в логарифмічному масштабі:\n\nЯк ми можемо бачити, кореляційна сума дійсно має лінійну залежність для різних значень радіусу околу певної траєкторії, що вказує на фрактальність системи. Тепер подивимось як варіюється значення кореляційної розмірності в періоди турбулентності.\n\n#### Віконна процедура\n\nДля цього показника визначимо наступні параметри:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n@fig-gold-wind-cd демонструє, що кореляційна розмірність для індексу золота також спадає у кризові та передкризові періоди, вказуючи на зростання корельованості теперішніх цін на золото з попередніми. Можна сказати і по іншому: у період криз трейдери починають самоорганізовуватись та колективно скупати або продавати відповідний актив; іншими словами, їх динаміка стає більш синхронною. Оскільки кореляційна розмірність вимірюється для траєкторій фазового простору, спад цього показника свідчить про зростання щільності досліджуваних траєкторій. Тобто, фазовий простір стає більш розрідженим, а всі його траєкторії концентрованими лише в одній конкретній області, що є індикатором згуртованості прихованих змінних досліджуваної системи.\n\n\n","srcMarkdownNoYaml":"\n\n\n\n\n**Тема.** Фрактальний аналіз складних систем.\n \n**Мета.** Навчитися використовувати методи монофрактального аналізу для дослідження нелінійних характеристик складних систем. \n\n\n\n## Теоретичні відомості\n\n### Означення фрактала\n\n**Фракталами** називають геометричні об'єкти: лінії, поверхні, просторові тіла, що мають сильно шорстку поверхню або форму і характеризуються властивістю самоподібності. Слово фрактал походить від латинського слова *fractus* і перекладається як дробовий, ламаний. Самоподібність як основна характеристика фрактала означає, що він більш-менш однорідно змінюється при широкому діапазоні масштабів. Так, при збільшенні маленькі фрагменти фрактала виходять дуже схожими на великі. В ідеальному випадку така самопподібність призводить до того, що  фрактальний об'єкт виявляється інваріантним щодо розтягувань, тобто йому, як кажуть, притаманна дилатаційна симетрія. Вона передбачає незмінність основних геометричних особливостей фрактала при зміні масштабу.\n\nОчевидно, що фрактальні об'єкти реального світу не є нескінченно самоподібними й існує мінімальний масштаб $l_{min}$, такий, що на масштабі $l \\approx l_{min}$ властивість самоподібності зникає. Окрім цього, на достатньо великих масштабах довжин $l > l_{max}$, де $l_{max}$ --- характерний геометричний розмір об'єктів, ця властивість самоподібності також порушується. Тому властивості природніх фракталів розглядаються лише на масштабах $l$, що задовільняють відношення $l_{min} \\ll l \\ll l_{max}$. Такі обмеження природні, оскільки, коли ми приводимо в якості прикладу фракталу --- ламану, негладку траєкторію броунівської частинки, то ми розуміємо, що цей образ представляє очевидну ідеалізацію. Справа в тому, що на малих масштабах приховується граничність маси і розмірів броунівської частнки, а також кінцевість часу зіткнення. При врахуванні цих обставин траєкторія броунівської частинки починає представляти гладку криву. \n\nВарто зазначити, що властивість точної самоподібності характерна лише для **регулярних фракталів**. Якщо замість детермінованого способу побудови включити в алгоритм їхнього створення деякий елемент випадковості (як це буває, наприклад, у багатьох процесах диференційованого зростання кластерів, електричному пробої тощо), то виникають так звані **випадкові фрактали**. Основна їхня відмінність від регулярних полягає в тому, що властивості самоподібності є справедливими тільки після відповідного усереднення за всіма статистично незалежними реалізаціями об'єкта. При цьому збільшена частина фрактала не точно ідентична вихідному фрагменту, проте їхні статистичні характеристики збігаються.\n\n### Довжина берегової лінії\n\n::: {#fig-costline}\n\n![](Images\\lab_6\\costline.jpg)\n\nВизначення довжини берегової лінії між точками А та В\n\n:::\n\nПершочергово поняття фрактала у фізиці виникло у зв'язку із завданням про визначення довжини берегової лінії. Під час її вимірювання за наявною картою місцевості з'ясувалася цікава деталь --- чим більш великомасштабна карта береться, тим довшою виявляється ця берегова лінія. Нехай, наприклад, відстань по прямій між розсташованими на береговій лінії точками А та В дорівнює R (див. @fig-costline). Тоді, щоб виміряти довжину берегової лінії між цима точками, ми розташуємо по берегу  жорстко пов'язані один з одним вузол так, що відстань між сусідніми вузлами дорівнювала б, наприклад, $l=10$ км. Довжину берегової лінії в кілометрах між точками А і В ми приймемо тоді рівною числу вузлів мінус 1, помноженому на 10. Наступне вимірювання цієї довжини ми зробимо так само, але відстань між сусідніми вузлами зробимо вже рівною $l=1$ км.\n\nВиявляється, що результат цих вимірювань буде різним. При зменшенні масштабу $l$ ми отримуватимемо все більші й більші значення довжини. На відміну від гладкої кривої, лінія морського узбережжя виявляється найчастіше настільки порізаною (аж до найменших масштабів), що зі зменшенням довжини ланки $l$ величина $L$ --- довжина берегової лінії --- не прагне до кінцевого межі, а збільшується за степеневим законом \n\n$$ \nL \\approx l\\left( \\frac{R}{l} \\right)^{D}, \\tag{1}\n$$\n\nде $D > 1$ --- деякий степеневий показник, котрий іменується **фрактальною розмірністю** берегової лінії. Чим більше значення $D$, тим більш ломаною або деталізованою представляється ця берегова лінія. Походження залежності (1) має бути інтуїтивно зрозумілим: чим менший масштаб ми використовуємо, тим меньші деталі узбережжя будуть враховані і тим менший вклад вони внесуть у вимірювану довжину. Навпаки, збільшуючи масштаб, ми \"розгортаємо\" узбережжя, зменшуючи довжину $L$. \n\nТаким чином, ми бачимо, що для визначення довжини берегової лінії $L$ за допомогою жорсткого масштабу $l$, необхідно зробити $N=L/l$ кроків, причому величина $L$ змінюється з $l$ так, що $N$ залежить від $l$ за законом $N \\approx (R/I)^{D}$. У результаті зі зменшенням масштабу довжина берегової лінії необмежено зростає. Ця обставина різко відрізняє фрактальну криву від звичайної гладкої кривої (типу кола, еліпса), для якої межа довжини апроксимованої ламаної $L$, яка апроксимує, за наближення до нуля довжини її ланки $l$ є скінченною. У результаті для гладкої кривої її фрактальна розмірність $D = 1$, тобто збігається з топологічною.\n\n\n### Фрактальна розмірність множин\n\nВище було введено поняття про фрактальну розмірність берегової лінії. Дамо тепер загальне визначення цієї величини. Нехай $d$ --- звичайна Евклідова розмірність простору, в якому розташований наш фрактальний об'єкт ($d=1$ --- лінія, $d=2$ --- площина, $d=3$ --- звичайний тривимірний простір). Покриємо тепер цей об'єкт цілком $d$-мірними \"кулями\" радіуса 1. Припустимо, що нам потребувалося для цього не менше, ніж $N(l)$ куль. Тоді, якщо за досить малих $l$ величина $N(l)$ змінюється з $l$ за степеневим законом\n\n$$\nN(l) \\sim \\frac{1}{l^D}, \\tag{2}\n$$\n\nтоді $D$ --- називається **хаусдорфовою** або **фрактальною розмірністю** цього об'єкта. Очевидно, що ця формула еквівалентна відношеню $N \\approx \\left( R/l \\right)^{D}$, що використовувалось вище для визначення довжини берегової лінії. \n\nФормулу (2) можна переписати у вигляді\n\n$$\nD = -\\lim_{l \\to 0} \\frac{\\ln{N(l)}}{\\ln{l}}. \\tag{3}\n$$\n\nЦе відношення й слугує загальним визначенням фрактальної розмірності $D$. У відповідності до нього величина $D$ представляє **локальну** характеристику досліджуваного об'єкта. \n\n### Процедури обчислення монофрактальних розмірностей\n\nНаразі існує багато визначень та методів вимірювання фрактальної розмірності. Найпоширенішими одновимірними фрактальними розмірностями є розмірність Хаусдорфа, розмірність Хігучі, розмірність Петросяна та Коробчаста розмірність. Розмірність Хаусдорфа є найпростішою фрактальною розмірністю. Але її обчислювальна складність є високою, що ускладнює її практичне застосування. Коробкова розмірність є відносно простою, і фрактальну розмірність сигналу можна отримати, регулюючи розмір довжини сторони коробки. Тому вона є широко впізнаваємою та застосовуваною. Який показник фрактальної розмірності найточніше описує складність сигналу та здатний ідентифікувати кризові явища і представляє ключовий момент цієї лабораторної роботи.\n\n#### *R/S*-аналіз\n\nМетод *R/S*-аналізу, розроблений Мандельбротом та Уоллесом, базується на попередньо створеному методі гідрологічного аналізу Херста, і дозволяє обчислювати параметр самоподібності $H$, який вимірює інтенсивність довготривалих залежностей у \nчасовому ряді. Коефіцієнт $H$, який називають коефіцієнтом Херста, містить мінімальні прогнози стосовно природи системи, що вивчається, і може класифікувати часові ряди. За допомогою цього показника розрізняють випадкові (гаусові) та невипадкові ряди; окрім того, він пов’язаний із фрактальною розмірністю, що, у свою чергу, характеризує ступінь згладженості графіка, побудованого на основі часового ряду. Методом *R/S*-аналізу можливо також виявити максимальну довжину інтервалу (цикл), на якому значення зберігають інформацію про початкові дані системи (довготривала пам’ять). \n\nАналіз починається з побудови ряду логарифмічних прибутковостей, $G(t) \\equiv \\ln{x(t + \\Delta t)} - \\ln{x(t)}$, де $x(t)$ --- значення вихідного часового ряду в момент $t$, $\\Delta t$ --- часовий крок. Отримана послідовність $G(t)$ розбивається на $d$ підпослідовностей довжини $n$. \n\nДля кожної підпослідовності $m=1,...,d$:\n\n1. шукається середнє значення $\\mu_m$ та стандартне відхилення $S_m$; \n2. дані нормалізуються шляхом віднімання середнього значення послідовності $X_{i,m}=G_{i,m}-\\mu_m$, $i=1,...,n$; \n3. знаходиться кумулятивна сума послідовності $X$ів: $Y_{i,m}=\\sum_{j=1}^{i}X_{j,m}$, $i=1,...,n$; \n4. у межах кожної підпослідовності знаходиться розмах між максимальним та мінімальним значеннями: $R_m = \\max\\{Y_{1,m},...,Y_{n,m}\\}-\\min\\{Y_{1,m},...,Y_{n,m}\\}$, який стандартизується середнім квадратичним відхиленням $R_{m}/S_{m}$; \n5. обчислюється середнє $(R/S)_n$ нормованих значень розмаху для всіх підпослідовностей довжини $n$.  \n\n*R/S*-статистика, обрахована таким чином, відповідає співвідношенню $(R/S)_{n} \\cong cn^{H}$, де значення $H$ може бути отримане шляхом обчислення $(R/S)_n$ для послідовностей інтервалів зі збільшенням часового горизонту:\n\n$$\n\\log{(R/S)}_{n} = \\log{c} + H\\log{n}. \\tag{4}\n$$\n\nЗнайти коефіцієнт Херста можна, побудувавши залежність $(R/S)_n$ vs. $n$ у подвійному логарифмічному масштабі і взявши коефіцієнт нахилу прямої, яка інтерполює точки отриманого графіка. Якщо значення $H=0.5$, говорять про послідовність, що представляє собою білий шум; $0.5 < H \\leq 1$ свідчить про персистентний ряд, коли існує тенденція слідування великих значень ряду за великими і навпаки; $H<0.5$ вказує на антиперсистентний ряд.\n\nПри збільшенні часового горизонту коефіцієнт нахилу інтерполюючої прямої повинен прямувати до значення $H=0.5$; сам процес переходу свідчить про втрату впливу початкових умов на поточні значення, і, таким чином, можна говорити про горизонт довгої пам’яті --- це точка, до якої коефіцієнт нахилу інтерполюючої прямої відмінний від 0.5, а після --- близько 0.5. \n\n::: {.callout-note}\n## Примітка до *R/S*-аналізу\n\nМіж фрактальною розмірністю та показником Херста також існує зв'язок\n\n$$\nD_f = 2-H. \n$$\n\nЯкщо для берегової лінії ми визначали масштабування її довжини $L$ в залежності від зміни $l$, то у випадку з *R/S*-аналізом ми визначаємо зміну нормованого розмаху значень ряду в межах масштабу $n$.\n \n:::\n\n#### Аналіз детрендованих флуктуацій\n\nАналіз детрендований флуктуацій (Detrended fluctuation analysis, DFA) базується на гіпотезі про те, що корельований часовий ряд може бути \nвідображений на самоподібний процес шляхом інтегрування. Таким чином, вимірювання властивостей самоподібності може непрямо свідчити про кореляційні властивості ряду. Переваги АДФ порівняно з іншими методами (спектральний аналіз, *R/S*-аналіз) полягають в тому, що він виявляє довгочасові кореляції нестаціонарних часових рядів, а також дозволяє ігнорувати очевидні випадкові кореляції, що є наслідком нестаціонарності. \n\nІснують DFA різних порядків, що відрізняються трендами, які вилучаються з даних. \n\nРозглянемо DFA найнижчого порядку.\n\n1. Для часового ряду довжини $N$ знаходиться кумулятивна сума, $y(k)=\\sum_{i=1}^{k}\\left( x_i - \\bar{x} \\right)$, де $x_i$ --- це $i$-те значення часового ряду, $\\bar{x}$ --- його середнє значення, $k=1,...,N$.\n2. Отриманий ряд $y(k)$ розбивається на $m$ підпослідовностей (вікон) однакової ширини $n$ і для кожної підпослідовності (у кожному вікні) виконується наступне:\n    - за допомогою методу найменших квадратів знаходиться локальний лінійний тренд $y_{t}(k)$;  \n    - підпослідовність детрендується шляхом віднімання значення локального тренду $y_{t}(k)$ від значень ряду $y(k)$, що належать послідовності $t$;\n    - знаходиться середнє $\\bar{y_t}$ детрендований значень. \n\nДля отриманих таким чином значень на всіх підпослідовностях знаходиться:\n\n$$\nF_n = \\sqrt{\\frac{1}{m}\\bar{y_t}}, \n$$\n\nде $n$ --- кількість точок у підпослідовності (ширина вікна), $m$ --- кількість підпослідовностей, $\\bar{y_t}$ --- середнє детрендованих значень для підпослідовності $t$. \n\nВказана процедура повторюється для різних значень $n$, внаслідок чого ми отримує набір залежностей $F_n$ від $n$. Побудова залежності $\\log{F(n)}$ від $\\log{n}$ та інтерполяція отриманих значень лінією регресії дає змогу обчислити показник скейлінга $\\alpha$, що є коефіцієнтом кута нахилу інтерполяційної прямої і характеризує зміну кореляцій флуктуацій часового ряду $F_n$ при збільшенні часового інтервалу $n$. \n\nПорівняно із *R/S*-аналізом, DFA дає більші можливості інтерпретації скейлінгового показника $\\alpha$: \n\n- для випадкового ряду (перемішаного чи \"сурогатного\") $\\alpha = 0.5$; \n- при наявності лише короткочасових кореляцій $\\alpha$ може відрізнятись від 0.5, проте має тенденцію прямувати до 0.5 при збільшенні розміру вікна;\n- Значення $0.5 < \\alpha \\leq 1.0$ показує персистентні довгочасові кореляції, що відповідають степеневому закону; \n- $0 < \\alpha < 0.5$ означає антиперсистентний ряд; \n- cпеціальний випадок, коли $\\alpha = 1$, означає наявність $1/f$ шуму. \n- для випадків, коли $\\alpha \\geq 1$, кореляції існують, проте перестають відображувати степеневу залежність;\n- випадок $\\alpha = 1.5$ свідчить про Броунівський шум, інтегрований білий шум.\n\nУ випадку степеневої залежності функції автокореляцій спостерігається спад автокореляції з показником $\\gamma$:\n\n$$\nC(L) \\sim L^{-\\gamma}.\n$$ \n\nНа додачу до цього, спектральна густина також спадає за степеневим законом: \n\n$$\nP(f) \\sim f^{-\\beta}. \n$$\n\nВідповідні показники виражаються через наступні відношення:\n\n- $\\gamma=2-2\\alpha$; \n- $\\beta=2\\alpha-1$. \n\nУ DFA другого порядку (DFA2) обчислюються відхилення $F^2(v,s)$ профілю від інтерполяційного многочлена другого порядку. Таким чином, вилучаються впливи \nможливих лінійних та параболічних трендів для масштабів, більших за розглядувані. Взагалі, у DFA порядку $n$ обчислюються відхилення профілю від інтерполяційного многочлена $n$-го порядку, що вилучає вплив всіх можливих трендів порядків до ($n-1$) для масштабів, більших від розміру вікна. \n\nПотім обчислюється найближчий поліном $y_{ν}(s)$ для профілю на кожному із $2N_s$ сегментів $v$ і визначається відхилення\n\n$$\nF^2(v,s) \\equiv \\frac{1}{s}\\sum_{i=1}^{s}\\left( x_{(v-1)s+i} - y_{i}(i) \\right)^{2}. \\tag{5}\n$$\n\nДалі знаходиться середнє значення флуктуацій всіх детрендованих профілів:\n\n$$\nF_2(s) \\equiv \\sqrt{\\left( \\frac{1}{2N_s} \\sum_{v=1}^{2N_s}F^{2}(v,s) \\right)}. \\tag{6}\n$$\n\nЗначення формули (6) можна трактувати як середньоквадратичний зсув (переміщення) точки випадкових блукань у ланцюжку після $s$ кроків. \n\n#### Фрактальна розмірність Хігучі\n\nФрактальна розмірність Хігучі --- це один з різновидів монофрактальної розмірності, яка визначається наступним чином:\n\nПрипустимо, що у нас є часовий ряд \n\n$$\nx(1), x(2),...,x(N)\n$$\n\nі реконструйований часовий ряд $x_{m}^{k}$: \n\n\\begin{align*}\nx_{m}^{k} = \\{ x(m), x(m+k), x(m+2k), ..., \\\\\n x\\left( m+\\left[ \\frac{N-m}{k} \\right] \\cdot k \\right) \\}, \n\\end{align*}\n\nдля $m=1,2,...,k$; де $m$ представляє початковий час; $k=2,...,k_{max}$ представляють ступінь часового зміщення. Позначення $[\\cdot]$ представляє цілу частину $x$. Для кожного реконструйованого часового ряду $x_{m}^{k}$ розраховується середня довжина часової послідовності $L_{m}(k)$: \n\n$$\nL_{m}(k) = \\frac{\\sum_{i=1}^{[\\frac{(N-m)}{k}]} | x(m+ik) - x(m+(i-1)\\cdot k) | \\cdot (N-1)}{[\\frac{N-m}{k}] \\cdot k}\n$$\n\nДалі, для всіх середніх довжин $L_{m}(k)$, знаходиться загальне середнє:\n\n$$\nL(k) = \\frac{1}{k}\\sum_{m=1}^{k}L_{m}(k). \n$$\n\nЗгідно методу Хігучі узагальне середнє значення $L(k)$ пропорційне масштабу $k$, тобто \n\n$$\nL(k) \\propto k^{-D}. \n$$\n\nДалі логарифмуємо обидві сторони й отримуємо наступну рівність:\n\n$$\n\\ln{L(k)} \\propto D \\cdot \\ln{\\left( \\frac{1}{k} \\right)}. \n$$\n\nІнтерполювавши лінію регресії через залежність $\\ln{L(k)}$ від $\\ln{\\left( \\frac{1}{k} \\right)}$, ми можемо отримати показник фрактальності $D$, отримавши кут нахилу цієї лінії. Показник $D$ і представлятиме фрактальну розмірність Хігучі. \n\n#### Фрактальна розмірність Петросяна\n\nСпочатку, для часового ряду $\\{ x_1, x_2,...,y_{N} \\}$, створюємо його дискретизовану (бінарну) версію, $z_i$: \n\n$$\nz_i = \n\\begin{cases}\n    1, & x_i > \\langle x \\rangle, \\\\\n    -1, & x_i \\leq \\langle x \\rangle. \n\\end{cases}\n$$\n\nФрактальну розмірність Петросяна може бути визначена як \n\n$$\nD = \\frac{\\log_{10}{N}}{\\log_{10} + \\log_{10}{\\left( \\frac{N}{N+0.4N_{\\Delta}} \\right)}}, \n$$\n\nде $N_{\\Delta}$ --- кількість загальних змін знаку змінної $z_i$: \n\n$$\nN_{\\Delta} = \\sum_{i=1}^{N-2} \\left|\\frac{z_{i+1}-z_i}{2}\\right|. \n$$\n\n\n\n#### Фрактальна розмірність Каца\n\nПредставимо, що сигнал складається з пари точок $\\left( x_i, y_i \\right)$. Тоді, фрактальна розмірність Каца визначається як\n\n$$\nD = \\frac{\\log{N}}{\\log{N} + \\log{\\frac{d}{L}}}, \n$$\n\nде $L$ визначається наступним чином:\n\n$$\nL = \\sum_{i=0}^{N-2}\\sqrt{\\left( y_{i+1}-y_{i} \\right)^{2} + \\left( x_{i+1}-x_{i} \\right)^{2}}. \n$$\n\nЗначення $d$ визначається як максимальна відстань від початкової точки $\\left( x_1, y_1 \\right)$ до всіх інших точок, а саме $d$ може бути розраховане наступним чином:\n\n$$\nd = \\max{\\left( \\sqrt{\\left( x_i - x_1 \\right)^{2} - \\left( y_i - y_1 \\right)^{2}} \\right)}.\n$$\n\n#### Фрактальна розмірність Севчика\n\nСпочатку, для множини значень $\\left( x_i, y_i \\right)$ виконується нормалізація:\n\n$$\nx_{i}^{*} = \\frac{x_i-x_{min}}{x_{max}-x_{min}}, \\; y_{i}^{*} = \\frac{y_i-y_{min}}{y_{max}-y_{min}}. \n$$\n\nФрактальна розмірність Севчика може бути визначена як\n\n$$\nD = 1 + \\frac{\\ln{L}}{\\ln{[2 \\cdot \\left( N-1 \\right)]}}, \n$$\n\nде $L$ --- це довжина сигналу, що може бути визначена як\n\n$$\nL = \\sum_{i=0}^{N-2}\\sqrt{\\left( y_{i+1}^{*}-y_{i}^{*} \\right)^{2} + \\left( x_{i+1}^{*}-x_{i}^{*} \\right)^{2}}. \n$$\n\n\n#### Фрактальна розмірність через нормалізовану щільність довжини\n\nДаний показник розраховується в наступний спосіб:\n\n1. Для часового ряду $\\{ x_1, x_2,...,x_n \\}$ виконується стандартизація: $y_i = \\frac{x_i - \\mu}{\\sigma}$, де $\\mu$ --- це середнє значення ряду, $\\sigma$ --- це стандартне відхилення. \n2. Розраховується нормалізована щільність довжини:\n\n$$\nNLD = \\frac{1}{N}\\sum_{i=2}^{N}\\left| y_i - y_{i-1} \\right|\n$$\n\nФактичний розрахунок фрактальної розмірності сигналу базується на побудові монотонної калібрувальної кривої, $D = f(NLD)$, за набором функцій Вейєрштрасса, для яких значення $D$ задаються теоретично.\n\n3. Для обчислювальних цілей необхідно створити математичну модель цієї залежності. Автори даного підходу тестували дві моделі:\n    - логарифмічну модель: $D = a \\cdot \\log{\\left(NLD - NLD_{0} \\right)} + C$\n    - степеневу модель: $D = a \\cdot \\left(NLD - NLD_{0} \\right)^{k}$. Бібліотека `neurokit2` використовує саме степеневу модель. Параметр $a=1.9079$, $k=0.18383$ і $NLD_{0}=0.097178$, згідно статті *Kalauzi et al. 2009*. \n\n\n\n#### Фрактальна розмірність через нахил спектральної щільності потужності\n\nФрактальну розмірність можна обчислити на основі аналізу нахилу спектральної щільності потужності (power spectral density slope, PSD) в сигналах, що характеризуються частотною степеневою залежністю.\n\nСпочатку виконується перетворення часового ряду до частотної області і далі сигнал розбивається на синусоїдальні та косинусоїдальні хвилі певної амплітуди, які разом \"складаються\", щоб представити вихідний сигнал. Якщо існує систематичний зв'язок між частотами в сигналі і потужністю цих частот, то в логарифмічних координатах це проявляється в лінійній залежності. Кут нахилу лінії регресії приймається як оцінка фрактальної розмірності.\n\nНахил 0 відповідає білому шуму, а нахил менше 0, але більше -1, відповідає рожевому шуму, тобто шуму $1/f$. Спектральні нахили крутіші за -2 вказують на дробовий броунівський рух, що є втіленням процесів випадкового блукання.\n\n#### Кореляційна розмірність \n\nКореляційна розмірність ($D_2$) --- це похідна величина від кореляційного інтеграла Кореляційний інтеграл (кореляційна сума) може бути поданий в такому вигляді:\n\n$$\nC(\\varepsilon) = \\frac{1}{N^{2}}\\sum_{\\substack{i,j=1 \\\\ i\\neq j}}^{N}\\Theta \\left( \\varepsilon - \\| \\vec{x}(i) - \\vec{x}(j) \\| \\right), \\; \\vec{x}(i) \\in \\Re^{m}. \n$$\n\nСама кореляційна розмірність може бути виведена з наступної степеневої залежності:\n\n$$\nC(\\varepsilon) \\sim \\varepsilon^{\\nu}, \n$$\n\nабо слідуючим чином:\n\n$$\nD_2 = \\lim_{M\\to\\infty}\\lim_{\\varepsilon\\to 0}\\frac{\\log{\\left( g_{\\varepsilon}/N^2 \\right)}}{\\log{\\varepsilon}}, \n$$\n\nде $g_{\\varepsilon}$ --- це сумарна кількість пар точок, відстань між якими менша за радіус $\\varepsilon$. \n\nЗа формулою $C(\\varepsilon)$ ми відбираємо $i$-ту траєкторію та всі інші $j$-ті траєкторії, і дивимося, чи потрапляють $j$-ті траєкторії в округ $i$-ої траєкторії з радіусом $\\varepsilon$. Якщо відстань між ними не перевищує округ зі згаданим радіусом, ми ставимо 1. Але якщо відстань між траєкторіями більша за $\\varepsilon$, тоді ставимо 0. Далі все це підсумовується, ділиться на загальну кількість траєкторій. По суті кореляційний інтеграл це середня ймовірність того, що дві розглянуті траєкторії фазового простору, що розглядаються, будуть знаходитися досить близько одна до одної. Чим тісніше розташовані точки фазового простору одна до одної, тим більше значення кореляційного інтеграла. Чим більш рівновіддаленими видаються траєкторії одна від одної, тим ближче значення кореляційного інтеграла до нуля.   \n\nЗначення кореляційної розмірності ми можемо відшукати аналогічно попередним фрактальним показникам: ми шукаємо залежність кореляційного інтеграла від значення $\\varepsilon$. Ця залежність будується в логарифмічному масштабі. \n\n::: {.callout-tip}\n## Додаткова інформація по кореляційні розмірності\n\nКореляційна розмірність за аналогією з попередніми показниками --- це теж тангенс кута нахилу лінії регресії, побудованої в логарифмічному масштабі, але для залежності кореляційного інтеграла від $\\varepsilon$. За аналогією з іншими показниками, кореляційна розмірність визначає швидкість зміни значення кореляційного інтеграла (крутість нахилу лінії регресії). \n\n:::\n\n\n\n::: {#fig-d2}\n\n![](Images\\lab_6\\corrdim.jpg)\n\nЗміна значення кореляційного інтеграла в залежності від ступеня розкиданості точок по фазовому простору системи\n\n:::\n\nЗа фазовим простором цієї хмари точок ( @fig-d2 ) можна бачити, що більша згуртованість точок одна до одної має асоціюватися з меншою кореляційною розмірністю. Рисунок (а) характеризується найвищою близькістю точок одна до одної, але при цьому найменшою кореляційною розмірністю. Це можна пояснити так: якщо ми будуємо сітку з кіл радіусом $\\varepsilon$ і поступово її збільшуємо, ми вже перестаємо бачити нові прилеглі траєкторії до тих $i$-их траєкторій, які ми розглядали із самого спочатку, на початкових значеннях $\\varepsilon$. На рисунках (b) і (c) видно, що хмара траєкторій фазового простору є більш рівномірно розподіленою. За поступового збільшення радіуса кіл із центрами в кожній $i$-ій траєкторії ми повинні спостерігати пропорційне збільшення значення кореляційного інтеграла. У даному випадку при поступовому збільшенні $\\varepsilon$ ми спостерігаємо появу все більшої і більшої кількості точок. \n\nУ періодичних системах кореляційна розмірність залишається постійною і дорівнює розмірності вкладення. Наприклад, для простої періодичної системи, такої як синусоїда, кореляційна розмірність дорівнюватиме 1 (оскільки вона лежить на одновимірній кривій), а якщо систему реконструюють у двовимірному фазовому просторі (за двома координатами), то кореляційна розмірність дорівнюватиме 2. У таких системах кореляційна розмірність не змінюється. \n\nДля хаотичних систем кореляційна розмірність має характерну поведінку, яка залежить від кількості змінних (розмірностей), необхідних для точного опису динаміки системи. На відміну від періодичних систем, кореляційна розмірність зростає в міру збільшення розмірності фазового простору, поки не досягне плато. \n\n**Електрокардіограма** (ЕКГ):\nЕКГ-сигнали відображають електричну активність серця. Складність ЕКГ-сигналу може бути оцінена за допомогою кореляційної розмірності. Очікується, що кореляційна розмірність ЕКГ здорового серця буде вищою через наявність складних патернів і варіабельності. З іншого боку, аномальні ЕКГ-сигнали, наприклад, від пацієнтів з аритміями або серцевими захворюваннями, можуть мати нижчу кореляційну розмірність через втрату складності сигналу.\n\n**Електроенцефалограма** (ЕЕГ):\nСигнали ЕЕГ реєструють електричну активність мозку. Кореляційна розмірність може використовуватися для аналізу складності мозкової активності, яка може змінюватися залежно від різних когнітивних станів, стадій сну або неврологічних розладів. У здорових людей сигнали ЕЕГ у стані бадьорості та уваги можуть мати вищу кореляційну розмірність порівняно з сигналами у стадії сну, коли активність мозку є більш регулярною і синхронізованою.\n\n**Дихальні сигнали**:\nДихальні сигнали, такі як частота дихання або повітряний потік, також можуть бути проаналізовані за допомогою кореляційної розмірності. Складність цих сигналів може змінюватися залежно від таких факторів, як стрес, фізичне навантаження або наявність респіраторних захворювань. За нормального дихання може спостерігатися вища кореляційна розмірність, тоді як порушення в дихальних сигналах, наприклад, за обструктивного апное уві сні або дихальних розладів, можуть призвести до зниження кореляційної розмірності.\n\n**Аналіз ходи**:\nКореляційна розмірність може бути використана для аналізу моделей ходи. Вона може допомогти в розумінні складності рухів людини під час ходьби або бігу. Зміни в кореляційній розмірності сигналів ходи можуть свідчити про зміну стабільності ходи або про наявність відхилень у ході, викликаних неврологічними або опорно-руховими захворюваннями.\n\n**Варіативність динаміки серцевого ритму** (ВСР):\nВСР являє собою зміну часових інтервалів між послідовними ударами серця. Вона перебуває під впливом вегетативної нервової системи і відображає адаптивність і складність серцево-судинної системи. Вищий рівень ВСР, що відповідає вищій кореляційній розмірності, зазвичай асоціюється з кращим станом серцево-судинної системи та її адаптивністю до фізіологічних змін і змін навколишнього середовища. Її падіння може асоціюватися з аномальною динамікою серця.\n\n**Послідовності ДНК**:\nКореляційна розмірність може бути використана і при аналізі послідовностей ДНК. Вона допомагає виявити самоподібні або фрактальні патерни всередині послідовностей, що може мати значення для розуміння генетичної складності, еволюційних зв'язків і регуляції генів. Висока кореляційна розмірність --- висока складність ланцюжка ДНК. Мала кореляційна розмірність --- спрощений ланцюжок ДНК.\n\n**Фінансові ринки**\nВища кореляційна розмірність у даних часових рядів фінансового ринку свідчить про більшу складність та існування в їхній основі самоподібних моделей або фрактальних структур. Хаотична поведінка цін на акції може бути пов'язана з періодами високої волатильності та непередбачуваності. З іншого боку, нижча величина кореляційної розмірності може свідчити про більш передбачувані та менш складні рухи цін, що відповідає періодам стабільності або менш волатильним ринковим умовам.\n\n::: {.callout-note}\n## Примітка по кореляційні розмірності\n\nКореляційна розмірність розглядає кількість інформації (кубиків, кіл), необхідну для опису **тільки пари точок** у фазовому просторі.  \n\n:::\n\n\n\n## Хід роботи\n\nРозглянемо як можна застосовувати зазначені показники в якості індикаторів кризових станів. \n\nСпочатку імпортуємо необхідні бібліотеки для подальшої роботи:\n\nДалі виконаємо налаштування формату виведення рисунків:\n\nУ даній роботі скористаємось монофрактальними показниками для ідентифікації кризових явищ на ринку золота. Розглянемо значення золота за весь період, що представляє Yahoo! Finance. Для цього нам не треба буде вказувати початкову та кінцеву дати:\n\nВиводимо досліджуваний ряд:\n\nВизначимо функцію `transformation()` для стандартизації ряду:\n\n### Обчислення показника Херста із використанням *R/S*-аналізу\n\nДля подальших розрахунків використовуватимемо бібліотеку `neurokit2` та `fathon`. Другу можна встановити в наступний спосіб:\n\nДалі імпортуємо саму бібліотеку та дотичні до неї модулі:\n\nБібліотека `neurokit` містить необхідний метод для *R/S*-аналізу --- `fractal_hurst`. Його синтаксис виглядає наступним чином:\n\n**`fractal_hurst(signal, scale='default', corrected=True, show=False)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень або датафрейму бібліотеки `pandas`.\n- **scale** (*list*) --- список, що містить довжини вікон (кількість точок даних у кожній підмножині ряду), на які розбито сигнал.\n- **corrected** (*bool*) --- якщо значення `True`, до вихідних даних буде застосовано поправочний коефіцієнт Аніса-Ллойда-Пітерса відповідно до очікуваного значення для окремих значень (*R/S*).\n- **show** (*bool*) --- якщо значення `True`, виводить залежність $(R/S)_n$ від $n$ (**scale**) у подвійному логарифмічному масштабі. \n\n**Повертає**\n\n- **h** (*float*) --- показник Херста.\n- **kwargs --- словник, що містить інформацію відносно використовуваних у процедурі параметрів.\n\nРозглянемо ступінь трендостійкості в динаміці фондового індексу золота, використовуючи весь часовий ряд. Далі знайдемо значення показника Херста в рамках віконної процедури.\n\n#### Увесь часовий ряд\n\nПершочергово знайдемо значення прибутковостей для нашого ряду та стандартизуємо їх. Після цього виконаємо обчислення. \n\nВиконуємо *R/S*-аналіз:\n\nЯк ми можемо бачити з @fig-gold-rs-all, значення $h=0.53$, що свідчить про подібність динаміки золота до випадкового блукання. Але оскільки закони, що регулюють ринок, змінюються з часом, мають змінюватись і кореляції всередині системи, а одже коефіцієнт Херста також має залежати від періоду в якому він розглядається.   \n\n#### Віконна процедура\n\nВизначимо функцію для побудови парних графіків:\n\nПриступимо до віконної процедури:\n\nВізуалізуємо результат:\n\nНа представленому рисунку ( @fig-gold-wind-rs ) можемо бачити, що показник Херста зростає в передкризовий період та спадає під час кризи. Перед кризою динаміка ринку характеризується зростанням трендостійкості (персистентності), що відзеркалює зростання скорельованості дій між трейдерами ринку. \n\n### Обчислення на основі DFA\n\nБібліотека `fathon` представляє інструментарій як для виконання класичного аналізу детрендованих флуктуацій, так і для його мультифрактального аналогу, мова про який піде в наступній лабораторній. \n\n#### Для всього ряду\n\nСпочатку представимо значення $\\alpha$ для всього ряду. Процедура розрахунків на основі бібліотеки `fathon` виглядатиме наступним чином: \n\n1. знаходимо стандартизовані прибутковості ряду\n\nВиводимо залежність функції флуктуацій від характеристичного масштабу:\n\nБудуємо залежність функції флуктуацій від масштабу в подвійному логарифмічному масштабі:\n\nПроцедура DFA показує, що значення індексу золота представляються скоріше антиперсистентними, але представлений результат доволі близький до того, що був отриманий за допомогою *R/S*-аналізу. Розглянемо значення $\\alpha$ в рамках алгоритму ковзного вікна. \n\n#### Віконна процедура\n\nВизначимо наступні параметри:\n\nЗнайдемо показник Херста ($\\alpha$), фрактальну розмірність ($D_f$), показник спектральної щільності ($\\beta$) та показник автокореляції ($\\gamma$):  \n\nЗберігаємо абсолютні значення показників до текстових файлів:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результати:\n\nЯкщо порівнювати з *R/S*-аналізом, @fig-gold-wind-alpha демонструє, що динаміка *узагальненого показника Херста* отриманого за допомогою DFA є набагато стабільнішою. Тепер ми здатні диференціювати значну частку крахових подій, що мали місце на ринку золота. Узагальнений Херст показує, що передкризові явища характеризуються зростанням трендостійкості ринку або, іншими словами, підвищенням ступеня самоорганізації системи. \n\n@fig-gold-wind-df показує, що $D_f$ характеризується спадом при кризових станах. Це є індикатором того, що вищий ступень організованості ринку відзеркалюється в більш згладженій або менш шорстких флуктуаціях досліджуваного сигналу.  \n\nНа даному рисунку ми бачимо динаміку показника $\\beta$, що відноситься до спектральної густини потужності ($P(f)=1/f^{\\beta}$), зростає в кризові періоди, що говорить про спад потужності сигналу, що припадає на одиничний інтервал частоти. Це також є свідченням зростання кореляційних властивостей системи. \n\nНа @fig-gold-wind-gamma видно, що показник $\\gamma$ спадає в кризові та передкризові періоди. Це є показником сповільнення спаду функції автокореляції, що в свою чергу також вказує на зростання корельованності динаміки системи. \n\n### Обчислення фрактальної розмірності Хігучі\n\nЯк уже зазначалося, фрактальна розмірність Хігучі є одним із різновидів фрактальної розмірності для часових рядів. Вона обчислюється шляхом реконструкції $k$-максимальної кількості нових наборів даних. Для кожного відновленого набору даних обчислюється довжина кривої і відкладається проти відповідного k-значення в логарифмічній шкалі. HFD відповідає нахилу лінійного тренду за методом найменших квадратів.\n\nРозрахуємо оптимальне значення $k$ для всього часового ряду. Бібліотека `neurokit2` представляє готову процедуру для автоматизованого підбору даного параметру. Оптимальний $k_{max}$ розраховується на основі точки, в якій значення фрактальної розмірності досягає плато для діапазону значень $k_{max}$ (див. Vega, 2015). \n\nСинтаксис даної функції виглядає наступним чином:\n\n**`complexity_k(signal, k_max='max', show=False)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **$k_{max}$** (*Union[int, str, list], optional*) --- максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити. Якщо  $k_{max}$=`default`, тоді вибирається максимально можливе значення, що відповідає половині довжини сигналу.\n- **show** (*bool*) --- візуалізовується нахил кривої для обраного значення $k_{max}$. \n\n**Повертає**\n\n- **k** (*float*) --- оптимальний $k_{max}$ часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення оптимального $k_{max}$.\n\n#### Для всього ряду\n\nДля подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків: \n\nІ тепер отримаємо оптимальне значення $k_{max}$ згідно зазначеної процедури:\n\nТепер побудуємо залежність довжини сигналу від часового зміщення в логарифмічному масштабі. Для фрактального сигналу має зберігатися лінійна залежність. Бібліотека `neurokit2` містить метод для розрахунку даної фрактальної розмірності. Синтаксис цієї процедури виглядає наступним чином:\n\n**`fractal_higuchi(signal, k_max='default', show=False, **kwargs)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **$k_{max}$** (*Union[int, str, list], optional*) --- максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити.\n- **show** (*bool*) --- візуалізовується нахил кривої для обраного значення $k_{max}$. \n\n**Повертає**\n\n- **HFD** (*float*) --- фрактальна розмірність Хігучі для досліджуваного часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Хігучі.\n\nУ подальшому будемо послуговуватись отриманим оптимальним значенням для розрахунку розмірності Хігучі в рамках алгоритму ковзного вікна. \n\n#### Віконна процедура\n\nСкористаємось наступними параметрами:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nЯк можна бачити з представленого рисунку, фрактальна розмірність Хігучі може працювати як індикатор або індикатор-передвісник кризових явищ. Видно, що даний показник починає спадати у передкризові періоди чи у сам момент кризи, вказуючи на зростання згладженності динаміки системи, ступеня кореляцій та трендостійкості динаміки ринку. \n\n### Обчислення фрактальної розмірності Петросяна\n\nПетросян (1995) запропонував швидкий метод оцінки фрактальної розмірності шляхом перетворення сигналу в двійкову послідовність, з якої оцінюється фрактальна розмірність. Існує кілька варіацій алгоритму (`neurokit2`, наприклад, пропонує `\"A\"`, `\"B\"`, `\"C\"` або `\"D\"`), що відрізняються насамперед способом створення дискретної (символьної) послідовності (див. `complexity_symbolize()` для деталей). Найпоширеніший метод (`\"C\"`, за замовчуванням) бінаризує сигнал за знаком послідовних різниць.\n\nБільшість з цих методів дискретизації припускають, що сигнал є періодичним (без лінійного тренду). Для усунення лінійних трендів може бути корисним лінійне детрендування.\n\nСинтаксис даної процедури має наступний вигляд:\n\n**`fractal_petrosian(signal, symbolize='C', show=False)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **symbolize** (*str*) - метод перетворення неперервного вхідного сигналу в символьний (дискретний) сигнал. За замовчуванням присвоює 0 та 1 значенням нижче та вище середнього. Може мати значення `None`, що припускає, що вхідний сигнал вже є дискретним.\n- **show** (*bool*) --- виводить дискретизацію сигналу. \n\n**Повертає**\n\n- **PFD** (*float*) --- фрактальна розмірність Петросяна для досліджуваного часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Петросяна.\n\nМи не розглядатимемо детально синтаксис функції `complexity_symbolize()`. Опишемо лише ті методи дискретизації, що дотичні до фрактальної розмірності Петросяна:\n- **Метод `A`** бінаризує сигнал за більшими та меншими значеннями порівняно із середнім значенням сигналу. Еквівалентом є `method=\"mean\"` (`method=\"median\"` також є допустимим).\n- **Метод `B`** використовує значення, що знаходяться в діапазоні $\\pm 1\\sigma$, проти значень, що виходять за межі цього діапазону.\n- **Метод `C`** обчислює різницю між послідовними вибірками та бінаризує їх залежно від знаку.\n- **Метод `D`** відокремлює послідовні відліки, що перевищують $1\\sigma$ сигналу, від інших менших змін.\n\nТепер розглянемо віконну динаміку даного показника. \n\n#### Віконна процедура\n\nОскільки більшість з даних методів дискретизації вимагаються детрендування ряду, тоді будемо виконувати розрахунки для прибутковостей індексу золота.Скористаємось наступними параметрами:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n@fig-gold-wind-petro показує, що показник Петросяна також спадає під час кризових подій, що вказує на зростання періодизації ринку та синхронізації активності трейдерів у відповідні моменти часу.\n\n### Обчислення фрактальної розмірності Каца\n\nТепер обчислюємо фрактальну розмірність Каца. Евклідові відстані між послідовними точками сигналу підсумовуються і усереднюються, а також визначається максимальна відстань між початковою точкою і будь-якою іншою точкою у вибірці.\n\nФрактальна розмірність варіюється від 1.0 для прямих ліній, приблизно до 1.15 для випадкових блукань і наближається до 1.5 для найбільш \"дивних\" форм сигналу.\n\nСинтаксис процедури для розрахунку даної розмірності виглядає наступним чином:\n\n**`fractal_katz(signal)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n\n**Повертає**\n\n- **KFD** (*float*) --- фрактальна розмірність Каца для досліджуваного часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nОскільки даний показник є параметронезалежним, нам достатньо буде лише розміру часового вікна, кроку та типу ряду:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nНа представленому рисунку видно, що фрактальна розмірність Каца також спадає у кризові та передкризові періоди. Це також є індикаторов зростання ступеня корельованості системи в дані періоди.\n\n### Обчислення фрактальної розмірності Севчика\n\nАлгоритм цієї фрактальної розмірності був запропонований для обчислення фрактальної розмірності сигналів Севчиком (1998). Цей метод можна використовувати для швидкого вимірювання складності та випадковості сигналу.\n\nСинтаксис методу, що ми використовуватимемо в подальшому, має наступний вигляд:\n\n**`fractal_sevcik(signal)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n\n**Повертає**\n\n- **SFD** (*float*) --- фрактальна розмірність Севчика для досліджуваного часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nДля цього показника нам також не потребується нічого зайвого:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nБачимо, що і фрактальна розмірність Севчика реагує спадом на крахові події на ринку золота. Особливо характерними є спади під час кризи 2008, 2011, 2015 та 2020 років, що є ключовими та дослідженими багатьма вченими. Динаміка індексу золота під час зазначених кризових подій також характеризувалися зростанням персистентності (кореляцій).\n\n### Обчислення фрактальної розмірності через нормалізовану щільність довжини\n\nЦе доволі простий показник, що відповідає середнім абсолютним послідовним різницям (стандартизованого) сигналу (`np.mean(np.abs(np.diff(std_signal)))`). Цей метод було розроблено для вимірювання складності сигналів дуже короткої тривалості (< 30 відліків), і його можна використовувати, наприклад, коли цікавлять безперервні зміни фрактальної розмірності сигналу, обчислюючи його в межах ковзних вікон.\n\nДля таких методів, як для фрактальної розмірності Хігучі, стандартне відхилення віконної фрактальної розмірності різко зростає, коли довжина ряду стає коротшою. Цей метод дає менше стандартне відхилення, особливо для коротших фрагментів, хоча і за рахунок меншої точності середнього значення фрактальної розмірності вікна.\n\nСинтаксис процедури має наступний вигляд:\n\n**`fractal_nld(signal, corrected=False)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **corrected** (*bool*) --- якщо значення `True`, змінює масштаб вихідного значення фрактальної розмірності відповідно до степеневої моделі, щоб зробити його більш порівнянним з \"істинним\" значенням: `FD = 1.9079*((NLD-0.097178)^0.18383)`. Зауважте, що це може призвести до `np.nan`, якщо результат різниці буде від'ємним.\n\n**Повертає**\n\n- **NLDFD** (*float*) --- фрактальна розмірність через нормалізовану щільність довжини.\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nДля цього показника нам також не потребується нічого зайвого:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n@fig-gold-wind-nld показує, що $NLDFD$ спадає під час кризових та передкризових подій, що вказує на зростання кореляцій у дані періоди. \n\n### Обчислення фрактальної розмірності через нахил спектральної щільності потужності\n\nСкористаємось наступним методом бібліотеки `neurokit2`:\n\n**`fractal_psdslope(signal, method='voss1988', show=False, **kwargs)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **method** (*str*) --- метод оцінки фрактальної розмірності за нахилом, може бути `\"voss1988\"` (за замовчуванням) або `\"hasselman2013\"`.\n- **show** (*bool*) --- якщо значення `True`, повертає графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі.\n- **kwargs** --- інші аргументи, які слід передати до `signal_psd()`.\n\n**Повертає**\n\n- **slope** (*float*) --- оцінка фрактальної розмірності, отримана в результаті аналізу нахилу спектральної щільності потужності.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для аналізу нахилу спектральної щільності потужності.\n\n#### Для всього ряду\n\nДля подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків: \n\nІ тепер виведемо графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі:\n\nЯк можна бачити з представленого графіку, спектральний нахил спектральної щільності потужності на різних частотах має лінійну залежність, а кут нахилу прямої, побудованої по спектру, близький до -2, що вказує на те, що динаміка індексу золота близька до дробового броунівського руху.\n\nТепер розглянемо варіацію кута нахилу спектра в рамках алгоритму ковзного вікна.\n\n#### Віконна процедура\n\nВстановимо наступні параметри:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nРисунок вище показує, що даний показник також реагує спадом у кризові та передкризові події, вказуючи на зростання автокореляції часового ряду під час даних подій. Також зрозуміло, що має місце варіації нахилу спектра щільності потужності. В одні моменти часу динаміка сигналу може бути подібна до броунівського руху, а в інші до білого шуму.\n\n### Обчислення кореляційної розмірності\n\nКореляційна розмірність (також позначається як $D_2$) є нижньою границею оцінки фрактальної розмірності досліджуваного фазового простору.\n\nСпочатку здійснюється реконструкція фазового простору сигналі згідно методу часової затримки, і далі обчислюються відстані між усіма точками траєкторії. Потім обчислюється \"кореляційна сума\", яка є часткою пар точок, відстань між якими менша за заданий радіус. Остаточна кореляційна розмірність апроксимується графіком залежності кореляційної суми від радіусу багатовимірного околу досліджуваних траєкторій, що будується в логарифмічному масштабі.\n\nЦю розмірність можна викликати через `fractal_correlation()`. Її синтаксис виглядає наступним чином:\n\n**`fractal_correlation(signal, delay=1, dimension=2, radius=64, show=False, **kwargs)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n- **delay** (*int*) --- часова затримка ($\\tau$).\n- **dimension** (*int*) --- розмірність вкладень ($m$).\n- **radius** (*Union[str, int, list]*) --- послідовність радіусів для перевірки. Якщо передано ціле число, буде отримано експоненціальну послідовність довжиною заданим скалярним значенням `radius` у межах від 2.5% до 50% від діапазону відстані. Методи, реалізовані в інших пакетах, можна використовувати, вказуючи `\"nolds\"`, `\"Corr_Dim\"` або `\"boon2008\"`.\n- **show** (*bool*) --- графік кореляційної розмірності, якщо `True`. За замовчуванням --- `False`.\n- **kwargs** --- інші аргументи для передачі (наразі не використовуються).\n\n**Повертає**\n\n- **cd** (*float*) --- кореляційна розмірність часового ряду.\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення кореляційної розмірності.\n\n#### Для всього часового ряду\n\nРозглянемо залежність кореляційної суми від радіусу для всього часового ряду. Перш за все виконаємо перетворення ряду:\n\nТепер розрахуємо кореляційну розмірність, побудувавши залежність кореляційної суми від радіусу в логарифмічному масштабі:\n\nЯк ми можемо бачити, кореляційна сума дійсно має лінійну залежність для різних значень радіусу околу певної траєкторії, що вказує на фрактальність системи. Тепер подивимось як варіюється значення кореляційної розмірності в періоди турбулентності.\n\n#### Віконна процедура\n\nДля цього показника визначимо наступні параметри:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n@fig-gold-wind-cd демонструє, що кореляційна розмірність для індексу золота також спадає у кризові та передкризові періоди, вказуючи на зростання корельованості теперішніх цін на золото з попередніми. Можна сказати і по іншому: у період криз трейдери починають самоорганізовуватись та колективно скупати або продавати відповідний актив; іншими словами, їх динаміка стає більш синхронною. Оскільки кореляційна розмірність вимірюється для траєкторій фазового простору, спад цього показника свідчить про зростання щільності досліджуваних траєкторій. Тобто, фазовий простір стає більш розрідженим, а всі його траєкторії концентрованими лише в одній конкретній області, що є індикатором згуртованості прихованих змінних досліджуваної системи.\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"highlight-style":"oblivion","css":["style.css"],"output-file":"lab_6.html"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рисунок","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"ru","fig-responsive":true,"quarto-version":"1.3.433","bibliography":["references.bib"],"callout-appearance":"default","page-layout":"full","theme":{"light":"cosmo","dark":"superhero"},"title":"Лабораторна робота № 6"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":true,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","toc":true,"number-sections":true,"output-file":"lab_6.pdf"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рисунок","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"block-headings":true,"lang":"ru","bibliography":["references.bib"],"callout-appearance":"default","documentclass":"report","title":"Лабораторна робота № 6"},"extensions":{"book":{"selfContainedOutput":true}}},"docx":{"identifier":{"display-name":"MS Word","target-format":"docx","base-format":"docx"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","toc":true,"number-sections":true,"output-file":"lab_6.docx"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рисунок","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"ru","bibliography":["references.bib"],"callout-appearance":"default","title":"Лабораторна робота № 6"},"extensions":{"book":{"selfContainedOutput":true}}},"epub":{"identifier":{"display-name":"ePub","target-format":"epub","base-format":"epub"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"epub","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":false,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"default-image-extension":"png","html-math-method":"mathml","to":"epub","toc":true,"number-sections":true,"output-file":"lab_6.epub"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рисунок","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"ru","bibliography":["references.bib"],"callout-appearance":"default","title":"Лабораторна робота № 6"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf","docx","epub"]}