{"title":"Лабораторна робота № 12","markdown":{"yaml":{"title":"Лабораторна робота № 12"},"headingText":"Анотація","containsRefs":false,"markdown":"\n\n\n\n\n**Тема.** Важкі хвости: вплив одиничних катастрофічних подій. Аналіз кризових подій із використанням Леві альфа-стабільного розподілу.\n\n**Мета.** Навчитися використовувати розподіл Леві для диференціації флуктуацій, що виходять за межі нормального розподілу.\n\n\n\n::: {.callout-note}\n\nУ цій лабораторній ми досліджуємо розподіл прибутковості фінансових активів і стабільність певних показників, які ми розраховуємо, опираючись на ці активи. Зокрема, ми побачимо, що більш високі моменти розподілу прибутковостей з важкими хвостами насправді дуже нестабільні, нескінченні або взагалі не визначені, і що, наприклад, одна єдина точка даних визначає більшу частину надлишкового ексцесу. Цей факт має досить драматичні наслідки, оскільки популярні моделі, такі як GARCH, базуються на можливості оцінки кінцевого значення ексцесу. Суть, яку ми хочемо донести, полягає в тому, що, не приділяючи особливої уваги повноті фінансових розподілів, не можна очікувати, що моделі будуть працювати за межами навчальної та тестувальної вибірки. Аналітики та трейдери завжди будуть дивуватись новим екстремальним подіям, що, як правило, рідко бувають позитивними.\n:::\n\n## Теоретичні відомості\n\n### Імпортуємо необхідні бібліотеки\n\n::: {.callout-important}\n## Увага \n\nПерш за все, для подальшої роботи, нам необхідно буде встановити бібліотеку `pylevy`. Встановити її можна з відповідного [GitHub репозиторію](https://github.com/josemiotto/pylevy/tree/master). Ми у свою чергу завантажимо її напряму через команду `pip install` слідуючим чином:\n \n:::\n\nПісля встановлення необхідного модулю можна приступати до подальшої роботи. \n\n### Виконуємо налаштування рисунків\n\n### Зчитування даних \n\n### Важкі хвости та Чорні понеділки\n\nСпочатку ми розглянемо розподіл щоденних прибутковостей індексу S&P 500, починаючи з 1950 року. У клітинці нижче буде показано [Pandas dataframe](https://pandas.pydata.org/docs/user_guide/10min.html) `df`, що містить дані OHLC з файлу (ці дані були попередньо завантажені в клітинці вище).\n\nЦей історичний ряд щоденних цін містить \\~ 18527 торгових днів. Замість того, щоб дивитися безпосередньо на ціни, ми розглянемо щоденні [*log*-прибутковості](https://lucaslouca.com/Why-Use-Logarithmic-Returns-In-Time-Series-Modelling/) індексу S&P 500. Пам'ятайте, що логарифмічна прибутковість $r_t$ визначається як логарифм відношення між цінами закриття $p_t$ у теперішній момент часу та попередній, $p_{t-1}$:\n\n$$\nr_t = \\log(\\frac{p_t}{p_{t-1}})\n$$\n\nЛогарифмічні прибутковості характеризуються симетрією, тобто якщо в один день індекс втрачає $r_t = -0.1$, а на наступний день індекс набирає $r_{t+1} = +0.1$, індекс знову досягає початкової ціни. Зі звичайними прибутковостями, спочатку втративши $10\\%$, а потім знову набравши $10\\%$, ви не повернетесь до початкової ціни. Ми зберігаємо прибутковості в новому фреймі даних `lr`:\n\nВикористовуючи вбудовані функції Pandas та Numpy, тепер ми можемо подивитись на найгірше щоденнє значення прибутковостей. Ми виявляємо, що найгірше значення становило $-0.229$, що відповідає $-22.9\\%$, і що це сталося в понеділок, 19 жовтня 1987 року --- так званий [*Чорний понеділок*](https://en.wikipedia.org/wiki/Black_Monday_(1987)).\n\nДалі ми будуємо графік вибіркового розподілу щоденних логарифмічних прибутковостей, що демонструє нам, як часто ми спостерігаємо щоденні прибутковості певного знака та величини. Зверніть увагу, що ми встановили логарифмічне масштабування для вісі Оy, щоб мати краще представлення про хвости розподілу, тобто дуже великі, але рідкісні негативні та позитивні прибутковості --- крахи та підйоми:\n\nЯк ми можемо описати погіршення розподілу прибутковості? За допомогою [логарифмічного масштабування](https://en.wikipedia.org/wiki/Logarithmic_scale) осі Oy, щоб експоненціальний спад виглядав лінійно, тому ми могли би запідозрити, що при малих абсолютних значеннях прибутковості розподіл зменшується експоненціально, але в міру збільшення абсолютних значень прибутковостей ми все більше і більше відхиляємося від початкового нахилу. Насправді, ми можемо показати, що ні розповсюдженний [розподіл Гауса](https://en.wikipedia.org/wiki/Normal_distribution) (також званий *нормальним* розподілом), ні [розподіл Лапласа](https://en.wikipedia.org/wiki/Laplace_distribution) з його експоненціальним спадом з обох сторін точно не можуть змоделювати розподіл прибутковостей S&P 500. Як розподіл Гауса, так і розподіл Лапласа недооцінюють ймовірність екстремальних подій --- підйомів та крахів:\n\n### Відхилення в 23 сигма\n\nЯк ми можемо бачити вище, як розподіл Гауса, так і розподіл Лапласа різко недооцінюють ймовірність дуже волатильної динаміки! Часто зазначають, що трапилась \"[3-сигма](https://en.wikipedia.org/wiki/68%E2%80%9395%E2%80%9399.7_rule) подія на ринку\" або щось подібне, тому що багатьом людям подобається оцінювати індивідуальні прибутковості по [стандартному відхиленню](https://en.wikipedia.org/wiki/Standard_deviation) (зване \"сигмою\") підібраного гаусового розподілу. Однак, якщо Розподіл Гауса взагалі не відповідає розподілу вибірки, як у нашому випадку, оцінка краху в одиницях \"сигма\" може ввести в оману! Щоб показати це, ми спочатку перевіримо, на скільки сигм ринок змістився в Чорний понеділок 1987 року:\n\nВиходячи з розподілу по Гауса, Чорний понеділок був би подією з \"23 сигмами\"! Тепер Розподіл Гауса чітко говорить нам, як часто X-сигма подія має відбуватися:\n\n- 1-сигма: прибл. 1 з 3 днів\n- 2-сигма: прибл. 1 з 22 днів\n- 3-сигма: прибл. 1 з 370 днів\n\n...\n\nМи можемо розширити цю таблицю, попрацювавши з [функцією кумулятивного розподілу](https://en.wikipedia.org/wiki/Cumulative_distribution_function), тісно пов'язана з [функцією виживання](https://en.wikipedia.org/wiki/Survival_function), і перемістивши обчислення в логарифмічний простір для чисельної стабільності, як демонструють наступні комірки коду:\n\nЩоб отримати додаткову інформацію про частоту екстремальних прибутковостей, ми можемо навіть створити невеликий [інтерактивний віджет](https://ipywidgets.readthedocs.io/en/latest/examples/Widget%20Basics.html) за допомогою повзунка, який вказує кількість \"сигм\", а текст поруч із ним показує середню кількість днів між двома такими екстремальними подіями:\n\nВи бачите, що при переміщенні повзунка вправо кількість днів або років між двома наступними \"X-сигма\" подіями швидко наростає. Наша таблиця тепер виглядає наступним чином:\n\n- 1-сигма: прибл. 1 з 3 днів\n- 2-сигма: прибл. 1 з 22 днів\n- 3-сигма: прибл. 1 з 370 днів\n\n...   \n\n- 23-сигма: приблизно 1 з $10^{116}$ днів (!!!)\n\nВнесемо ясність: виходячи з розподілу Гауса, щоденні втрати Чорної п'ятниці 1987 року повинні бути подією, яку ми очікуємо раз на $10^{116}$ днів. Це число в значній мірі незбагненно велике. Якби S&P 500 почав торгуватися відразу після [народження Всесвіту](https://en.wikipedia.org/wiki/Age_of_the_universe), це становило б лише $10^{13}$ торгових днів. Через $10^{116}$ днів усі зірки у Всесвіті давно згорять, навіть усі [чорні діри випаруються](https://en.wikipedia.org/wiki/Future_of_an_expanding_universe#Dark_Era_and_Photon_Age) і Всесвіт стане темним і порожнім місцем. Тож або ми повинні бути дуже щасливі, що єдина очікувана Чорна п'ятниця в історії та майбутньому Всесвіту позаду, або ви дійсно ніколи не повинні використовувати Розподіл Гауса для моделювання прибутковості акцій! Незалежно від ринку та деталей, якщо хтось говорить про події з 10 сигмами або 23 сигмами, він, безумовно, використовує неправильну модель, оскільки шанс спостерігати таку подію в нашому житті незначний.\n\nОтже, виникає питання: Як ми справляємось із такими екстремальними значеннями? Чи слід позначати їх як [викиди](https://en.wikipedia.org/wiki/Outlier) або артефакти, щоб наші фінансові моделі краще описували більшість значень? Звичайно, ні, оскільки результат наших інвестицій може критично залежати не від більшості менших прибутковостей, а саме від таких екстремальних подій! Далі ми познайомимося з підходом, який може пояснити та екстраполювати за межі екстремальних подій, таких як Чорний понеділок. Але ми також побачимо, що не всі способи врахування важких хвостів розподілів працюють добре, оскільки деякі моделі, такі як [GARCH](https://en.wikipedia.org/wiki/Autoregressive_conditional_heteroskedasticity) може заколисати нас помилковим почуттям безпеки, коли ми завжди беремо до уваги минулі екстремальні події, але завжди дивуємося новим.\n\n### Статистика степеневого розподілу\n\nТепер, коли ми знаємо, що розподіл Гауса не є хорошим вибором, який тип розподілу насправді може описати частоту екстремальних подій, які струшують S&P 500? Частота екстремально позитивні та негативні прибутковості асиметричні для більшості фінансових активів, оскільки крахи, як правило, більш сильні, ніж підйоми. Ось чому нижче ми зосередимося на лівому (негативному) хвості розподілу прибутковостей.\n\nОскільки нас цікавлять лише екстремальні події, ми розглянемо лише ті прибутковості, які менше $-0.03$ (приблизно три стандартних відхилення від середнього значення). Нижче ми візуалізуємо ці екстремально негативні показники прибутковостей в [логарифмічному масштабі](https://en.wikipedia.org/wiki/Log%E2%80%93log_plot) (тут ми використовуємо абсолютні значення негативних прибутковостей). Як вісь Oy (яка показує частоту логарифмічних прибутковостей), так і вісь Ox (яка показує величину логарифмічних прибутковостей) масштабуються логарифмічно:\n\nЯк ми бачимо, ця гістограма екстремальних абсолютних прибутків зменшується приблизно лінійно при логарифмічному масштабуванні. Щоразу, коли ви виявляєте пряму лінію на логарифмічному графіку, це вказує на так званий [степеневий розподіл](https://en.wikipedia.org/wiki/Power_law). Степеневе співвідношення ймовірності спостереження великих абсолютних логарифмічних прибутковостей задається у вигляді:\n\n$$\np(|r_t|) = c \\cdot |r_t|^{-\\alpha}\n$$\n\nКонстанта $c$ на даний момент нас не надто турбує, вона просто гарантує, що ліва частина рівняння належним чином нормалізована, але показник $\\alpha$ представляє для найбільший інтерес, оскільки він говорить нам, як працює степеневий закон. Якщо ви знаєте частоту даних абсолютних логарифмічних прибутковостей, то степеневий закон підкаже вам, у скільки разів менш імовірними були б логарифмічні прибутковості подвоєного розміру:\n\n$$\np(2 \\cdot |r_t|) = c \\cdot (2 \\cdot |r_t|)^{-\\alpha} = 2^{-\\alpha} \\cdot c \\cdot |r_t|^{-\\alpha} = 2^{-\\alpha} \\cdot p(|r_t|)\n$$\n\nабо простіше:\n\n$$\n\\frac{p(2 \\cdot |r_t|)}{p(|r_t|)} = \\frac{1}{2^{\\alpha}}\n$$\n\nДля $\\alpha = 0$ всі прибутковості однаково ймовірні, для $\\alpha = 2$ подвоєння прибутковостей робить їх у 4 рази менш імовірними. Оскільки це правило подвоєння вгору або вниз не залежить від значення самого $\\left| r_t \\right|$, але працює для всіх значень $\\left| r_t \\right|$. Степеневе співвідношення також називаються \"безмасштабним\" або [масштабо-інваріантним](https://en.wikipedia.org/wiki/Scale_invariance).\n\nЯк щодо показника $\\alpha$ для наших надзвичайно негативних логарифмічних прибутковостей S&P 500? Ми можемо легко оцінити його за даними, але є деякі тонкощі у правильному розбитті вищезазначеної гістограми, які можуть вплинути на нашу оцінку (див., наприклад, [White et al. (2008)](https://esajournals.onlinelibrary.wiley.com/doi/10.1890/07-1288.1)). Щоб обійти ці проблеми з розбиттям, ми можемо замість цього оцінити степенний показник [кумулятивної гістограми](https://en.wikipedia.org/wiki/Histogram#Cumulative_histogram) логарифмічних прибутковостей, а потім відняти одиницю від отриманого нахилу:\n\nВиходячи з цієї оцінки, ми отримуємо степеневої показник, рівний $\\alpha \\approx 3.7$. Якщо ми побудуємо гістограму наших надзвичайно негативних логарифмічних прибутковостей, то побачимо, що вона добре відображає зниження ймовірності, оскільки масштаб збоїв збільшується. Однак цей степеневий показник все ще недооцінює ймовірність настання чергового \"Чорного понеділка\", оскільки лінія відповідності не ідеально підходить до цієї крайньої точки. Якби ми захотіли створити ще більш консервативну модель екстремальних подій, нам потрібно було б вручну ще більше зменшити значення $\\alpha$, щоб врахувати більшу ймовірність настання чорних понеділків за рахунок втрати точності підгонки для менших збоїв. Це перший раз, коли ми можемо побачити, як одна точка даних впливає на наші рішення щодо моделювання. На даний момент ми будемо довіряти оцінці параметра і погодимося з оцінкою $\\alpha=3.7$.\n\nМи можемо використовувати цей степеневий закон, щоб екстраполювати, як часто ми очікуємо настання чорного понеділка (або \"події з 23 сигмами\") у довгостроковій перспективі. Виходячи з наявних у нас даних, ми можемо оцінити, що ймовірність спостереження зниження на $-0.03$ або гірше становить близько $1.6\\%$. Слідуючи нашій степеневій кривій, зниження чорного понеділка на $-0.229$, таким чином, відбувалося б із частотою $\\left(\\frac{0.229}{0.03}\\right)^{-3.7} \\approx \\frac{1}{1845}$. Так само часто, як зниження на $-0.03$, яке ми спостерігаємо приблизно раз на три місяці. Це означає, що, виходячи з нашої степеневої кривої, очікується, що чорні понеділки, подібні до 1987 року, траплятимуться приблизно раз на 450 років (див. код нижче).\n\nЯкби ми включили більше даних, що містять інші приклади екстремальних подій, наприклад, з [Великої депресії](https://en.wikipedia.org/wiki/Great_Depression), ця оцінка може стати ще меншою. Аналогічно, якби ми скоригували степеневий показник так, щоб він був більш консервативним, ніж передбачає наш простий метод оцінки, ми також отримали б коротший період. Хоча 460 років все ще є дуже великим періодом, це набагато більш реалістична оцінка порівняно з $10^{114}$ роками, які ми отримали, використовуючи розподіл Гауса. Однією з переваг степеневої моделі є її здатність до екстраполяції: використовуючи степеневу оцінку $\\alpha$ та частоту менших прибутковостей, щодо яких ми маємо достовірні дані, ми можемо оцінити частоту майбутніх серйозних збоїв, щодо яких ми ще не отримали жодних даних. Ще про одну перевагу оцінки $\\alpha$ ми розглянемо далі.\n\n::: {.callout-tip}\n## ПРИМІТКА\n\nНе існує такого поняття, як \"подія з 10 сигмами\"! Справжня подія з 10 сигмами настільки неймовірно рідкісна, що пережити її протягом нашого життя --- мізерно мало. Екстремальні події, безумовно, трапляються, але вони не можуть бути описані за допомогою \"сигм\", їх потрібно враховувати і екстраполювати з використанням степеневих законів. Завжди будьте обережні, коли аналітики виправдовують себе за те, що вони не були готові до \"події з 10 сигмами\", оскільки це вказує на те, що їх моделі ризиків вкрай недосконалі.\n:::\n\n### Статистичні моменти під впливом важких хвостів\n\nЧому все це так важливо? Степенневий показник $\\alpha$ насправді багато говорить нам про стабільність і збіжність [моментів розподілу ймовірностей](https://en.wikipedia.org/wiki/Moment_(mathematics)), і це, в свою чергу, має значення для деяких найбільш часто використовуваних моделей у фінансах. Перші чотири центральні моменти --- це:\n\n- **[Середнє](https://en.wikipedia.org/wiki/Expected_value)**: очікуване значення розподілу\n- **[Дисперсія](https://en.wikipedia.org/wiki/Variance)**: Квадрат стандартного відхилення, який часто використовується для оцінки волатильності на основі розподілу прибутковості.\n- **[Асиметрія](https://en.wikipedia.org/wiki/Skewness)**: вимірює зміщення розподілу. Розподіл прибутковостей, як правило, має негативну асиметрію, оскільки збої є більш стрімкими, ніж підйоми.\n- **[Ексцес](https://en.wikipedia.org/wiki/Kurtosis)**: вимірює тяжкість хвостів розподілу. Розподіли прибутковостей зазвичай мають ексцес більший ніж у розподілі Гауса, тобто екстремальні події відбуваються частіше, ніж очікувалося в гаусовій моделі.\n\nЕксцес Гаусового розподілу дорівнює 3 (використовуючи визначення Пірсона, з визначенням Фішера [надлишкового ексцесу](https://en.wikipedia.org/wiki/Kurtosis#Excess_kurtosis) це 0), але наша вибірка щоденних логарифмічних прибутковостей S&P 500 має ексцес $28.6$, що знову вказує на те, що екстремальні події набагато більш вірогідні, що суперечить Гаусовому розподілу.\n\nТепер ми дійшли до того моменту, коли ми могли б запитати: наскільки сильно одна точка впливає на нашу оцінку ексцесу? Якщо ми перерахуємо ексцес всіх щоденних прибутків S&P 500 з 1950 року і виключимо тільки чорний понеділок 1987 року, ми отримаємо значення $14.3$, майже половину від значення, яке ми отримуємо, коли використовуємо всі значення! Видалення подальших найгірших днів, звичайно, ще більше зменшує ексцес, але ефект значно менший.\n\nБільш радикальний погляд на цю проблему досягається, якщо ми будуємо графік ексцесу в покроковому режимі, тобто для кожного дня ми будуємо розрахунковий ексцес, використовуючи всі минулі логарифмічні дані до цього моменту часу. Як ви можете бачити нижче, до \"Чорного понеділка\" ексцес ніколи не перевищував $15$, проте навіть через 35 років після \"Чорного понеділка\" ексцес ще не \"оговтався\" від цієї події і залишається на позначці 30. Чи означає це, що ми повинні просто ігнорувати Чорний понеділок як викид і продовжувати використовувати нашу \"чисту\" оцінку в $14.6$? Ні, точно ні! Як ми побачимо незабаром, ми скоріше повинні запитати себе, чи є сенс у тому, щоб оцінювати ексцес!\n\nТой факт, що одна точка даних може настільки сильно змінити нашу оцінку ексцесу, і, схоже, вона більше не сходиться, коли додаються нові точки даних, є чітким свідченням того, що ексцес базового розподілу ймовірностей насправді нескінченний! Проблема полягає в тому, що для кінцевої вибірки даних (а всі набори даних скінченні) ми завжди зможемо оцінити скінчене значення ексцесу. `scipy.stats.kurtosis` не може повернути $\\infty$, він завжди повідомлятиме про скінченний ексцес *вибірки*. Але ця кінцева оцінка не допоможе нам нічого сказати про майбутню поведінку ринку, оскільки ексцес продовжуватиме переходити до ще більших значень до наступного чорного понеділка, іншого чорного вівторка ... у більш-менш віддаленому майбутньому.\n\nОднак опис частоти екстремальних подій згідно степеневого закону, який ми представили вище, може допомогти нам вирішити, чи є ексцес кінцевим, так що, переглянувши достатню кількість точок даних, ми зможемо вирішити, чи слід прийняти той факт, що ексцес не піддається оцінці і справді нескінченний. Щоб побачити це, нам потрібно ввести ще один розподіл ймовірностей, [t-розподіл Стьюдента](https://en.wikipedia.org/wiki/Student%27s_t-distribution). Це колоколообразний симетричний розподіл зі степеневими хвостами. Його додатковий параметр $\\nu$ визначає показник степеневого закону $\\alpha=(\\nu+1)$. Нижче ми підганяємо t-розподіл до наших логарифмічних прибутковостей S&P 500, зберігаючи при цьому степеневий показник $\\alpha=3.7$ (відповідний $\\nu = 2.7$), який ми підганяли раніше:\n\nЗвичайно, можна поставити під сумнів, чи дійсно t-розподіл Стьюдента добре відповідає нашим логарифмічним прибутковостям, оскільки він переоцінює частоту абсолютних прибутковостей і все ще недооцінює ймовірність настання Чорного понеділка. На даний момент ми ігноруємо ці деталі та зосереджуємось на ексцесі t-розподілу Стьюдента та зв'язку зі степеневим показником $\\alpha$:\n\n- $\\text{Kurt} = \\frac{6}{\\nu-4} + 3~$ для $~\\nu > 4~$ або $~\\alpha > 5$\n- $\\text{Kurt} = \\infty~~~~~~~~~~\\,$ для $~2 < \\nu \\leq 4~$ або $~3 < \\alpha \\leq 5$\n- інакше невизначено\n\nЦе підтверджує наше початкове припущення про те, що при степеневому показнику, рівному $\\alpha \\approx 3.7$, ексцес дійсно нескінченний, і немає сенсу оцінювати його по скінченій вибірці, оскільки оціночне значення буде зберігатися тільки до наступної екстремальної події, яка підштовхне його ще вище. Ми можемо легко змоделювати цей ефект, витягуючи випадкові вибірки з t-розподілів Стьюдента з різними степеневими показниками, які відповідають трьом режимам, зазначеним вище. Нижче ми витягуємо 100 000 випадкових значень з t-розподілів з $\\alpha = 2$, $\\alpha = 3.7$, $\\alpha = 6$, а потім обчислюємо ексцес поетапно, як і раніше, щоб побачити, як еволюціонує передбачуваний ексцес вибірки з часом у трьох різних випадках:\n\nУ випадку $\\alpha=6$ ($\\nu=5$) ексцес скінченний і повинен приймати значення $\\frac{6}{\\nu - 4}+3=9$. Хоча ми бачимо деякі коливання, оціночне значення ексцесу повільно наближається до справжнього значення. Для прикладу, який відповідає степеневому показнику індексу S&P 500 з $\\alpha = 3.7$, моделювання показує таку ж поведінку, що і для реальних даних: збіжність не може бути виявлена, скоріше кожна екстремальна подія збільшує ексцес; при нескінченних вибірках ми би досягли нескінченного ексцесу. У третьому випадку з $\\alpha = 2$ ексцес t-розподілу Стьюдента навіть не визначений належним чином, і ми можемо побачити інший тип поведінки моделювання: зараз більшість точок даних збільшують оцінку ексцесу, а не лише кілька окремих екстремальних зразків. При такому повільно спадаючому статечному законі екстремальні значення зустрічаються повсюдно, що призводить до збільшення ексцесу при моделюванні.\n\n::: {.callout-tip}\n## Примітка\n\nНавіть якщо певні властивості розподілу ймовірностей нескінченні, ми завжди знайдемо кінцеві вибіркові оцінки при перегляді даного набору даних просто тому, що набір даних містить лише кінцеву кількість точок. Однак, якщо теорія степеневого закону чітко говорить нам, що певна властивість нескінченна, ми не повинні ніде використовувати кінцеві оцінки і ми не повинні використовувати моделі, які вимагають, щоб ця властивість була кінцевою! Якщо ми все одно це зробимо, це в кращому випадку буде працювати лише до наступної екстремальної події, яка анулює наші минулі оцінки і --- у випадку фінансових моделей --- може збанкрутувати нас!\n:::\n\n### Як ексцес дестабілізує розрахунки волатильності\n\nОскільки ексцес збільшується --- або стає нескінченним --- це також впливає на нижчі моменти, найголовніше, на дисперсію. Квадратний корінь дисперсії --- це стандартне відхилення, або [волатильність](https://en.wikipedia.org/wiki/Volatility_(finance)), як це називається у фінансах. Волатильність є розповсюдженним параметром при оптимізації портфеля і практично в кожній фінансовій моделі, оскільки в кінцевому підсумку вона стала найбільш часто використовуваним показником \"ризику\". Щоб побачити, як ексцес впливає на оцінку волатильності, ми проводимо простий експеримент [Монте-Карло](https://en.wikipedia.org/wiki/Monte_Carlo_method): ми витягуємо щоденну прибутковість за 50 років з розподілу ймовірностей за нашим вибором (ми будемо використовувати Гаусовий і t-розподіл Стьюдента) і обчислюємо оцінку волатильності, використовуючи вибіркове стандартне відхилення. Ми робимо це не тільки один раз, але і 10000 разів, кожен раз, коли ми розраховуємо нову гіпотетичну щоденну прибутковість за 50 років і обчислюємо відповідну оцінку волатильності. Звичайно, не всі ці оцінки будуть однаковими, але коливатимуться навколо справжньої волатильності, оскільки ми маємо лише кінцеву кількість даних. Оскільки ми знаємо справжній розподіл ймовірностей, який ми використовуємо для моделювання, ми також знаємо справжню волатильність. Щоб побачити, наскільки точно ми можемо оцінити волатильність на основі даних за 50 років, ми обчислюємо відносну похибку між оцінками волатильності та справжньою волатильністю.\n\nМи отримуємо наступні відносні похибки для різних розподілів та їх параметрів:\n- Гаусовий розподіл; відн. похиб. $\\approx 0.5\\%$\n- t-розподіл Стьюдента з $\\alpha=6.0$ ($\\nu=5.0$); відн. похиб. $\\approx 1.0\\%$\n- t-розподіл Стьюдента з $\\alpha=4.0$ ($\\nu=3.0$); відн. похиб. $\\approx 3.8\\%$\n- t-розподіл Стьюдента з $\\alpha=3.7$ ($\\nu=2.7$); відн. похиб. $\\approx 6.1\\%$\n\nПри степеневому показнику $\\alpha= 3.7$ (що відповідає $\\nu = 2.7$; як ми підрахували для S&P 500, щоб пояснити Чорний понеділок), щоденна прибутковість за 50 років все ще призводить до помилки оцінки волатильності більш ніж на $6%$! Зверніть увагу, що ця велика помилка оцінки зростатиме ще швидше, коли вона наближається до $\\alpha = 3.0$, оскільки дисперсія стає нескінченною для t-розподілу Стьюдента при $\\alpha = 3.0$ ($\\nu = 2.0$). Виходячи з t-розподілу прибутковостей S&P 500, похибка оцінки волатильності зросла в 12 разів (!) порівняно з тим, що ми очікували б, припускаючи, що прибутковості розподілені за Гаусом.\n\n::: {.callout-tip}\n## Примітка\n\nЧим важчі хвости розподілу прибутковостей, тим більше точок даних необхідно для досягнення необхідної достовірності оцінок певних параметрів. Пам'ятайте про це щоразу, коли ви намагаєтеся оцінити ризик інвестування у відносно новий фінансовий актив, який має дані лише за кілька років.\n:::\n\n### Наслідки для моделювання та прогнозування\n\nТой факт, що більш високі моменти розподілу прибутковості можуть бути нескінченними і що оцінка нижчих моментів, таких як дисперсія, дестабілізується за наявності \"товстих хвостів\", має суттєві наслідки для деяких найбільш використовуваних моделей у фінансах. Ми коротко розглянемо дві з них, щоб проілюструвати проблему.\n\n### Марковіц і стабільність волатильності\n\nУ 1954 році [Гаррі Марковіц](https://en.wikipedia.org/wiki/Harry_Markowitz) отримав ступінь доктора економічних наук за роботу з теорії фінансових портфелів. Його робота стала наріжним каменем [сучасної портфельної теорії](https://en.wikipedia.org/wiki/Modern_portfolio_theory) і тоді це було настільки новим, що під час захисту докторської дисертації Мілтон Фрідман стверджував, що ця робота насправді не стосується галузі економіки (як пояснив Марковіц у своїй [Нобелівській лекції](http://nobelprize.org/nobel_prizes/economics/laureates/1990/markowitz-lecture.html) у 1990 році). Марковіц стверджував, що при заданому рівні волатильності існує набір вагових коефіцієнтів розподілу активів у портфелі, які дають максимальну надлишкову прибутковість портфеля (порівняно з безризиковим активом). Якщо ви переглянете діапазон значень волатильності та обчислите максимальну віддачу портфеля, отримавши оптимальні ваги розподілу, Ви отримаєте набір *ефективних* портфелів, який також називають [межею ефективності](https://en.wikipedia.org/wiki/Efficient_frontier). Одна точка на цій межі в багатьох випадках представляє особливий інтерес, --- це точка максимуму [коефіцієнта Шарпа](https://en.wikipedia.org/wiki/Sharpe_ratio).\n\nКоефіцієнт Шарпа --- це часто критикуваний, але також часто використовуваний показник для оцінки ефективності портфеля або фінансових активів загалом, таких як гедж-фонди або ETF. Він визначається як:\n\n$$\nS = \\frac{\\mu - \\mu_{\\text{rf}}}{\\sigma}.\n$$\n\nТут $\\mu$ позначає річну прибутковість портфеля, $\\mu_{\\text{rf}}$ позначає річну безризикову прибутковість, а $\\sigma$ позначає річну волатильність портфеля. Припускаючи нульову безризикову ставку ($\\mu_{\\text{rf}} = 0$), коефіцієнт Шарпа можна інтерпретувати як [співвідношення сигнал/шум](https://en.wikipedia.org/wiki/Signal-to-noise_ratio), відомий у фізиці та інженерії: максимізуючи коефіцієнт Шарпа, ми знаходимо найкращий компромісне значення, що максимізує наші прибутковості (сигнал) та мінімізує волатильності (шум).\n\nЯкщо наш портфель складається з $n$ фінансових активів з очікуваною прибутковістю $\\vec{\\mu} = (\\mu_{1},...,\\mu_{n})$, з коваріаційною матрицею $\\Sigma$, яка містить інформацію про волатильність і кореляції між активами, і з вектором ваги розподілу $\\vec{w} = (w_1,...,w_n)$ (нормалізовано до одиниці: $\\sum_{i=1}^n w_i = 1$), тоді коефіцієнт Шарпа у контексті сучасної теорії портфеля можна обчислити наступним чином:\n\n$$\nS(\\vec{w}) = \\frac{\\vec{w}\\cdot\\vec{\\mu}}{\\sqrt{\\vec{w}\\Sigma\\vec{w}^T}}.\n$$\n\nЗверніть увагу, що з цього моменту ми завжди припускаємо, що $\\mu_{\\text{rf}} = 0$. \n\nЩоб максимізувати прибутковість відносно волатильності та отримати портфель з максимальним коефіцієнтом Шарпа, ми змінюємо ваги розподілу, поки не знайдемо набір ваг $\\vec{w}^*$ з максимальним коефіцієнтом Шарпа:\n\n$$\n\\vec{w}^* = \\text{argmax}_{\\vec{w}} ~ S(\\vec{w})\n$$\n\nОсновне припущення, що лежить в основі сучасної теорії портфеля, полягає в тому, що об'єднаний розподіл логарифмічних прибутковостей всіх активів у портфелі може бути повністю охарактеризований мультиваріативним розподілом Гауса. Після попередніх частин цієї лабораторної ми дуже добре розуміємо цю помилку, і сучасна теорія портфеля по праву зазнала жорсткої критики за відсутність врахування \"важких хвостів\", наприклад, з боку Нассіма Талеба:\n\n\n::: {.callout-tip}\n## Нассім Талеб у *Чорний лебідь: Про (не)ймовірне в реальному житті* (ст. 277)\n\nПісля краху фондового ринку (у 1987 році) вони нагородили двох теоретиків, Гаррі Марковіца та Вільяма Шарпа, які побудували прекрасні платонівські моделі на гаусовій основі, сприяючи тому, що називається сучасною теорією портфеля. Простіше кажучи, якщо ви видалите їх гаусові припущення і розглядаєте ціни як масштабо-інваріантні, у вас залишиться гаряче повітря. Нобелівський комітет міг би протестувати моделі Шарпа і Марковіца --- вони працюють як шарлатанські ліки, що продаються в Інтернеті, --- але ніхто в Стокгольмі, схоже, про це не подумав.\n:::\n\nТут ми просто хочемо проілюструвати наслідки припущення гаусовости, змоделювавши прибутковість двох гіпотетичних акцій і спробувавши знайти ваги розподілу по максимуму Шарпа. Як ми побачимо, великі хвости в модельованих розподілах прибутковостей вносять істотну невизначеність в розрахункові ваги розподілу --- прямий наслідок нестабільності дисперсії.\n\nСпочатку ми генеруємо випадкові числа з Гаусового розподілу, достатнього для моделювання щоденної прибутковості двох гіпотетичних акцій за 10 років. Ми присвоюємо їм різну позитивну очікувану прибутковість і волатильність. Для простоти ми припускаємо, що кореляція між двома активами є нульовою:\n\nЗвичайно, насправді ми не знаємо *справжньої* очікуваної прибутковості або значень волатильності кореляцій між активами. Таким чином, ми повинні оцінити очікувану прибутковість за середнім значенням вибірки та матрицю коваріації за матрицею коваріації вибірки. Зверніть увагу, що існують більш складні способи оцінки цих параметрів на основі історичних даних, таких як [оцінки усадки](http://www.ledoit.net/honey.pdf) для коваріаційної матриці або [моделі розподілу Блека-Літтермана](https://sci-hub.mksa.top/10.3905/jfi.1991.408013). Ці методи, безумовно, покращують вибіркові оцінки, але загальний недолік сучасної теорії портфеля через наявність \"важких хвостів\" залишається. Щоб вивчити та протестувати різні методи оптимізації портфеля, рекомендуємо розглянути бібліотеку [PyPortfolioOpt](https://pyportfolioopt.readthedocs.io/en/latest/index.html), що представляє собою добре задокументований пакет Python, який реалізує як основні, так і складні методи оптимізації портфеля та дозволяє легко тестувати ці методи на реальних даних. Поки ми дотримуємося вибіркових оцінок (і використовуємо коефіцієнт 252 --- середню кількість торгових днів на рік для отримання очікуваної прибутковості в річному обчисленні і коваріації за щоденними оцінками):\n\nДалі ми визначаємо функцію, яка приймає ваги розподілу кандидатів, розрахункову очікувану прибутковість і коваріаційну матрицю і виводить коефіцієнт Шарпа портфеля:\n\nЗамість того, щоб використовувати реальний оптимізатор для пошуку ваг розподілу, які максимізують коефіцієнт Шарпа, ми просто переглядаємо всі можливі комбінації ваг з інтервалом $1\\%$. Звичайно, це розумний підхід лише для двох активів, і він швидко стає нерозв'язним, використовуючи більше двох активів.\n\nТепер ми можемо перебрати всі наші ваги-кандидати, обчислити коефіцієнт Шарпа портфеля для всіх з них, а потім вибрати оптимальний набір ваг.\n\nЩоб отримати уявлення про те, наскільки точно ми можемо оцінити ваги розподілу на основі гіпотетичної щоденної прибутковості за 10 років, ми зараз повторюємо цей експеримент, повторно генеруємо нові випадкові прибутковості, повторно оцінюємо очікувані прибутковості та матрицю коваріації та знаходимо оптимальні ваги. Ми робимо це 10000 разів. Зверніть увагу, що ми реєструємо лише першу вагу розподілу $w_1$ для кожного запуску без втрати інформації, оскільки друга вага безпосередньо випливає з нормалізації $w_2 = 1 - w_1$.\n\nНарешті, ми можемо побудувати гістограму всіх 10000 значень, які ми отримуємо для $w_1$\n\nЯк ми бачимо, розподіл для першої акції коливається приблизно від $60%$ до $70%$ на основі історичних даних за 10 років. Ми можемо додатково оцінити це кількісно, обчисливши 5-й і 95-й процентилі всіх значень $w_1$. Таким чином, з упевненістю в $90%$ ми отримаємо розподіл між $61%$ і $72%$:\n\nТепер давайте повторимо цей експеримент, але цього разу ми замінимо розподіл Гауса на розподіл Стьюдента зі степеневим показником $\\alpha=3.7$ (що відповідає кількості ступенів свободи $\\nu=2.7$). Ми залишаємо очікувану прибутковість і волатильність (виміряні стандартним відхиленням розподілу) точно такими ж. Зверніть увагу, що стандартне відхилення стандартного t-розподілу визначається як $\\sqrt{\\frac{\\nu}{\\nu-2}}$ в нашому випадку, тому ми повинні внести поправку на цей коефіцієнт маштабування при вилученні випадкових значень зі стандартного t-розподілу. Нижче ви можете побачити пряме порівняння розподілів Гауса, використаних у наведеному вище моделюванні, та t-розподілів із відповідним середнім значенням та стандартним відхиленням.\n\nЯк ми можемо легко бачити, узгоджені t-розподіли Стьюдента насправді дають менші значення прибутковостей. Однак вони також дають набагато більш екстремальні значення, але ми не можемо легко побачити це, оскільки значення щільності ймовірності в хвостах дуже малі! Якщо ми перейдемо до логарифмічного масштабування вісі Oy, картина стане більш чіткою:\n\nТепер ми чітко бачимо, що, наприклад, ймовірність щоденних логарифмічних прибутковостей $-0.02$ для акції 1 в $10^{10}$ разів вища за умови t-розподілу порівняно з відповідним розподілом Гауса! Завжди дивіться на розподіли з логарифмічною шкалою щільності ймовірності, щоб отримати чітке уявлення про хвости. Використовуючи наші узгоджені t-розподіли, ми діємо, як і раніше, і моделюємо гіпотетичні 10-річні історичні показники для наших двох некорельованих акцій. Нижче ви можете побачити приклад. Тільки при уважному розгляді ви можете помітити, що ці криві сукупної прибутковості насправді трохи більш нерівні в порівнянні з тими, які були побудовані вище з гаусовими прибутковостями. Але різниця невловима, якщо дивитися на таку \"наближену\" діаграму десятирічного періоду:\n\nНарешті, щоб візуалізувати вплив t-розподілу на оцінку ваги розподілу, ми повторюємо наш експеримент Монте-Карло з моделювання 10000 різних 10-річних історичних значень та оцінюємо ваги розподілу в кожному з цих 10000 випадків. Потім ми будуємо графік розподілу $w_1$ і порівнюємо цей розподіл з розподілом, отриманим в результаті моделювання на основі Гауса.\n\nЯк ми можемо бачити, оптимальна вага розподілу $w_1$ тепер коливається між $54\\%$ і $77\\%$, що приблизно в 2 рази перевищує ширину надійного інтервалу для оптимізації портфеля, яка дотримувалася припущення про гаусовість! Навіть при узгодженому стандартному відхиленні гаусового і t-розподілу, нескінченний ексцес t-розподілу дестабілізує вибіркову дисперсію наших змодельованих прибутковостей і, таким чином, знижує точність наших оціночних ваг розподілу. Хоча цей приклад, безумовно, не розкриває всіх слабкостей сучасної теорії портфеля, він допомагає нам побачити, як досить абстрактні ефекти, такі як нестабільність дисперсії через надмірний ексцес, в кінцевому результаті псують широко використовувані фінансові моделі. Використання модельованої прибутковості, заснованої на гаусовому розподілі порівняно з розподілом з великим хвостом, може допомогти виявити обмеження фінансових моделей або знайти мінімальний обсяг даних, необхідний для досягнення певної достовірності, перш ніж нова модель буде фактично запущена у виробництво!\n\n::: {.callout-tip}\n## Примітка\n\nВажкі хвости розподілу прибутковостей можуть сильно вплинути на результати усталених математичних моделей у фінансах, або збільшуючи невизначеність параметрів (як у сучасній теорії портфеля), або приводячи до збоїв моделей поза вибірки через нескінченно великі моменти. У фінансах краще екстраполювати частоту екстремальних подій і готуватися до них за допомогою конкретних інструментів геджування, ніж намагатися передбачити майбутню прибутковість за допомогою моделей часових рядів!\n:::\n\n### Розподіл Леві\n\nАльфа-стабільний розподіл є узагальненням розподілу Гауса, яке цінується за те, що воно тягне за собою жирні хвости. З цієї причини він широко використовується при обробці сигналів, наприклад, у медицині чи фінансах.\n\nЗагальний клас стабільних розподілів був введений і отримав цю назву французьким математиком Полем Леві на початку 1920-х років.\n\nРаніше ця тема привертала лише помірну увагу провідних експертів, хоча були і ентузіасти, з яких можна згадати російського математика Олександра Яковича Хінчіна. Натхненням для Леві стало бажання узагальнити відому центральну граничну теорему, згідно з якою будь-який розподіл ймовірностей з кінцевою дисперсією збігається до гауссового розподілу.\n\nСтабільні розподіли мають три виняткові властивості, які можна коротко підсумувати, заявляючи, що вони:\n\n- інваріантні при додаванні;\n- мають власну область збіжності;\n- дозволяють канонічну форму характеристичної функції.\n\n#### Інваріантність при додавані\n\n*Випадкова величина $X$ підпорядковується стабільному розподілу $P(x) = \\text{Prob}\\{X \\leq x\\}$ якщо для будь-якого $n \\geq 2$ існують додатнє значення $c_{n}$ та дійсне значення $d_{n}$ такі, що*\n\n$$ \nX_1 + X_2 + ... + X_n \\stackrel{d}{=} c_{n}X + d_{n}, \n$$\n\n*де $X_1, X_2, ..., X_n$ характеризуються як незалежні, ідентично розподілені випадкові величини.* Також $\\stackrel{d}{=}$ позначає *рівність розподілів*, тобто, випадкові величини з обох сторін мають однаковий розподіл ймовірностей.\n\nЗагалом, сума незалежних, ідентично розподілених випадкових величин результує у випадкову величину з іншим розподілом. Однак, для випадкових величин, що характеризуються *стабільним* розподілом, сума ідентично розподілених випадкових величин до величини такого самого розподілу. У цьому випадку результуюча випадкова величина (розподіл) може відрізнятися від попередніх величин характерним масштабом ($c_{n}$) та зміщенням ($d_{n}$). Якщо $d_{n} = 0$, розподіл називається *строго стабільним*.\n\nВідомо, що нормована константа $c_{n}$ має вид \n\n$$\nc_{n} = n^{1/\\alpha} \\, \\text{with} \\, 0 < \\alpha \\leq 2. \n$$\n\nПараметр $\\alpha$ має назву *характеристична експонента* або *індекс стабільності* стабільного розподілу.\n\nПопередня теорема має альтернативну версію, що включає в суму лише дві випадкові величини. *Випадкова величина $X$ підпорядковується стабільному розподілу, якщо для будь-яких позитивних значень $A$ та $B$ існує позитивне число $C$ та дійсне число $D$ такі, що*\n\n$$ \nA X_1 + B X_2 \\stackrel{d}{=} C X + D, \n$$\n\n*де $X_1$ та $X_2$ незалежні копії $X$*. Тоді існує значення $\\alpha \\in (0, 2]$ при яких значення $C$ задовільняє рівність $C^{\\alpha} = A^{\\alpha} + B^{\\alpha}$.\n\nДля строго стабільних розподілів $D = 0$. Це означає, що всі лінійні комбінації випадкових незалежних, ідентично розподілених випадкових величин, що підкоряються строго стабільному розподілу, результують у випадкову величину з одним і тим же типом розподілу. \n\nСтабільний розподіл вважається *симетричним*, якщо випадкова величина $-X$ має такий самий тип розподілу. *Симетричний* стабільний розподіл обов'язково *строго стабільний*. \n\nОскільки аналітичний вираз функції щільності ймовірностей для стабільного розподілу невідома, за винятком кількох членів стабільного сімейства, більшість традиційних методів математичної статистики не можуть бути використані. Відбовідними вийнятками є\n\n- **Гаусовий розподіл** $S_2(0,\\mu, \\sigma) = \\mathcal{N}(\\mu, 2\\sigma^2)$. Гаусовий розподіл є спеціальним випадком стабільного розподілу при $\\alpha = 2$ так що $\\mathcal{N}(\\mu, \\sigma) = S(2,0,\\mu, \\frac{\\sigma}{\\sqrt{2}})$, де $\\mu$ позначає середнє значення нормального розподілу, а $\\sigma$ --- це стандартне відхилення. Функція щільності ймовірностей має вид \n\n$$ \n\\frac{1}{\\sigma\\sqrt{2\\pi}}\\text{exp}^{-(x-\\mu)^{2}/2\\sigma^{2}}. \n$$\n\n- **Розподіл Коші**. Розподіл Коші --- це ще одне представлення стабільного розподілу при $\\alpha = 1$ та $\\beta = 0$ такими, що $Cauchy(\\delta, \\gamma) = S_1(1,0,\\gamma,\\delta)$, де $\\gamma$ --- це параметр масштабування, а $\\delta$ --- це параметр зсуву розподілу Коші. Функція щільності ймовірностей представлена як: \n\n$$ \n\\frac{\\gamma}{\\pi((x-\\delta)^2 + \\gamma^2)}, \\, -\\infty < x < \\infty. \n$$\n\n- **Розподіл Леві** також є вийнятком із класу стабільних розподілів, де $\\alpha = 0.5$ і $\\beta = 1$. Іншими словами, $Levy(\\delta, \\gamma) = S_{1/2}(0.5, 1, \\gamma, \\delta)$. Функція щільності ймовірностей має вид \n\n$$ \n\\sqrt{\\frac{\\gamma}{2\\pi}}\\frac{1}{(x-\\delta)^{3/2}}\\exp{\\left[ \\frac{-\\gamma}{2(x-\\delta)} \\right]}, \\, \\delta < x < \\infty. \n$$\n\nЯкщо $X \\sim S_{1/2}(0.5, 1, \\gamma, \\delta)$, тоді для $x > 0$\n\n$$ \nP(X \\leq x) = 2 \\left( 1 - \\phi \\left( \\sqrt{\\frac{\\gamma}{x}} \\right) \\right), \n$$\n\nде $\\phi$ позначає кумулятивну функцію нормального розподілу.\n\n#### Область збіжності\n\nІнше (еквівалентне) визначення стверджує, що стабільні розподіли --- це єдині розподіли, які можна отримати при границі нормалізованих сум незалежних, ідентично розподілених випадкових величин. Кажуть, що випадкова величина $X$ має область збіжності, тобто якщо існує послідовність незалежних, ідентично розподілених випадкових величин $Y_1, Y_2, ...$ і послідовності позитивних чисел ${\\gamma_n}$ і дійсних чисел ${\\delta_n}$ таких, що\n\n$$  \n\\frac{Y_1 + Y_2 + ... + Y_n}{\\gamma_n} + \\delta_n \\stackrel{d}{\\Rightarrow} X.  \n$$\n\nКоли $X$ це гаусова випадкова величина, а $Y_i's$ є незалежними, ідентично розподіленими випадковими величинами з визначенною дисперсією, тоді рівняння вище є твердженням звичайної *центральної граничної теореми*. Область збіжності $X$ вважається *нормальною* коли $\\gamma_n = n^{1/\\alpha}$. \n\n#### Канонічні представлення характеристичної функції\n\nЧотири параметри використовуються для опису випадкової величини, що слідує за стабільним розподілом: $X \\sim S(\\alpha, \\beta, \\mu, \\gamma)$. Параметр $\\alpha \\in (0, 2]$ --- це той, який нас найбільше зацікавить. Цей параметр визначає товщину хвостів. Параметр $\\beta \\in [-1, 1]$ є параметром асиметрії. Останні два параметри позначають розташування $(\\mu \\in \\Re)$ і масштаб $(\\gamma > 0)$ розподілу. Альфа-стабільний розподіл немає жодного аналітичного виразу для щільності ймовірності $X$, але ми можемо охарактеризувати його характеристичною функцією:\n\n$$\n    \\begin{split}\n    \\phi(t) &= E\\left[\\exp(itX)\\right] \\\\\n            &= \n        \\begin{cases} \n            \\exp\\left(i \\mu t - \\gamma^{\\alpha}|t|^{\\alpha} \\left[1-i\\beta\\text{sign}(t)\\tan{\\frac{\\pi\\alpha}{2}}\\right]\\right) & \\text{if} \\, \\alpha \\neq 1 \\\\ \\exp\\left(i \\mu t - \\gamma|t| \\left[1+i\\beta\\text{sign}(t)\\frac{2}{\\pi}\\log{|t|}\\right]\\right) & \\text{if} \\, \\alpha = 1. \n        \\end{cases} \n    \\end{split}\n$$\n\nМи могли б використовувати перетворення Фур'є, щоб отримати функцію щільності розподілу ймовірностей з характеристичної функції: \n\n$$ \nf(x) = \\frac{1}{2\\pi}\\int_{-\\infty}^{+\\infty} \\phi(t) \\cdot \\exp(-itX) dt. \n$$\n\nАле наведена вище параметризація не є повністю задовільною, оскільки функція щільності розподілу ймовірностей не є безперервною, зокрема, при $\\alpha = 1$. Дійсно, коли $\\beta > 0$, щільність розподілу зміщується вправо, коли\n$\\alpha < 1$ і вліво, коли $\\alpha > 1$, зі зсувом в сторону $+\\infty$ (відповідно $-\\infty$), коли $\\alpha$ прагне до 1. Таким чином, для прикладного аналізу даних та інтерпретації коефіцієнтів слід уникати такої параметризації. \n\nІснує багато параметризацій для стабільних законів, і ці різні параметризації викликали велику плутанину. Різноманітність параметризацій обумовлена поєднанням історичної еволюції плюс численними проблемами, які були проаналізовані за допомогою спеціалізованих форм стабільного розподілу. Є вагомі причини використовувати різні параметризації в різних ситуаціях. Якщо в пріорітеті чисельні розрахунки, робота із даними, то краще використовувати одну параметризацію. Якщо бажані прості алгебраїчні властивості розподілу або аналітичні властивості строго стійких законів, то краще розглянути декілька параметризацій. Нолан запропонував використовувати параметризацію Золотарьова (M), яку також часто позначають як $S^{0}$. Характеристична функція, що відповідає $X \\sim S^{0}(\\alpha, \\beta, \\mu_{0}, \\gamma)$, дорівнює:\n\n$$\n    \\begin{split}\n    \\phi(t) &= E\\left[\\exp(itX)\\right] \\\\\n            &= \n        \\begin{cases} \n            \\exp\\left(i \\mu_{0} t - \\gamma^{\\alpha}|t|^{\\alpha} \\left[1+i\\beta\\text{sign}(t)\\tan{\\frac{\\pi\\alpha}{2}}\\left( \\gamma^{1-\\alpha}|t|^{1-\\alpha}-1 \\right)\\right]\\right) & \\text{if} \\, \\alpha \\neq 1 \\\\ \\exp\\left(i \\mu_{0} t - \\gamma|t| \\left[1+i\\beta\\text{sign}(t)\\frac{2}{\\pi}\\left(\\log{|t|} + \\log{\\gamma}\\right) \\right]\\right) & \\text{if} \\, \\alpha = 1. \n        \\end{cases}\n    \\end{split} \n$$\n\nЦя альтернативна параметризація недалека від зазначеної напочатку. Єдина відмінність стосується параметра $\\mu$, який у даній параметризації коригує зсув для значень $\\alpha$ близьких до 1:\n\n$$ \n\\mu_{0} = \\begin{cases} \\mu + \\beta\\gamma\\tan{\\frac{\\pi\\alpha}{2}} & \\text{if} \\, \\alpha \\neq 1 \\\\ \\mu + \\beta\\frac{2}{\\pi}\\gamma\\log{\\gamma} & \\text{if} \\, \\alpha = 1. \\end{cases} \n$$\n\n#### Метод розрахунку параметрів $\\alpha$-стабільного розподілу\n\nЧислені методи, такі як метод Маккаллоха, заснований на квантилях, і метод оцінки максимальної правдоподібності були розроблені в результаті відсутності аналітичних рішень. Припустимо, що $\\text{X} = (X_1, ... , X_T)$ вектор, що складається з $T$ незалежних ідентично розподілених випадкових величин із розподілу Парето, і також $x \\sim S_{\\alpha}(\\alpha, \\beta, \\delta, \\gamma)$. Визначивши $\\theta = (\\alpha, \\beta, \\delta, \\gamma)$, Митник, Доганоглу та Ченайо розробили алогритм максимальної правдоподібності і показали, що $\\theta$ можна розрахувати, максимізуючи функцію логарифмічної правдоподібності\n\n$$ \nl(\\theta, x) = \\sum_{i=1}^{T}\\log{f(x_{i}, \\theta)}.\n$$\n\nДюмушель застосував метод максимальної правдоподібності до стабільного розподілу і визначив функцію правдоподібності наступним чином: \n\n$$ \nL(\\theta) = \\prod_{k=1}^{n}S_{\\alpha,\\beta} \\left( \\frac{X_{k} - \\delta}{\\gamma} \\right) \\Big/ \\gamma, \n$$ \n\nде $\\theta = (\\alpha, \\beta, \\delta, \\gamma)$ опираючись на $x = (x_1, ... , x_n)$ для розміру вибірки $n$. \n\n## Хід роботи\n\nЗчитуємо дані з Yahoo Finance:\n\n::: {.callout-warning}\n## Увага\n\nВиконайте цей блок, якщо хочете зчитати дані не з Yahoo! Finance, а із власного файлу. Зрозуміло, що й аналіз результатів, і висновки залежать від того з яким рядом ми працюємо. \n\n:::\n\n---\n\n---\n\nВиводимо графік досліджуваного ряду\n\n### Побудова розподілу Леві та розрахунок параметрів для всього ряду\n\nДля приведення ряду до стандартизованого вигляду або прибутковостей визначимо функцію `transformations()`:\n\nДля побудови в парі певного індикатора та досліджуваного ряду визначимо функцію `plot_pair`:\n\nДалі виконаємо приведення ряду до прибутковостей:\n\nПідганяємо розподіл Леві та Гауса для порівняння:\n\nОтримуємо параметри розподілу Леві у відповідності до однієї із параметризацій, що пропонує пакет `levy`:\n\nБудуємо теоретичні та емпіричні розподіли:\n\nВиводимо параметри розподілу Леві для заданого індексу\n\nДля досліджуваного індексу бачимо, що параметр $\\alpha < 2.0$ та $\\beta < 0$, що вказує на відхилення розподілу даного індексу від нормального. Тобто, для даного ряду переважаючими є кризові явища, на що вказують важкі хвости розподілу. Із порівняльного аналізу Гауссового та Леві розподілів бачимо, що хвости нормального розподілу значно недооцінюють ймовірність появи кризових явищ чого, наприклад, не скажешь про альфа-стабільний розподіл. Взявши логарифм значень ймовірності по осі $Oy$ ми можемо спостерігати, що, наприклад, недооцінка негативних прибутковостей Гаусовим розподілом, у порівнянні з альфа-стабільним, складає $\\approx 10^{15}$ порядків. Для позитивних прибутковостей, що перевищують значення $+10\\sigma$ недооцінка Гауссовим розподілом складає $\\approx 10^{27}$ порядків. Теоретичне значення альфа-стабільного розподілу достатньо точно враховує важкі хвости емпіричного розподілу, що також виражається високим ексцесом розподілу. Також варто зазначити, що коефіцієнт асиметрії $\\beta$ вказує на невеличке зміщення розподілу в ліву сторону, що також демонструє переважання кризових явищ. \n\n### Дослідження поведінки альфа-стабільного розподілу Леві\n\n### Віконна процедура\n\nУ даному блоці оберемо тип ряду для якого і виконуватимуться розрахунки. Перед нами представлено 6 варіантів представлення часового ряду. Виконуватимемо подальші обчислення для стандартизованих прибутковостей, оскільки згідно багатьом роботам було показано, що розподіл прибутковостей тих же самих фінансових активів (фондових індексів, валютних, криптовалют, тощо) виходить за межі нормального Гауссового розподілу. Покажемо це у даному ноутбуці та застосуємо альфа-стабільний розподіл Леві для кращого моделювання складних систем та передчасної ідентифікації кризових явищ. \n\nЗберігаємо абсолютні значення у текстовому документі:\n\n### Динаміка показника стабільності $\\alpha$\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nПараметр $\\alpha$ (індекс стабільності хвостів розподілу) починає спадати у (перед)кризовий період, що робить його індикатором(-передвісником) кризових явищ. Під час криз у розподілі прибутковостей зростає ексцес, а самі хвости стають важчими, на що даний показник реагує передчасно.\n\n### Динаміка показника асиметрії $\\beta$\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nДинаміка даної міри виглядає набагато хаотичніше у порівнянні з індексом стабільності. Для представлених результатів можна зробити наступний висновок: у передкризовий період даний показник має зростати, вказуючи на значну правосторонню асиметрію розподілу прибутковостей (переважання позитивних прибутковостей). Для кризового періоду цей показник має спадати, вказуючи на домінацію негативних прибутковостей (лівостороння асиметрія розподілу). Даний показник важко розглядати у якості надійного індикатора, оскільки його коливання представляються значними навіть при незначних падіннях представленого фондового індексу. \n\n### Динаміка параметра зміщення $\\mu$\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nПоказник розташування $\\mu$ потроху спадає у кризовий період, демонструючи зміщення розподілу в сторону негативних прибутковостей. Тим не менш, цей розподіл представляєть настільки ж хаотичним як і показник асиметрії $\\beta$. \n\n### Динаміка параметра масштабу $\\sigma$\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nІз представлених результатів видно, що даний показник спадає у (перед)кризовий період, вказуючи на зменшення масштабу (форми) альфа-стабільного розподілу Леві.\n\nОтже, з усіх 4-ох показників, показник стабільності $\\alpha$ є найкращим для ідентифікації кризових явищ та побудови надійних стратегій ризик-менеджменту. \n\n## Висновок\n\nСтабільні розподіли --- захоплюючий і плідний об'єкт досліджень в теорії ймовірностей; більше того, в даний час вони мають велику цінність при моделюванні складних процесів у фізиці, астрономії, економіці, теорії комунікацій, тощо. \n\nУ даній роботі було представлено теоретичні та чисельні обгрунтування в сторону альфа-стабільного розподілу Леві в якості практичної моделі для кращого розуміння та передбачення кризових явищ у складних системах.  \n\nТут ми представили розрахунки як для усього ряду, так і для його підфрагментів, використовуючи алгоритм ковзного вікна. Виходячи з усього ряду прибутковостей, видно, що хвости їх розподілу далеко виходять за межі Гаусового. Найкраще емпіричний розподіл прибутковостей збігається саме з теоретичним альфа-стабільним розподілом Леві. \n\nВикористовуючи алгоритм сковзного вікна, ми побачили, що параметри альфа-стабільного розподілу змінюються з часом.\n\n::: {.callout-tip}\n## Література для подальшого вивчення степеневих розподілів та важких хвостів \n\nNassim Taleb's [*Statistical Consequences of Fat Tails: Real World Preasymptotics, Epistemology, and Applications*](https://arxiv.org/ftp/arxiv/papers/2001/2001.10488.pdf) (вільно доступна за посиланням).\n:::\n","srcMarkdownNoYaml":"\n\n\n\n\n**Тема.** Важкі хвости: вплив одиничних катастрофічних подій. Аналіз кризових подій із використанням Леві альфа-стабільного розподілу.\n\n**Мета.** Навчитися використовувати розподіл Леві для диференціації флуктуацій, що виходять за межі нормального розподілу.\n\n\n\n::: {.callout-note}\n## Анотація\n\nУ цій лабораторній ми досліджуємо розподіл прибутковості фінансових активів і стабільність певних показників, які ми розраховуємо, опираючись на ці активи. Зокрема, ми побачимо, що більш високі моменти розподілу прибутковостей з важкими хвостами насправді дуже нестабільні, нескінченні або взагалі не визначені, і що, наприклад, одна єдина точка даних визначає більшу частину надлишкового ексцесу. Цей факт має досить драматичні наслідки, оскільки популярні моделі, такі як GARCH, базуються на можливості оцінки кінцевого значення ексцесу. Суть, яку ми хочемо донести, полягає в тому, що, не приділяючи особливої уваги повноті фінансових розподілів, не можна очікувати, що моделі будуть працювати за межами навчальної та тестувальної вибірки. Аналітики та трейдери завжди будуть дивуватись новим екстремальним подіям, що, як правило, рідко бувають позитивними.\n:::\n\n## Теоретичні відомості\n\n### Імпортуємо необхідні бібліотеки\n\n::: {.callout-important}\n## Увага \n\nПерш за все, для подальшої роботи, нам необхідно буде встановити бібліотеку `pylevy`. Встановити її можна з відповідного [GitHub репозиторію](https://github.com/josemiotto/pylevy/tree/master). Ми у свою чергу завантажимо її напряму через команду `pip install` слідуючим чином:\n \n:::\n\nПісля встановлення необхідного модулю можна приступати до подальшої роботи. \n\n### Виконуємо налаштування рисунків\n\n### Зчитування даних \n\n### Важкі хвости та Чорні понеділки\n\nСпочатку ми розглянемо розподіл щоденних прибутковостей індексу S&P 500, починаючи з 1950 року. У клітинці нижче буде показано [Pandas dataframe](https://pandas.pydata.org/docs/user_guide/10min.html) `df`, що містить дані OHLC з файлу (ці дані були попередньо завантажені в клітинці вище).\n\nЦей історичний ряд щоденних цін містить \\~ 18527 торгових днів. Замість того, щоб дивитися безпосередньо на ціни, ми розглянемо щоденні [*log*-прибутковості](https://lucaslouca.com/Why-Use-Logarithmic-Returns-In-Time-Series-Modelling/) індексу S&P 500. Пам'ятайте, що логарифмічна прибутковість $r_t$ визначається як логарифм відношення між цінами закриття $p_t$ у теперішній момент часу та попередній, $p_{t-1}$:\n\n$$\nr_t = \\log(\\frac{p_t}{p_{t-1}})\n$$\n\nЛогарифмічні прибутковості характеризуються симетрією, тобто якщо в один день індекс втрачає $r_t = -0.1$, а на наступний день індекс набирає $r_{t+1} = +0.1$, індекс знову досягає початкової ціни. Зі звичайними прибутковостями, спочатку втративши $10\\%$, а потім знову набравши $10\\%$, ви не повернетесь до початкової ціни. Ми зберігаємо прибутковості в новому фреймі даних `lr`:\n\nВикористовуючи вбудовані функції Pandas та Numpy, тепер ми можемо подивитись на найгірше щоденнє значення прибутковостей. Ми виявляємо, що найгірше значення становило $-0.229$, що відповідає $-22.9\\%$, і що це сталося в понеділок, 19 жовтня 1987 року --- так званий [*Чорний понеділок*](https://en.wikipedia.org/wiki/Black_Monday_(1987)).\n\nДалі ми будуємо графік вибіркового розподілу щоденних логарифмічних прибутковостей, що демонструє нам, як часто ми спостерігаємо щоденні прибутковості певного знака та величини. Зверніть увагу, що ми встановили логарифмічне масштабування для вісі Оy, щоб мати краще представлення про хвости розподілу, тобто дуже великі, але рідкісні негативні та позитивні прибутковості --- крахи та підйоми:\n\nЯк ми можемо описати погіршення розподілу прибутковості? За допомогою [логарифмічного масштабування](https://en.wikipedia.org/wiki/Logarithmic_scale) осі Oy, щоб експоненціальний спад виглядав лінійно, тому ми могли би запідозрити, що при малих абсолютних значеннях прибутковості розподіл зменшується експоненціально, але в міру збільшення абсолютних значень прибутковостей ми все більше і більше відхиляємося від початкового нахилу. Насправді, ми можемо показати, що ні розповсюдженний [розподіл Гауса](https://en.wikipedia.org/wiki/Normal_distribution) (також званий *нормальним* розподілом), ні [розподіл Лапласа](https://en.wikipedia.org/wiki/Laplace_distribution) з його експоненціальним спадом з обох сторін точно не можуть змоделювати розподіл прибутковостей S&P 500. Як розподіл Гауса, так і розподіл Лапласа недооцінюють ймовірність екстремальних подій --- підйомів та крахів:\n\n### Відхилення в 23 сигма\n\nЯк ми можемо бачити вище, як розподіл Гауса, так і розподіл Лапласа різко недооцінюють ймовірність дуже волатильної динаміки! Часто зазначають, що трапилась \"[3-сигма](https://en.wikipedia.org/wiki/68%E2%80%9395%E2%80%9399.7_rule) подія на ринку\" або щось подібне, тому що багатьом людям подобається оцінювати індивідуальні прибутковості по [стандартному відхиленню](https://en.wikipedia.org/wiki/Standard_deviation) (зване \"сигмою\") підібраного гаусового розподілу. Однак, якщо Розподіл Гауса взагалі не відповідає розподілу вибірки, як у нашому випадку, оцінка краху в одиницях \"сигма\" може ввести в оману! Щоб показати це, ми спочатку перевіримо, на скільки сигм ринок змістився в Чорний понеділок 1987 року:\n\nВиходячи з розподілу по Гауса, Чорний понеділок був би подією з \"23 сигмами\"! Тепер Розподіл Гауса чітко говорить нам, як часто X-сигма подія має відбуватися:\n\n- 1-сигма: прибл. 1 з 3 днів\n- 2-сигма: прибл. 1 з 22 днів\n- 3-сигма: прибл. 1 з 370 днів\n\n...\n\nМи можемо розширити цю таблицю, попрацювавши з [функцією кумулятивного розподілу](https://en.wikipedia.org/wiki/Cumulative_distribution_function), тісно пов'язана з [функцією виживання](https://en.wikipedia.org/wiki/Survival_function), і перемістивши обчислення в логарифмічний простір для чисельної стабільності, як демонструють наступні комірки коду:\n\nЩоб отримати додаткову інформацію про частоту екстремальних прибутковостей, ми можемо навіть створити невеликий [інтерактивний віджет](https://ipywidgets.readthedocs.io/en/latest/examples/Widget%20Basics.html) за допомогою повзунка, який вказує кількість \"сигм\", а текст поруч із ним показує середню кількість днів між двома такими екстремальними подіями:\n\nВи бачите, що при переміщенні повзунка вправо кількість днів або років між двома наступними \"X-сигма\" подіями швидко наростає. Наша таблиця тепер виглядає наступним чином:\n\n- 1-сигма: прибл. 1 з 3 днів\n- 2-сигма: прибл. 1 з 22 днів\n- 3-сигма: прибл. 1 з 370 днів\n\n...   \n\n- 23-сигма: приблизно 1 з $10^{116}$ днів (!!!)\n\nВнесемо ясність: виходячи з розподілу Гауса, щоденні втрати Чорної п'ятниці 1987 року повинні бути подією, яку ми очікуємо раз на $10^{116}$ днів. Це число в значній мірі незбагненно велике. Якби S&P 500 почав торгуватися відразу після [народження Всесвіту](https://en.wikipedia.org/wiki/Age_of_the_universe), це становило б лише $10^{13}$ торгових днів. Через $10^{116}$ днів усі зірки у Всесвіті давно згорять, навіть усі [чорні діри випаруються](https://en.wikipedia.org/wiki/Future_of_an_expanding_universe#Dark_Era_and_Photon_Age) і Всесвіт стане темним і порожнім місцем. Тож або ми повинні бути дуже щасливі, що єдина очікувана Чорна п'ятниця в історії та майбутньому Всесвіту позаду, або ви дійсно ніколи не повинні використовувати Розподіл Гауса для моделювання прибутковості акцій! Незалежно від ринку та деталей, якщо хтось говорить про події з 10 сигмами або 23 сигмами, він, безумовно, використовує неправильну модель, оскільки шанс спостерігати таку подію в нашому житті незначний.\n\nОтже, виникає питання: Як ми справляємось із такими екстремальними значеннями? Чи слід позначати їх як [викиди](https://en.wikipedia.org/wiki/Outlier) або артефакти, щоб наші фінансові моделі краще описували більшість значень? Звичайно, ні, оскільки результат наших інвестицій може критично залежати не від більшості менших прибутковостей, а саме від таких екстремальних подій! Далі ми познайомимося з підходом, який може пояснити та екстраполювати за межі екстремальних подій, таких як Чорний понеділок. Але ми також побачимо, що не всі способи врахування важких хвостів розподілів працюють добре, оскільки деякі моделі, такі як [GARCH](https://en.wikipedia.org/wiki/Autoregressive_conditional_heteroskedasticity) може заколисати нас помилковим почуттям безпеки, коли ми завжди беремо до уваги минулі екстремальні події, але завжди дивуємося новим.\n\n### Статистика степеневого розподілу\n\nТепер, коли ми знаємо, що розподіл Гауса не є хорошим вибором, який тип розподілу насправді може описати частоту екстремальних подій, які струшують S&P 500? Частота екстремально позитивні та негативні прибутковості асиметричні для більшості фінансових активів, оскільки крахи, як правило, більш сильні, ніж підйоми. Ось чому нижче ми зосередимося на лівому (негативному) хвості розподілу прибутковостей.\n\nОскільки нас цікавлять лише екстремальні події, ми розглянемо лише ті прибутковості, які менше $-0.03$ (приблизно три стандартних відхилення від середнього значення). Нижче ми візуалізуємо ці екстремально негативні показники прибутковостей в [логарифмічному масштабі](https://en.wikipedia.org/wiki/Log%E2%80%93log_plot) (тут ми використовуємо абсолютні значення негативних прибутковостей). Як вісь Oy (яка показує частоту логарифмічних прибутковостей), так і вісь Ox (яка показує величину логарифмічних прибутковостей) масштабуються логарифмічно:\n\nЯк ми бачимо, ця гістограма екстремальних абсолютних прибутків зменшується приблизно лінійно при логарифмічному масштабуванні. Щоразу, коли ви виявляєте пряму лінію на логарифмічному графіку, це вказує на так званий [степеневий розподіл](https://en.wikipedia.org/wiki/Power_law). Степеневе співвідношення ймовірності спостереження великих абсолютних логарифмічних прибутковостей задається у вигляді:\n\n$$\np(|r_t|) = c \\cdot |r_t|^{-\\alpha}\n$$\n\nКонстанта $c$ на даний момент нас не надто турбує, вона просто гарантує, що ліва частина рівняння належним чином нормалізована, але показник $\\alpha$ представляє для найбільший інтерес, оскільки він говорить нам, як працює степеневий закон. Якщо ви знаєте частоту даних абсолютних логарифмічних прибутковостей, то степеневий закон підкаже вам, у скільки разів менш імовірними були б логарифмічні прибутковості подвоєного розміру:\n\n$$\np(2 \\cdot |r_t|) = c \\cdot (2 \\cdot |r_t|)^{-\\alpha} = 2^{-\\alpha} \\cdot c \\cdot |r_t|^{-\\alpha} = 2^{-\\alpha} \\cdot p(|r_t|)\n$$\n\nабо простіше:\n\n$$\n\\frac{p(2 \\cdot |r_t|)}{p(|r_t|)} = \\frac{1}{2^{\\alpha}}\n$$\n\nДля $\\alpha = 0$ всі прибутковості однаково ймовірні, для $\\alpha = 2$ подвоєння прибутковостей робить їх у 4 рази менш імовірними. Оскільки це правило подвоєння вгору або вниз не залежить від значення самого $\\left| r_t \\right|$, але працює для всіх значень $\\left| r_t \\right|$. Степеневе співвідношення також називаються \"безмасштабним\" або [масштабо-інваріантним](https://en.wikipedia.org/wiki/Scale_invariance).\n\nЯк щодо показника $\\alpha$ для наших надзвичайно негативних логарифмічних прибутковостей S&P 500? Ми можемо легко оцінити його за даними, але є деякі тонкощі у правильному розбитті вищезазначеної гістограми, які можуть вплинути на нашу оцінку (див., наприклад, [White et al. (2008)](https://esajournals.onlinelibrary.wiley.com/doi/10.1890/07-1288.1)). Щоб обійти ці проблеми з розбиттям, ми можемо замість цього оцінити степенний показник [кумулятивної гістограми](https://en.wikipedia.org/wiki/Histogram#Cumulative_histogram) логарифмічних прибутковостей, а потім відняти одиницю від отриманого нахилу:\n\nВиходячи з цієї оцінки, ми отримуємо степеневої показник, рівний $\\alpha \\approx 3.7$. Якщо ми побудуємо гістограму наших надзвичайно негативних логарифмічних прибутковостей, то побачимо, що вона добре відображає зниження ймовірності, оскільки масштаб збоїв збільшується. Однак цей степеневий показник все ще недооцінює ймовірність настання чергового \"Чорного понеділка\", оскільки лінія відповідності не ідеально підходить до цієї крайньої точки. Якби ми захотіли створити ще більш консервативну модель екстремальних подій, нам потрібно було б вручну ще більше зменшити значення $\\alpha$, щоб врахувати більшу ймовірність настання чорних понеділків за рахунок втрати точності підгонки для менших збоїв. Це перший раз, коли ми можемо побачити, як одна точка даних впливає на наші рішення щодо моделювання. На даний момент ми будемо довіряти оцінці параметра і погодимося з оцінкою $\\alpha=3.7$.\n\nМи можемо використовувати цей степеневий закон, щоб екстраполювати, як часто ми очікуємо настання чорного понеділка (або \"події з 23 сигмами\") у довгостроковій перспективі. Виходячи з наявних у нас даних, ми можемо оцінити, що ймовірність спостереження зниження на $-0.03$ або гірше становить близько $1.6\\%$. Слідуючи нашій степеневій кривій, зниження чорного понеділка на $-0.229$, таким чином, відбувалося б із частотою $\\left(\\frac{0.229}{0.03}\\right)^{-3.7} \\approx \\frac{1}{1845}$. Так само часто, як зниження на $-0.03$, яке ми спостерігаємо приблизно раз на три місяці. Це означає, що, виходячи з нашої степеневої кривої, очікується, що чорні понеділки, подібні до 1987 року, траплятимуться приблизно раз на 450 років (див. код нижче).\n\nЯкби ми включили більше даних, що містять інші приклади екстремальних подій, наприклад, з [Великої депресії](https://en.wikipedia.org/wiki/Great_Depression), ця оцінка може стати ще меншою. Аналогічно, якби ми скоригували степеневий показник так, щоб він був більш консервативним, ніж передбачає наш простий метод оцінки, ми також отримали б коротший період. Хоча 460 років все ще є дуже великим періодом, це набагато більш реалістична оцінка порівняно з $10^{114}$ роками, які ми отримали, використовуючи розподіл Гауса. Однією з переваг степеневої моделі є її здатність до екстраполяції: використовуючи степеневу оцінку $\\alpha$ та частоту менших прибутковостей, щодо яких ми маємо достовірні дані, ми можемо оцінити частоту майбутніх серйозних збоїв, щодо яких ми ще не отримали жодних даних. Ще про одну перевагу оцінки $\\alpha$ ми розглянемо далі.\n\n::: {.callout-tip}\n## ПРИМІТКА\n\nНе існує такого поняття, як \"подія з 10 сигмами\"! Справжня подія з 10 сигмами настільки неймовірно рідкісна, що пережити її протягом нашого життя --- мізерно мало. Екстремальні події, безумовно, трапляються, але вони не можуть бути описані за допомогою \"сигм\", їх потрібно враховувати і екстраполювати з використанням степеневих законів. Завжди будьте обережні, коли аналітики виправдовують себе за те, що вони не були готові до \"події з 10 сигмами\", оскільки це вказує на те, що їх моделі ризиків вкрай недосконалі.\n:::\n\n### Статистичні моменти під впливом важких хвостів\n\nЧому все це так важливо? Степенневий показник $\\alpha$ насправді багато говорить нам про стабільність і збіжність [моментів розподілу ймовірностей](https://en.wikipedia.org/wiki/Moment_(mathematics)), і це, в свою чергу, має значення для деяких найбільш часто використовуваних моделей у фінансах. Перші чотири центральні моменти --- це:\n\n- **[Середнє](https://en.wikipedia.org/wiki/Expected_value)**: очікуване значення розподілу\n- **[Дисперсія](https://en.wikipedia.org/wiki/Variance)**: Квадрат стандартного відхилення, який часто використовується для оцінки волатильності на основі розподілу прибутковості.\n- **[Асиметрія](https://en.wikipedia.org/wiki/Skewness)**: вимірює зміщення розподілу. Розподіл прибутковостей, як правило, має негативну асиметрію, оскільки збої є більш стрімкими, ніж підйоми.\n- **[Ексцес](https://en.wikipedia.org/wiki/Kurtosis)**: вимірює тяжкість хвостів розподілу. Розподіли прибутковостей зазвичай мають ексцес більший ніж у розподілі Гауса, тобто екстремальні події відбуваються частіше, ніж очікувалося в гаусовій моделі.\n\nЕксцес Гаусового розподілу дорівнює 3 (використовуючи визначення Пірсона, з визначенням Фішера [надлишкового ексцесу](https://en.wikipedia.org/wiki/Kurtosis#Excess_kurtosis) це 0), але наша вибірка щоденних логарифмічних прибутковостей S&P 500 має ексцес $28.6$, що знову вказує на те, що екстремальні події набагато більш вірогідні, що суперечить Гаусовому розподілу.\n\nТепер ми дійшли до того моменту, коли ми могли б запитати: наскільки сильно одна точка впливає на нашу оцінку ексцесу? Якщо ми перерахуємо ексцес всіх щоденних прибутків S&P 500 з 1950 року і виключимо тільки чорний понеділок 1987 року, ми отримаємо значення $14.3$, майже половину від значення, яке ми отримуємо, коли використовуємо всі значення! Видалення подальших найгірших днів, звичайно, ще більше зменшує ексцес, але ефект значно менший.\n\nБільш радикальний погляд на цю проблему досягається, якщо ми будуємо графік ексцесу в покроковому режимі, тобто для кожного дня ми будуємо розрахунковий ексцес, використовуючи всі минулі логарифмічні дані до цього моменту часу. Як ви можете бачити нижче, до \"Чорного понеділка\" ексцес ніколи не перевищував $15$, проте навіть через 35 років після \"Чорного понеділка\" ексцес ще не \"оговтався\" від цієї події і залишається на позначці 30. Чи означає це, що ми повинні просто ігнорувати Чорний понеділок як викид і продовжувати використовувати нашу \"чисту\" оцінку в $14.6$? Ні, точно ні! Як ми побачимо незабаром, ми скоріше повинні запитати себе, чи є сенс у тому, щоб оцінювати ексцес!\n\nТой факт, що одна точка даних може настільки сильно змінити нашу оцінку ексцесу, і, схоже, вона більше не сходиться, коли додаються нові точки даних, є чітким свідченням того, що ексцес базового розподілу ймовірностей насправді нескінченний! Проблема полягає в тому, що для кінцевої вибірки даних (а всі набори даних скінченні) ми завжди зможемо оцінити скінчене значення ексцесу. `scipy.stats.kurtosis` не може повернути $\\infty$, він завжди повідомлятиме про скінченний ексцес *вибірки*. Але ця кінцева оцінка не допоможе нам нічого сказати про майбутню поведінку ринку, оскільки ексцес продовжуватиме переходити до ще більших значень до наступного чорного понеділка, іншого чорного вівторка ... у більш-менш віддаленому майбутньому.\n\nОднак опис частоти екстремальних подій згідно степеневого закону, який ми представили вище, може допомогти нам вирішити, чи є ексцес кінцевим, так що, переглянувши достатню кількість точок даних, ми зможемо вирішити, чи слід прийняти той факт, що ексцес не піддається оцінці і справді нескінченний. Щоб побачити це, нам потрібно ввести ще один розподіл ймовірностей, [t-розподіл Стьюдента](https://en.wikipedia.org/wiki/Student%27s_t-distribution). Це колоколообразний симетричний розподіл зі степеневими хвостами. Його додатковий параметр $\\nu$ визначає показник степеневого закону $\\alpha=(\\nu+1)$. Нижче ми підганяємо t-розподіл до наших логарифмічних прибутковостей S&P 500, зберігаючи при цьому степеневий показник $\\alpha=3.7$ (відповідний $\\nu = 2.7$), який ми підганяли раніше:\n\nЗвичайно, можна поставити під сумнів, чи дійсно t-розподіл Стьюдента добре відповідає нашим логарифмічним прибутковостям, оскільки він переоцінює частоту абсолютних прибутковостей і все ще недооцінює ймовірність настання Чорного понеділка. На даний момент ми ігноруємо ці деталі та зосереджуємось на ексцесі t-розподілу Стьюдента та зв'язку зі степеневим показником $\\alpha$:\n\n- $\\text{Kurt} = \\frac{6}{\\nu-4} + 3~$ для $~\\nu > 4~$ або $~\\alpha > 5$\n- $\\text{Kurt} = \\infty~~~~~~~~~~\\,$ для $~2 < \\nu \\leq 4~$ або $~3 < \\alpha \\leq 5$\n- інакше невизначено\n\nЦе підтверджує наше початкове припущення про те, що при степеневому показнику, рівному $\\alpha \\approx 3.7$, ексцес дійсно нескінченний, і немає сенсу оцінювати його по скінченій вибірці, оскільки оціночне значення буде зберігатися тільки до наступної екстремальної події, яка підштовхне його ще вище. Ми можемо легко змоделювати цей ефект, витягуючи випадкові вибірки з t-розподілів Стьюдента з різними степеневими показниками, які відповідають трьом режимам, зазначеним вище. Нижче ми витягуємо 100 000 випадкових значень з t-розподілів з $\\alpha = 2$, $\\alpha = 3.7$, $\\alpha = 6$, а потім обчислюємо ексцес поетапно, як і раніше, щоб побачити, як еволюціонує передбачуваний ексцес вибірки з часом у трьох різних випадках:\n\nУ випадку $\\alpha=6$ ($\\nu=5$) ексцес скінченний і повинен приймати значення $\\frac{6}{\\nu - 4}+3=9$. Хоча ми бачимо деякі коливання, оціночне значення ексцесу повільно наближається до справжнього значення. Для прикладу, який відповідає степеневому показнику індексу S&P 500 з $\\alpha = 3.7$, моделювання показує таку ж поведінку, що і для реальних даних: збіжність не може бути виявлена, скоріше кожна екстремальна подія збільшує ексцес; при нескінченних вибірках ми би досягли нескінченного ексцесу. У третьому випадку з $\\alpha = 2$ ексцес t-розподілу Стьюдента навіть не визначений належним чином, і ми можемо побачити інший тип поведінки моделювання: зараз більшість точок даних збільшують оцінку ексцесу, а не лише кілька окремих екстремальних зразків. При такому повільно спадаючому статечному законі екстремальні значення зустрічаються повсюдно, що призводить до збільшення ексцесу при моделюванні.\n\n::: {.callout-tip}\n## Примітка\n\nНавіть якщо певні властивості розподілу ймовірностей нескінченні, ми завжди знайдемо кінцеві вибіркові оцінки при перегляді даного набору даних просто тому, що набір даних містить лише кінцеву кількість точок. Однак, якщо теорія степеневого закону чітко говорить нам, що певна властивість нескінченна, ми не повинні ніде використовувати кінцеві оцінки і ми не повинні використовувати моделі, які вимагають, щоб ця властивість була кінцевою! Якщо ми все одно це зробимо, це в кращому випадку буде працювати лише до наступної екстремальної події, яка анулює наші минулі оцінки і --- у випадку фінансових моделей --- може збанкрутувати нас!\n:::\n\n### Як ексцес дестабілізує розрахунки волатильності\n\nОскільки ексцес збільшується --- або стає нескінченним --- це також впливає на нижчі моменти, найголовніше, на дисперсію. Квадратний корінь дисперсії --- це стандартне відхилення, або [волатильність](https://en.wikipedia.org/wiki/Volatility_(finance)), як це називається у фінансах. Волатильність є розповсюдженним параметром при оптимізації портфеля і практично в кожній фінансовій моделі, оскільки в кінцевому підсумку вона стала найбільш часто використовуваним показником \"ризику\". Щоб побачити, як ексцес впливає на оцінку волатильності, ми проводимо простий експеримент [Монте-Карло](https://en.wikipedia.org/wiki/Monte_Carlo_method): ми витягуємо щоденну прибутковість за 50 років з розподілу ймовірностей за нашим вибором (ми будемо використовувати Гаусовий і t-розподіл Стьюдента) і обчислюємо оцінку волатильності, використовуючи вибіркове стандартне відхилення. Ми робимо це не тільки один раз, але і 10000 разів, кожен раз, коли ми розраховуємо нову гіпотетичну щоденну прибутковість за 50 років і обчислюємо відповідну оцінку волатильності. Звичайно, не всі ці оцінки будуть однаковими, але коливатимуться навколо справжньої волатильності, оскільки ми маємо лише кінцеву кількість даних. Оскільки ми знаємо справжній розподіл ймовірностей, який ми використовуємо для моделювання, ми також знаємо справжню волатильність. Щоб побачити, наскільки точно ми можемо оцінити волатильність на основі даних за 50 років, ми обчислюємо відносну похибку між оцінками волатильності та справжньою волатильністю.\n\nМи отримуємо наступні відносні похибки для різних розподілів та їх параметрів:\n- Гаусовий розподіл; відн. похиб. $\\approx 0.5\\%$\n- t-розподіл Стьюдента з $\\alpha=6.0$ ($\\nu=5.0$); відн. похиб. $\\approx 1.0\\%$\n- t-розподіл Стьюдента з $\\alpha=4.0$ ($\\nu=3.0$); відн. похиб. $\\approx 3.8\\%$\n- t-розподіл Стьюдента з $\\alpha=3.7$ ($\\nu=2.7$); відн. похиб. $\\approx 6.1\\%$\n\nПри степеневому показнику $\\alpha= 3.7$ (що відповідає $\\nu = 2.7$; як ми підрахували для S&P 500, щоб пояснити Чорний понеділок), щоденна прибутковість за 50 років все ще призводить до помилки оцінки волатильності більш ніж на $6%$! Зверніть увагу, що ця велика помилка оцінки зростатиме ще швидше, коли вона наближається до $\\alpha = 3.0$, оскільки дисперсія стає нескінченною для t-розподілу Стьюдента при $\\alpha = 3.0$ ($\\nu = 2.0$). Виходячи з t-розподілу прибутковостей S&P 500, похибка оцінки волатильності зросла в 12 разів (!) порівняно з тим, що ми очікували б, припускаючи, що прибутковості розподілені за Гаусом.\n\n::: {.callout-tip}\n## Примітка\n\nЧим важчі хвости розподілу прибутковостей, тим більше точок даних необхідно для досягнення необхідної достовірності оцінок певних параметрів. Пам'ятайте про це щоразу, коли ви намагаєтеся оцінити ризик інвестування у відносно новий фінансовий актив, який має дані лише за кілька років.\n:::\n\n### Наслідки для моделювання та прогнозування\n\nТой факт, що більш високі моменти розподілу прибутковості можуть бути нескінченними і що оцінка нижчих моментів, таких як дисперсія, дестабілізується за наявності \"товстих хвостів\", має суттєві наслідки для деяких найбільш використовуваних моделей у фінансах. Ми коротко розглянемо дві з них, щоб проілюструвати проблему.\n\n### Марковіц і стабільність волатильності\n\nУ 1954 році [Гаррі Марковіц](https://en.wikipedia.org/wiki/Harry_Markowitz) отримав ступінь доктора економічних наук за роботу з теорії фінансових портфелів. Його робота стала наріжним каменем [сучасної портфельної теорії](https://en.wikipedia.org/wiki/Modern_portfolio_theory) і тоді це було настільки новим, що під час захисту докторської дисертації Мілтон Фрідман стверджував, що ця робота насправді не стосується галузі економіки (як пояснив Марковіц у своїй [Нобелівській лекції](http://nobelprize.org/nobel_prizes/economics/laureates/1990/markowitz-lecture.html) у 1990 році). Марковіц стверджував, що при заданому рівні волатильності існує набір вагових коефіцієнтів розподілу активів у портфелі, які дають максимальну надлишкову прибутковість портфеля (порівняно з безризиковим активом). Якщо ви переглянете діапазон значень волатильності та обчислите максимальну віддачу портфеля, отримавши оптимальні ваги розподілу, Ви отримаєте набір *ефективних* портфелів, який також називають [межею ефективності](https://en.wikipedia.org/wiki/Efficient_frontier). Одна точка на цій межі в багатьох випадках представляє особливий інтерес, --- це точка максимуму [коефіцієнта Шарпа](https://en.wikipedia.org/wiki/Sharpe_ratio).\n\nКоефіцієнт Шарпа --- це часто критикуваний, але також часто використовуваний показник для оцінки ефективності портфеля або фінансових активів загалом, таких як гедж-фонди або ETF. Він визначається як:\n\n$$\nS = \\frac{\\mu - \\mu_{\\text{rf}}}{\\sigma}.\n$$\n\nТут $\\mu$ позначає річну прибутковість портфеля, $\\mu_{\\text{rf}}$ позначає річну безризикову прибутковість, а $\\sigma$ позначає річну волатильність портфеля. Припускаючи нульову безризикову ставку ($\\mu_{\\text{rf}} = 0$), коефіцієнт Шарпа можна інтерпретувати як [співвідношення сигнал/шум](https://en.wikipedia.org/wiki/Signal-to-noise_ratio), відомий у фізиці та інженерії: максимізуючи коефіцієнт Шарпа, ми знаходимо найкращий компромісне значення, що максимізує наші прибутковості (сигнал) та мінімізує волатильності (шум).\n\nЯкщо наш портфель складається з $n$ фінансових активів з очікуваною прибутковістю $\\vec{\\mu} = (\\mu_{1},...,\\mu_{n})$, з коваріаційною матрицею $\\Sigma$, яка містить інформацію про волатильність і кореляції між активами, і з вектором ваги розподілу $\\vec{w} = (w_1,...,w_n)$ (нормалізовано до одиниці: $\\sum_{i=1}^n w_i = 1$), тоді коефіцієнт Шарпа у контексті сучасної теорії портфеля можна обчислити наступним чином:\n\n$$\nS(\\vec{w}) = \\frac{\\vec{w}\\cdot\\vec{\\mu}}{\\sqrt{\\vec{w}\\Sigma\\vec{w}^T}}.\n$$\n\nЗверніть увагу, що з цього моменту ми завжди припускаємо, що $\\mu_{\\text{rf}} = 0$. \n\nЩоб максимізувати прибутковість відносно волатильності та отримати портфель з максимальним коефіцієнтом Шарпа, ми змінюємо ваги розподілу, поки не знайдемо набір ваг $\\vec{w}^*$ з максимальним коефіцієнтом Шарпа:\n\n$$\n\\vec{w}^* = \\text{argmax}_{\\vec{w}} ~ S(\\vec{w})\n$$\n\nОсновне припущення, що лежить в основі сучасної теорії портфеля, полягає в тому, що об'єднаний розподіл логарифмічних прибутковостей всіх активів у портфелі може бути повністю охарактеризований мультиваріативним розподілом Гауса. Після попередніх частин цієї лабораторної ми дуже добре розуміємо цю помилку, і сучасна теорія портфеля по праву зазнала жорсткої критики за відсутність врахування \"важких хвостів\", наприклад, з боку Нассіма Талеба:\n\n\n::: {.callout-tip}\n## Нассім Талеб у *Чорний лебідь: Про (не)ймовірне в реальному житті* (ст. 277)\n\nПісля краху фондового ринку (у 1987 році) вони нагородили двох теоретиків, Гаррі Марковіца та Вільяма Шарпа, які побудували прекрасні платонівські моделі на гаусовій основі, сприяючи тому, що називається сучасною теорією портфеля. Простіше кажучи, якщо ви видалите їх гаусові припущення і розглядаєте ціни як масштабо-інваріантні, у вас залишиться гаряче повітря. Нобелівський комітет міг би протестувати моделі Шарпа і Марковіца --- вони працюють як шарлатанські ліки, що продаються в Інтернеті, --- але ніхто в Стокгольмі, схоже, про це не подумав.\n:::\n\nТут ми просто хочемо проілюструвати наслідки припущення гаусовости, змоделювавши прибутковість двох гіпотетичних акцій і спробувавши знайти ваги розподілу по максимуму Шарпа. Як ми побачимо, великі хвости в модельованих розподілах прибутковостей вносять істотну невизначеність в розрахункові ваги розподілу --- прямий наслідок нестабільності дисперсії.\n\nСпочатку ми генеруємо випадкові числа з Гаусового розподілу, достатнього для моделювання щоденної прибутковості двох гіпотетичних акцій за 10 років. Ми присвоюємо їм різну позитивну очікувану прибутковість і волатильність. Для простоти ми припускаємо, що кореляція між двома активами є нульовою:\n\nЗвичайно, насправді ми не знаємо *справжньої* очікуваної прибутковості або значень волатильності кореляцій між активами. Таким чином, ми повинні оцінити очікувану прибутковість за середнім значенням вибірки та матрицю коваріації за матрицею коваріації вибірки. Зверніть увагу, що існують більш складні способи оцінки цих параметрів на основі історичних даних, таких як [оцінки усадки](http://www.ledoit.net/honey.pdf) для коваріаційної матриці або [моделі розподілу Блека-Літтермана](https://sci-hub.mksa.top/10.3905/jfi.1991.408013). Ці методи, безумовно, покращують вибіркові оцінки, але загальний недолік сучасної теорії портфеля через наявність \"важких хвостів\" залишається. Щоб вивчити та протестувати різні методи оптимізації портфеля, рекомендуємо розглянути бібліотеку [PyPortfolioOpt](https://pyportfolioopt.readthedocs.io/en/latest/index.html), що представляє собою добре задокументований пакет Python, який реалізує як основні, так і складні методи оптимізації портфеля та дозволяє легко тестувати ці методи на реальних даних. Поки ми дотримуємося вибіркових оцінок (і використовуємо коефіцієнт 252 --- середню кількість торгових днів на рік для отримання очікуваної прибутковості в річному обчисленні і коваріації за щоденними оцінками):\n\nДалі ми визначаємо функцію, яка приймає ваги розподілу кандидатів, розрахункову очікувану прибутковість і коваріаційну матрицю і виводить коефіцієнт Шарпа портфеля:\n\nЗамість того, щоб використовувати реальний оптимізатор для пошуку ваг розподілу, які максимізують коефіцієнт Шарпа, ми просто переглядаємо всі можливі комбінації ваг з інтервалом $1\\%$. Звичайно, це розумний підхід лише для двох активів, і він швидко стає нерозв'язним, використовуючи більше двох активів.\n\nТепер ми можемо перебрати всі наші ваги-кандидати, обчислити коефіцієнт Шарпа портфеля для всіх з них, а потім вибрати оптимальний набір ваг.\n\nЩоб отримати уявлення про те, наскільки точно ми можемо оцінити ваги розподілу на основі гіпотетичної щоденної прибутковості за 10 років, ми зараз повторюємо цей експеримент, повторно генеруємо нові випадкові прибутковості, повторно оцінюємо очікувані прибутковості та матрицю коваріації та знаходимо оптимальні ваги. Ми робимо це 10000 разів. Зверніть увагу, що ми реєструємо лише першу вагу розподілу $w_1$ для кожного запуску без втрати інформації, оскільки друга вага безпосередньо випливає з нормалізації $w_2 = 1 - w_1$.\n\nНарешті, ми можемо побудувати гістограму всіх 10000 значень, які ми отримуємо для $w_1$\n\nЯк ми бачимо, розподіл для першої акції коливається приблизно від $60%$ до $70%$ на основі історичних даних за 10 років. Ми можемо додатково оцінити це кількісно, обчисливши 5-й і 95-й процентилі всіх значень $w_1$. Таким чином, з упевненістю в $90%$ ми отримаємо розподіл між $61%$ і $72%$:\n\nТепер давайте повторимо цей експеримент, але цього разу ми замінимо розподіл Гауса на розподіл Стьюдента зі степеневим показником $\\alpha=3.7$ (що відповідає кількості ступенів свободи $\\nu=2.7$). Ми залишаємо очікувану прибутковість і волатильність (виміряні стандартним відхиленням розподілу) точно такими ж. Зверніть увагу, що стандартне відхилення стандартного t-розподілу визначається як $\\sqrt{\\frac{\\nu}{\\nu-2}}$ в нашому випадку, тому ми повинні внести поправку на цей коефіцієнт маштабування при вилученні випадкових значень зі стандартного t-розподілу. Нижче ви можете побачити пряме порівняння розподілів Гауса, використаних у наведеному вище моделюванні, та t-розподілів із відповідним середнім значенням та стандартним відхиленням.\n\nЯк ми можемо легко бачити, узгоджені t-розподіли Стьюдента насправді дають менші значення прибутковостей. Однак вони також дають набагато більш екстремальні значення, але ми не можемо легко побачити це, оскільки значення щільності ймовірності в хвостах дуже малі! Якщо ми перейдемо до логарифмічного масштабування вісі Oy, картина стане більш чіткою:\n\nТепер ми чітко бачимо, що, наприклад, ймовірність щоденних логарифмічних прибутковостей $-0.02$ для акції 1 в $10^{10}$ разів вища за умови t-розподілу порівняно з відповідним розподілом Гауса! Завжди дивіться на розподіли з логарифмічною шкалою щільності ймовірності, щоб отримати чітке уявлення про хвости. Використовуючи наші узгоджені t-розподіли, ми діємо, як і раніше, і моделюємо гіпотетичні 10-річні історичні показники для наших двох некорельованих акцій. Нижче ви можете побачити приклад. Тільки при уважному розгляді ви можете помітити, що ці криві сукупної прибутковості насправді трохи більш нерівні в порівнянні з тими, які були побудовані вище з гаусовими прибутковостями. Але різниця невловима, якщо дивитися на таку \"наближену\" діаграму десятирічного періоду:\n\nНарешті, щоб візуалізувати вплив t-розподілу на оцінку ваги розподілу, ми повторюємо наш експеримент Монте-Карло з моделювання 10000 різних 10-річних історичних значень та оцінюємо ваги розподілу в кожному з цих 10000 випадків. Потім ми будуємо графік розподілу $w_1$ і порівнюємо цей розподіл з розподілом, отриманим в результаті моделювання на основі Гауса.\n\nЯк ми можемо бачити, оптимальна вага розподілу $w_1$ тепер коливається між $54\\%$ і $77\\%$, що приблизно в 2 рази перевищує ширину надійного інтервалу для оптимізації портфеля, яка дотримувалася припущення про гаусовість! Навіть при узгодженому стандартному відхиленні гаусового і t-розподілу, нескінченний ексцес t-розподілу дестабілізує вибіркову дисперсію наших змодельованих прибутковостей і, таким чином, знижує точність наших оціночних ваг розподілу. Хоча цей приклад, безумовно, не розкриває всіх слабкостей сучасної теорії портфеля, він допомагає нам побачити, як досить абстрактні ефекти, такі як нестабільність дисперсії через надмірний ексцес, в кінцевому результаті псують широко використовувані фінансові моделі. Використання модельованої прибутковості, заснованої на гаусовому розподілі порівняно з розподілом з великим хвостом, може допомогти виявити обмеження фінансових моделей або знайти мінімальний обсяг даних, необхідний для досягнення певної достовірності, перш ніж нова модель буде фактично запущена у виробництво!\n\n::: {.callout-tip}\n## Примітка\n\nВажкі хвости розподілу прибутковостей можуть сильно вплинути на результати усталених математичних моделей у фінансах, або збільшуючи невизначеність параметрів (як у сучасній теорії портфеля), або приводячи до збоїв моделей поза вибірки через нескінченно великі моменти. У фінансах краще екстраполювати частоту екстремальних подій і готуватися до них за допомогою конкретних інструментів геджування, ніж намагатися передбачити майбутню прибутковість за допомогою моделей часових рядів!\n:::\n\n### Розподіл Леві\n\nАльфа-стабільний розподіл є узагальненням розподілу Гауса, яке цінується за те, що воно тягне за собою жирні хвости. З цієї причини він широко використовується при обробці сигналів, наприклад, у медицині чи фінансах.\n\nЗагальний клас стабільних розподілів був введений і отримав цю назву французьким математиком Полем Леві на початку 1920-х років.\n\nРаніше ця тема привертала лише помірну увагу провідних експертів, хоча були і ентузіасти, з яких можна згадати російського математика Олександра Яковича Хінчіна. Натхненням для Леві стало бажання узагальнити відому центральну граничну теорему, згідно з якою будь-який розподіл ймовірностей з кінцевою дисперсією збігається до гауссового розподілу.\n\nСтабільні розподіли мають три виняткові властивості, які можна коротко підсумувати, заявляючи, що вони:\n\n- інваріантні при додаванні;\n- мають власну область збіжності;\n- дозволяють канонічну форму характеристичної функції.\n\n#### Інваріантність при додавані\n\n*Випадкова величина $X$ підпорядковується стабільному розподілу $P(x) = \\text{Prob}\\{X \\leq x\\}$ якщо для будь-якого $n \\geq 2$ існують додатнє значення $c_{n}$ та дійсне значення $d_{n}$ такі, що*\n\n$$ \nX_1 + X_2 + ... + X_n \\stackrel{d}{=} c_{n}X + d_{n}, \n$$\n\n*де $X_1, X_2, ..., X_n$ характеризуються як незалежні, ідентично розподілені випадкові величини.* Також $\\stackrel{d}{=}$ позначає *рівність розподілів*, тобто, випадкові величини з обох сторін мають однаковий розподіл ймовірностей.\n\nЗагалом, сума незалежних, ідентично розподілених випадкових величин результує у випадкову величину з іншим розподілом. Однак, для випадкових величин, що характеризуються *стабільним* розподілом, сума ідентично розподілених випадкових величин до величини такого самого розподілу. У цьому випадку результуюча випадкова величина (розподіл) може відрізнятися від попередніх величин характерним масштабом ($c_{n}$) та зміщенням ($d_{n}$). Якщо $d_{n} = 0$, розподіл називається *строго стабільним*.\n\nВідомо, що нормована константа $c_{n}$ має вид \n\n$$\nc_{n} = n^{1/\\alpha} \\, \\text{with} \\, 0 < \\alpha \\leq 2. \n$$\n\nПараметр $\\alpha$ має назву *характеристична експонента* або *індекс стабільності* стабільного розподілу.\n\nПопередня теорема має альтернативну версію, що включає в суму лише дві випадкові величини. *Випадкова величина $X$ підпорядковується стабільному розподілу, якщо для будь-яких позитивних значень $A$ та $B$ існує позитивне число $C$ та дійсне число $D$ такі, що*\n\n$$ \nA X_1 + B X_2 \\stackrel{d}{=} C X + D, \n$$\n\n*де $X_1$ та $X_2$ незалежні копії $X$*. Тоді існує значення $\\alpha \\in (0, 2]$ при яких значення $C$ задовільняє рівність $C^{\\alpha} = A^{\\alpha} + B^{\\alpha}$.\n\nДля строго стабільних розподілів $D = 0$. Це означає, що всі лінійні комбінації випадкових незалежних, ідентично розподілених випадкових величин, що підкоряються строго стабільному розподілу, результують у випадкову величину з одним і тим же типом розподілу. \n\nСтабільний розподіл вважається *симетричним*, якщо випадкова величина $-X$ має такий самий тип розподілу. *Симетричний* стабільний розподіл обов'язково *строго стабільний*. \n\nОскільки аналітичний вираз функції щільності ймовірностей для стабільного розподілу невідома, за винятком кількох членів стабільного сімейства, більшість традиційних методів математичної статистики не можуть бути використані. Відбовідними вийнятками є\n\n- **Гаусовий розподіл** $S_2(0,\\mu, \\sigma) = \\mathcal{N}(\\mu, 2\\sigma^2)$. Гаусовий розподіл є спеціальним випадком стабільного розподілу при $\\alpha = 2$ так що $\\mathcal{N}(\\mu, \\sigma) = S(2,0,\\mu, \\frac{\\sigma}{\\sqrt{2}})$, де $\\mu$ позначає середнє значення нормального розподілу, а $\\sigma$ --- це стандартне відхилення. Функція щільності ймовірностей має вид \n\n$$ \n\\frac{1}{\\sigma\\sqrt{2\\pi}}\\text{exp}^{-(x-\\mu)^{2}/2\\sigma^{2}}. \n$$\n\n- **Розподіл Коші**. Розподіл Коші --- це ще одне представлення стабільного розподілу при $\\alpha = 1$ та $\\beta = 0$ такими, що $Cauchy(\\delta, \\gamma) = S_1(1,0,\\gamma,\\delta)$, де $\\gamma$ --- це параметр масштабування, а $\\delta$ --- це параметр зсуву розподілу Коші. Функція щільності ймовірностей представлена як: \n\n$$ \n\\frac{\\gamma}{\\pi((x-\\delta)^2 + \\gamma^2)}, \\, -\\infty < x < \\infty. \n$$\n\n- **Розподіл Леві** також є вийнятком із класу стабільних розподілів, де $\\alpha = 0.5$ і $\\beta = 1$. Іншими словами, $Levy(\\delta, \\gamma) = S_{1/2}(0.5, 1, \\gamma, \\delta)$. Функція щільності ймовірностей має вид \n\n$$ \n\\sqrt{\\frac{\\gamma}{2\\pi}}\\frac{1}{(x-\\delta)^{3/2}}\\exp{\\left[ \\frac{-\\gamma}{2(x-\\delta)} \\right]}, \\, \\delta < x < \\infty. \n$$\n\nЯкщо $X \\sim S_{1/2}(0.5, 1, \\gamma, \\delta)$, тоді для $x > 0$\n\n$$ \nP(X \\leq x) = 2 \\left( 1 - \\phi \\left( \\sqrt{\\frac{\\gamma}{x}} \\right) \\right), \n$$\n\nде $\\phi$ позначає кумулятивну функцію нормального розподілу.\n\n#### Область збіжності\n\nІнше (еквівалентне) визначення стверджує, що стабільні розподіли --- це єдині розподіли, які можна отримати при границі нормалізованих сум незалежних, ідентично розподілених випадкових величин. Кажуть, що випадкова величина $X$ має область збіжності, тобто якщо існує послідовність незалежних, ідентично розподілених випадкових величин $Y_1, Y_2, ...$ і послідовності позитивних чисел ${\\gamma_n}$ і дійсних чисел ${\\delta_n}$ таких, що\n\n$$  \n\\frac{Y_1 + Y_2 + ... + Y_n}{\\gamma_n} + \\delta_n \\stackrel{d}{\\Rightarrow} X.  \n$$\n\nКоли $X$ це гаусова випадкова величина, а $Y_i's$ є незалежними, ідентично розподіленими випадковими величинами з визначенною дисперсією, тоді рівняння вище є твердженням звичайної *центральної граничної теореми*. Область збіжності $X$ вважається *нормальною* коли $\\gamma_n = n^{1/\\alpha}$. \n\n#### Канонічні представлення характеристичної функції\n\nЧотири параметри використовуються для опису випадкової величини, що слідує за стабільним розподілом: $X \\sim S(\\alpha, \\beta, \\mu, \\gamma)$. Параметр $\\alpha \\in (0, 2]$ --- це той, який нас найбільше зацікавить. Цей параметр визначає товщину хвостів. Параметр $\\beta \\in [-1, 1]$ є параметром асиметрії. Останні два параметри позначають розташування $(\\mu \\in \\Re)$ і масштаб $(\\gamma > 0)$ розподілу. Альфа-стабільний розподіл немає жодного аналітичного виразу для щільності ймовірності $X$, але ми можемо охарактеризувати його характеристичною функцією:\n\n$$\n    \\begin{split}\n    \\phi(t) &= E\\left[\\exp(itX)\\right] \\\\\n            &= \n        \\begin{cases} \n            \\exp\\left(i \\mu t - \\gamma^{\\alpha}|t|^{\\alpha} \\left[1-i\\beta\\text{sign}(t)\\tan{\\frac{\\pi\\alpha}{2}}\\right]\\right) & \\text{if} \\, \\alpha \\neq 1 \\\\ \\exp\\left(i \\mu t - \\gamma|t| \\left[1+i\\beta\\text{sign}(t)\\frac{2}{\\pi}\\log{|t|}\\right]\\right) & \\text{if} \\, \\alpha = 1. \n        \\end{cases} \n    \\end{split}\n$$\n\nМи могли б використовувати перетворення Фур'є, щоб отримати функцію щільності розподілу ймовірностей з характеристичної функції: \n\n$$ \nf(x) = \\frac{1}{2\\pi}\\int_{-\\infty}^{+\\infty} \\phi(t) \\cdot \\exp(-itX) dt. \n$$\n\nАле наведена вище параметризація не є повністю задовільною, оскільки функція щільності розподілу ймовірностей не є безперервною, зокрема, при $\\alpha = 1$. Дійсно, коли $\\beta > 0$, щільність розподілу зміщується вправо, коли\n$\\alpha < 1$ і вліво, коли $\\alpha > 1$, зі зсувом в сторону $+\\infty$ (відповідно $-\\infty$), коли $\\alpha$ прагне до 1. Таким чином, для прикладного аналізу даних та інтерпретації коефіцієнтів слід уникати такої параметризації. \n\nІснує багато параметризацій для стабільних законів, і ці різні параметризації викликали велику плутанину. Різноманітність параметризацій обумовлена поєднанням історичної еволюції плюс численними проблемами, які були проаналізовані за допомогою спеціалізованих форм стабільного розподілу. Є вагомі причини використовувати різні параметризації в різних ситуаціях. Якщо в пріорітеті чисельні розрахунки, робота із даними, то краще використовувати одну параметризацію. Якщо бажані прості алгебраїчні властивості розподілу або аналітичні властивості строго стійких законів, то краще розглянути декілька параметризацій. Нолан запропонував використовувати параметризацію Золотарьова (M), яку також часто позначають як $S^{0}$. Характеристична функція, що відповідає $X \\sim S^{0}(\\alpha, \\beta, \\mu_{0}, \\gamma)$, дорівнює:\n\n$$\n    \\begin{split}\n    \\phi(t) &= E\\left[\\exp(itX)\\right] \\\\\n            &= \n        \\begin{cases} \n            \\exp\\left(i \\mu_{0} t - \\gamma^{\\alpha}|t|^{\\alpha} \\left[1+i\\beta\\text{sign}(t)\\tan{\\frac{\\pi\\alpha}{2}}\\left( \\gamma^{1-\\alpha}|t|^{1-\\alpha}-1 \\right)\\right]\\right) & \\text{if} \\, \\alpha \\neq 1 \\\\ \\exp\\left(i \\mu_{0} t - \\gamma|t| \\left[1+i\\beta\\text{sign}(t)\\frac{2}{\\pi}\\left(\\log{|t|} + \\log{\\gamma}\\right) \\right]\\right) & \\text{if} \\, \\alpha = 1. \n        \\end{cases}\n    \\end{split} \n$$\n\nЦя альтернативна параметризація недалека від зазначеної напочатку. Єдина відмінність стосується параметра $\\mu$, який у даній параметризації коригує зсув для значень $\\alpha$ близьких до 1:\n\n$$ \n\\mu_{0} = \\begin{cases} \\mu + \\beta\\gamma\\tan{\\frac{\\pi\\alpha}{2}} & \\text{if} \\, \\alpha \\neq 1 \\\\ \\mu + \\beta\\frac{2}{\\pi}\\gamma\\log{\\gamma} & \\text{if} \\, \\alpha = 1. \\end{cases} \n$$\n\n#### Метод розрахунку параметрів $\\alpha$-стабільного розподілу\n\nЧислені методи, такі як метод Маккаллоха, заснований на квантилях, і метод оцінки максимальної правдоподібності були розроблені в результаті відсутності аналітичних рішень. Припустимо, що $\\text{X} = (X_1, ... , X_T)$ вектор, що складається з $T$ незалежних ідентично розподілених випадкових величин із розподілу Парето, і також $x \\sim S_{\\alpha}(\\alpha, \\beta, \\delta, \\gamma)$. Визначивши $\\theta = (\\alpha, \\beta, \\delta, \\gamma)$, Митник, Доганоглу та Ченайо розробили алогритм максимальної правдоподібності і показали, що $\\theta$ можна розрахувати, максимізуючи функцію логарифмічної правдоподібності\n\n$$ \nl(\\theta, x) = \\sum_{i=1}^{T}\\log{f(x_{i}, \\theta)}.\n$$\n\nДюмушель застосував метод максимальної правдоподібності до стабільного розподілу і визначив функцію правдоподібності наступним чином: \n\n$$ \nL(\\theta) = \\prod_{k=1}^{n}S_{\\alpha,\\beta} \\left( \\frac{X_{k} - \\delta}{\\gamma} \\right) \\Big/ \\gamma, \n$$ \n\nде $\\theta = (\\alpha, \\beta, \\delta, \\gamma)$ опираючись на $x = (x_1, ... , x_n)$ для розміру вибірки $n$. \n\n## Хід роботи\n\nЗчитуємо дані з Yahoo Finance:\n\n::: {.callout-warning}\n## Увага\n\nВиконайте цей блок, якщо хочете зчитати дані не з Yahoo! Finance, а із власного файлу. Зрозуміло, що й аналіз результатів, і висновки залежать від того з яким рядом ми працюємо. \n\n:::\n\n---\n\n---\n\nВиводимо графік досліджуваного ряду\n\n### Побудова розподілу Леві та розрахунок параметрів для всього ряду\n\nДля приведення ряду до стандартизованого вигляду або прибутковостей визначимо функцію `transformations()`:\n\nДля побудови в парі певного індикатора та досліджуваного ряду визначимо функцію `plot_pair`:\n\nДалі виконаємо приведення ряду до прибутковостей:\n\nПідганяємо розподіл Леві та Гауса для порівняння:\n\nОтримуємо параметри розподілу Леві у відповідності до однієї із параметризацій, що пропонує пакет `levy`:\n\nБудуємо теоретичні та емпіричні розподіли:\n\nВиводимо параметри розподілу Леві для заданого індексу\n\nДля досліджуваного індексу бачимо, що параметр $\\alpha < 2.0$ та $\\beta < 0$, що вказує на відхилення розподілу даного індексу від нормального. Тобто, для даного ряду переважаючими є кризові явища, на що вказують важкі хвости розподілу. Із порівняльного аналізу Гауссового та Леві розподілів бачимо, що хвости нормального розподілу значно недооцінюють ймовірність появи кризових явищ чого, наприклад, не скажешь про альфа-стабільний розподіл. Взявши логарифм значень ймовірності по осі $Oy$ ми можемо спостерігати, що, наприклад, недооцінка негативних прибутковостей Гаусовим розподілом, у порівнянні з альфа-стабільним, складає $\\approx 10^{15}$ порядків. Для позитивних прибутковостей, що перевищують значення $+10\\sigma$ недооцінка Гауссовим розподілом складає $\\approx 10^{27}$ порядків. Теоретичне значення альфа-стабільного розподілу достатньо точно враховує важкі хвости емпіричного розподілу, що також виражається високим ексцесом розподілу. Також варто зазначити, що коефіцієнт асиметрії $\\beta$ вказує на невеличке зміщення розподілу в ліву сторону, що також демонструє переважання кризових явищ. \n\n### Дослідження поведінки альфа-стабільного розподілу Леві\n\n### Віконна процедура\n\nУ даному блоці оберемо тип ряду для якого і виконуватимуться розрахунки. Перед нами представлено 6 варіантів представлення часового ряду. Виконуватимемо подальші обчислення для стандартизованих прибутковостей, оскільки згідно багатьом роботам було показано, що розподіл прибутковостей тих же самих фінансових активів (фондових індексів, валютних, криптовалют, тощо) виходить за межі нормального Гауссового розподілу. Покажемо це у даному ноутбуці та застосуємо альфа-стабільний розподіл Леві для кращого моделювання складних систем та передчасної ідентифікації кризових явищ. \n\nЗберігаємо абсолютні значення у текстовому документі:\n\n### Динаміка показника стабільності $\\alpha$\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nПараметр $\\alpha$ (індекс стабільності хвостів розподілу) починає спадати у (перед)кризовий період, що робить його індикатором(-передвісником) кризових явищ. Під час криз у розподілі прибутковостей зростає ексцес, а самі хвости стають важчими, на що даний показник реагує передчасно.\n\n### Динаміка показника асиметрії $\\beta$\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nДинаміка даної міри виглядає набагато хаотичніше у порівнянні з індексом стабільності. Для представлених результатів можна зробити наступний висновок: у передкризовий період даний показник має зростати, вказуючи на значну правосторонню асиметрію розподілу прибутковостей (переважання позитивних прибутковостей). Для кризового періоду цей показник має спадати, вказуючи на домінацію негативних прибутковостей (лівостороння асиметрія розподілу). Даний показник важко розглядати у якості надійного індикатора, оскільки його коливання представляються значними навіть при незначних падіннях представленого фондового індексу. \n\n### Динаміка параметра зміщення $\\mu$\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nПоказник розташування $\\mu$ потроху спадає у кризовий період, демонструючи зміщення розподілу в сторону негативних прибутковостей. Тим не менш, цей розподіл представляєть настільки ж хаотичним як і показник асиметрії $\\beta$. \n\n### Динаміка параметра масштабу $\\sigma$\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nІз представлених результатів видно, що даний показник спадає у (перед)кризовий період, вказуючи на зменшення масштабу (форми) альфа-стабільного розподілу Леві.\n\nОтже, з усіх 4-ох показників, показник стабільності $\\alpha$ є найкращим для ідентифікації кризових явищ та побудови надійних стратегій ризик-менеджменту. \n\n## Висновок\n\nСтабільні розподіли --- захоплюючий і плідний об'єкт досліджень в теорії ймовірностей; більше того, в даний час вони мають велику цінність при моделюванні складних процесів у фізиці, астрономії, економіці, теорії комунікацій, тощо. \n\nУ даній роботі було представлено теоретичні та чисельні обгрунтування в сторону альфа-стабільного розподілу Леві в якості практичної моделі для кращого розуміння та передбачення кризових явищ у складних системах.  \n\nТут ми представили розрахунки як для усього ряду, так і для його підфрагментів, використовуючи алгоритм ковзного вікна. Виходячи з усього ряду прибутковостей, видно, що хвости їх розподілу далеко виходять за межі Гаусового. Найкраще емпіричний розподіл прибутковостей збігається саме з теоретичним альфа-стабільним розподілом Леві. \n\nВикористовуючи алгоритм сковзного вікна, ми побачили, що параметри альфа-стабільного розподілу змінюються з часом.\n\n::: {.callout-tip}\n## Література для подальшого вивчення степеневих розподілів та важких хвостів \n\nNassim Taleb's [*Statistical Consequences of Fat Tails: Real World Preasymptotics, Epistemology, and Applications*](https://arxiv.org/ftp/arxiv/papers/2001/2001.10488.pdf) (вільно доступна за посиланням).\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"highlight-style":"oblivion","css":["style.css"],"output-file":"lab_12.html"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рис.","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"ru","fig-responsive":true,"quarto-version":"1.3.433","bibliography":["references.bib"],"callout-appearance":"default","grid":{"body-width":"1050px"},"page-layout":"full","theme":{"light":"cosmo","dark":"superhero"},"title":"Лабораторна робота № 12"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":true,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","toc":true,"number-sections":true,"output-file":"lab_12.pdf"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рис.","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"block-headings":true,"lang":"ru","bibliography":["references.bib"],"callout-appearance":"default","documentclass":"report","title":"Лабораторна робота № 12"},"extensions":{"book":{"selfContainedOutput":true}}},"docx":{"identifier":{"display-name":"MS Word","target-format":"docx","base-format":"docx"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","toc":true,"number-sections":true,"output-file":"lab_12.docx"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рис.","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"ru","bibliography":["references.bib"],"callout-appearance":"default","title":"Лабораторна робота № 12"},"extensions":{"book":{"selfContainedOutput":true}}},"epub":{"identifier":{"display-name":"ePub","target-format":"epub","base-format":"epub"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"epub","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":false,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"default-image-extension":"png","html-math-method":"mathml","to":"epub","toc":true,"number-sections":true,"output-file":"lab_12.epub"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рис.","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"ru","bibliography":["references.bib"],"callout-appearance":"default","title":"Лабораторна робота № 12"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf","docx","epub"]}