{"title":"Лабораторна робота № 7","markdown":{"yaml":{"title":"Лабораторна робота № 7"},"headingText":"Теоретичні відомості","containsRefs":false,"markdown":"\n\n\n\n\n\n\n**Тема.** Мультифрактальний аналіз складних систем \n\n**Мета.** Навчитися використовувати мультифрактальний аналіз детрендованих флуктуацій для отримання індикаторів нелінійних змін у системі\n\n\n### Визначення мультифракталів\n\nУ цій лабораторній ми викладемо основи теорії мультифракталів --- **неоднорідних фрактальних об'єктів**, для повного опису яких, на відміну від регулярних фракталів, недостатньо введення лише однієї величини, його фрактальної розмірності $D$, а потрібен цілий спектр таких розмірностей, кількість яких, взагалі кажучи, нескінченна. Причина цього полягає в тому, що поряд із суто геометричними характеристиками, які визначаються величиною $D$, такі фрактали характеризуються й деякими специфічними статистичними властивостями.\n\nПростіше всього пояснити, що розуміється під “неоднорідним фракталом” на прикладі трикутника Серпинського, отриманого за допомогою методу випадкових ітерацій ([@fig-triangle]).\n\n::: {#fig-triangle}\n\n![](Images\\lab_7\\triangle.jpg){width=10cm, height=10cm}\n\nТрикутник Серпинського, області якого згенеровані з різними ймовірностями\n\n:::\n\nПрипустимо, що в методі випадкових ітерацій ми тепер із якоїсь причини віддали перевагу одній із вершин трикутника, наприклад, вершині А, і стали вибирати її з імовірністю 90%. Дві ж інші вершини В і С для нас рівноцінні, але на їхню частку тепер припадає всього лише по 5%. Результат такої несиметричної гри\" зображено нижче на рисунку вище. \n\nВидно, що точки всередині трикутника АВС розподілені тепер вкрай нерівномірно. Більша їх частина перебуває біля вершини А та її прообразів. Водночас у вершин В і С (і їхніх прообразів) їх є вкрай мало. Проте, за звичайною термінологією, ця множина точок (за умови прагнення числа ітерацій до нескінченності) є фракталом, тому що збереглася основна властивість фрактала --- самоподібність. Дійсно, трикутник DFC, хоча в ньому у 20 разів менше точок, за своїми статистичними і геометричними властивостями повністю подібний до великого трикутника АВС. Так само, як і у великому трикутнику, точки в ньому концентруються здебільшого поблизу вершини D --- аналогу вершини А.\n\n@fig-dist-serp більш детально демонструє результуючий розподіл точок по трикутнику Серпинського. Цифри в кожному з маленьких трикутників показують його відносну заселеність точками множини. \n\n::: {#fig-dist-serp}\n\n![](Images\\lab_7\\distribution_of_points.jpg){width=6cm, height=6cm}\n\nРозподіл точок по трикутнику Серпинського, представленого на попередньому рисунку\n\n:::\n\nОднак, не дивлячись на нерівномірність розподілу точок фрактала, фрактальна розмірність залишилась при цьому такою ж, $D=\\ln{3}/\\ln{2}$. Покриття цієї множини все меншими трикутниками можна здійснити по тому ж алгоритму, що й раніше. Таке співпадіння змушує замислитись над пошуком нових кількісних характеристик, котрі могли б відрізнити нерівномірний розподіл точок від рівномірного. \n\n\nІнший, складніший приклад неоднорідного фрактала, який ми б хотіли ще навести, показано на наступному рисунку. Ліворуч продемонстровано великий квадрат зі стороною, що дорівнює одиниці, який на цьому (нульовому) етапі повністю покриває собою деяку фрактальну множину точок $M$. На наступному (першому) етапі, у центрі рисунка, показано, як ту саму множину можна покрити трьома меншими квадратами зі сторонами $l_1=1/2, \\ l_2=l_3=5/16$, у яких, відповідно, міститься частка $p_1=1/2, \\ p_2=1/3$ та $p_3=1/6$ усіх точок.\n\n::: {#fig-dist-square}\n\n![](Images\\lab_7\\square_fractal.jpg){width=6.5cm, height=6.5cm}\n\nПриклад мультифрактала, що підкоряється ренормалізаційній схемі \n\n:::\n\nНаступний етап покриття (зображений на рисунку праворуч) містить уже 9 квадратів зі сторонами $l_{1}^{2}=1/4, \\ l_{1}l_{2}=l_{1}l_{3}=5/32$ (у нижньому правому куті) і $l_{2}l_{1}=5/32, \\ l_{2}^{2}=l_{2}l_{3}=25/256$ (угорі праворуч і ліворуч). Відносна заселеність цих квадратів точками множини показана на рисунку. Вона відповідає добутку чинників заселеності (імовірностей): $p_{1}^{2}=1/4, \\ p_{1}p_{2}=1/6, \\ p_{1}p_{3}=1/12$ --- для нижньої правої групи, $p_{2}p_{1}=1/6, \\ p_{2}^{2}=1/9, \\ p_{2}p_{3} = 1/18$ --- для верхньої лівої та $p_{3}p_{1}=1/12, \\ p_{3}p_{2}=1/18, \\ p_{3}^{2}=1/36$ --- для верхньої правої групи. Зазначимо, що є чітка відповідність між заселеністю квадрата $p_{j}p_{i}$ і його розмірами $l_{i}l_{i}$.\n\n\nПодальший процес розбиття і покриття множини $M$ здійснюється згідно із цією ренормалізаційною схемою. Кожен квадрат, що має на $n$-му кроці розмір $l$ і заселеність $р$, замінюється на $n+1$ кроці трьома квадратами з розмірами $ll_{1}, \\ ll_{2}, \\ ll_{3}$ і заселеностями $pp_{1}, \\ pp_{2}, \\ pp_{3}$ відповідно, розміщеними таким самим чином відносно один одного, як показано на @fig-dist-square.\n\nДвоє з розглянутих вище випадки являють собою приклади неоднорідних фракталів. Під словом \"неоднорідний\" ми тут розуміємо нерівномірний розподіл точок множини по фракталу або нерівномірний розподіл малих та великих флуктуацій у часовому ряді. Причина неоднорідності в попередніх випадках одна й та сама --- різні ймовірності заповнення геометрично однакових елементів фрактала, або в загальному випадку невідповідність імовірностей заповнення геометричним розмірам відповідних областей. Такі неоднорідні фрактальні об'єкти в літературі називають мультифракталами, і їх вивченням ми й займемося надалі.\n\n\n### Узагальнені фрактальні розмірності $D_{q}$\n\nДамо загальне визначення мультифрактала. Розглянемо фрактальний об'єкт, що займає якусь обмежену ділянку $\\Omega$ розміру $L$ у Евклідовому просторі з розмірністю $d$. Нехай на якомусь етапі його побудови він являє собою множину з $N \\gg 1$ точок, якось розподілених у цій області. Ми будемо припускати, що врешті-решт $N \\to \\infty$. Прикладом такої множини може слугувати трикутник Серпінського, побудований методом випадкових ітерацій. Кожен крок ітераційної процедури додає до цієї множини одну нову точку.\n\nРозіб'ємо всю область $\\Omega$ на кубічні клітинки зі стороною $\\varepsilon \\ll L$ та об'ємом $\\varepsilon^{d}$. Далі нас будуть цікавити тільки зайняті клітинки, у яких міститься хоча б одна точка. Нехай номер зайнятих комірок $i$ змінюється в межах $і=1, 2,..., N(\\varepsilon)$, де $N(\\varepsilon)$ --- сумарна кількість зайнятих клітинок, яка, звісно, залежить від розміру клітинки $\\varepsilon$.\n\nНехай $n_{i}(\\varepsilon)$ представляє собою кількість точок у клітинці з номером $i$, тоді величина $p_{i}(\\varepsilon) = \\lim_{N\\to\\infty}n_{i}(\\varepsilon)/{N}$ представляє собою ймовірність того, що навмання взята точка з нашої множини знаходиться в комірці $i$. Інакше кажучи, ймовірності $р_{i}$ характеризують відносну заселеність комірок. З умови нормування ймовірності випливає, що \n\n$$\n\\sum_{i=1}^{N(\\varepsilon)}p_{i}(\\varepsilon)=1.\n$$\n\n\nУведемо тепер у розгляд **узагальнену статистичну суму** $Z(q,\\varepsilon)$, що характеризується показником ступеня $q$, який може набувати будь-яких значень в інтервалі $-\\infty<q<+\\infty$\n\n$$\nZ(q,\\varepsilon)=\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon).\n$$\n\nСпектр **узагальнених фрактальних розмірностей** $D_{q}$, що характеризує даний розподіл точок в області $\\Omega$, визначається за допомогою співвідношення $D_{q} = \\tau(q)\\big/(q-1)$, де функція $\\tau(q)$ має вид \n\n$$\n\\tau(q)=\\lim_{\\varepsilon\\to 0} \\ln{Z(q,\\varepsilon)} \\big/ \\ln{\\varepsilon}.\n$$\n\n\nЯк ми покажемо нижче, якщо $D_{q}=D=\\text{const}$, тобто не залежить від $q$, то дана множина точок являє собою звичайний, регулярний фрактал, який характеризується лише однією величиною --- фрактальною розмірністю $D$. Навпаки, якщо функція $D_{q}$ якось змінюється з $q$, то розглянута множина точок представляє мультифрактал.\n\nТаким чином, мультифрактал у загальному випадку характеризується деякою **нелінійною** функцією $\\tau(q)$, що визначає поведінку статистичної суми $Z(q,\\varepsilon)$ при $\\varepsilon\\to 0$\n\n$$\nZ(q,\\varepsilon)=\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon) \\approx \\varepsilon^{\\tau(q)}.\n$$ {#eq-1}\n\n\nСлід мати на увазі, що в реальній ситуації ми завжди маємо скінченне, хоча й дуже велике число дискретних точок $N$, тому при комп'ютерному моделюванні конкретної множини граничний перехід $\\varepsilon\\to 0$ треба виконувати з обережністю, пам'ятаючи, що йому завжди передує ліміт $N \\to 0$.\n\nПокажемо тепер, як поводиться узагальнена статистична сума у випадку звичайного регулярного фрактала з фрактальною розмірністю $D$. У цьому випадку в усіх зайнятих комірках міститься однакова кількість точок, $n_{i}(\\varepsilon) = N \\big/ N(\\varepsilon)$, тобто фрактал представляється **однорідним**. Тоді очевидно, що відносні населеності клітинок, $p_{i}(\\varepsilon)=1/N(\\varepsilon)$, також однакові, і узагальнена статистична сума набуває вигляду \n\n$$\nZ(q,\\varepsilon) = N^{1-q}(\\varepsilon). \n$$ {#eq-2}\n\nВрахуємо тепер, що, згідно визначеню фрактальної розмірності $D$, кількість зайнятих клітинок при достатньо малому $\\varepsilon$ поводить себе наступним чином:\n\n$$\nN(\\varepsilon) \\approx \\varepsilon^{-D}.\n$$ {#eq-3}\n\nПідставляючи ([-@eq-3]) у ([-@eq-2]), і порівнюючи з ([-@eq-1]), отримуємо\n\n$$\n\\varepsilon^{\\tau(q)} = \\varepsilon^{-D(1-q)} \\to \\tau(q)=(q-1)D. \n$$ {#eq-4}\n\nМи приходимо до висновку, що у випадку звичайного фрактала функція ([-@eq-4]) є лінійною. Тоді всі $D_{q}$ дійсно не залежать від $q$. Фрактал у якого всі узагальнені фрактальні розмірності $D_{q}$ співпадають називається **монофракталом**.\n\nЯкщо розподіл точок по клітинкам неоднаковий, тоді фрактал називається неоднорідним, тобто представляє із себе мультифрактал, і для його характеристики необхідний цілий спектр узагальнених фрактальних розмірностей $D_{q}$, кількість котрих, у загальному випадку, нескінченна. \n\nТак, наприклад, при $q \\to +\\infty$ основний внесок в узагальнену статистичну суму ([-@eq-1]) вносять комірки, що містять найбільшу кількість частинок $n_{i}$ у них і, відповідно, що характеризуються найбільшою ймовірністю їх заповнення $p_{i}$. Навпаки, при $q \\to -\\infty$ основний внесок в узагальнену статистичну суму вносять найбільш розрідженні комірки з найменшою ймовірністю їх заповнення $p_{i}$. Таким чином, функція $D_{q}$ показує, наскільки неоднорідним представляється досліджувана множина точок $\\Omega$. \n\nУ подальшому для характеристики розподілу точок необхідно знати не тільки функцію $\\tau(q)$, але і її похідну:\n\n$$\n\\frac{d\\tau(q)}{dq} = \\lim_{\\varepsilon\\to 0} \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}\\ln{p_{i}} \\Bigg/ \\left( \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q} \\right)\\ln{\\varepsilon}.\n$$\n\nЦя похідна має важливий фізичний зміст, який буде продемонстровано пізніше. Зараз знову зазначимо, що для мультифрактальної системи вона не залишається константною і змінюється з $q$. \n\n### Функція мультифрактального спектра $f(\\alpha)$\n\n#### Спектр фрактальних розмірностей\n\nУ попередньому пункті ми ввели поняття мультифрактала --- об'єкта, що представляє собою неоднорідний фрактал. Для його опису ми ввели множину узагальнених фрактальних розмірностей $D_{q}$, де $q$ приймає будь-які значення в інтервалі $-\\infty<q<+\\infty$. Однак величини $D_{q}$ не є, строго кажучи, фрактальними розмірностями в загальному розумінні цього слова. \n\n\nТому часто поряд із ними для характеристики мультифрактальної множини використовують так звану **функцію мультифрактального спектра** $f(\\alpha)$ (спектр сингулярностей мультифрактала), до якої, як ми побачимо надалі, більше підходить термін фрактальна розмірність. Ми покажемо, що величина $f(\\alpha)$ фактично дорівнює хаусдорфовій розмірності якоїсь однорідної фрактальної підмножини із вихідної множини $\\Omega$, що дає домінантний внесок у статистичну суму при заданій величині $q$.\n\nОднією з основних характеристик мультифрактала є набір імовірностей $р_{i}$, що показують відносну заселеність клітинок $\\varepsilon$, якими ми покриваємо цю множину. Чим менший розмір клітинки, тим менша величина її заселеності. Для самоподібних множин залежність $p_{i}$ від розміру клітинки $\\varepsilon$ має степеневий характер:\n\n$$\np_{i}(\\varepsilon) \\approx \\varepsilon^{\\alpha_{i}}, \n$$\n\nде $\\alpha_{i}$ являє собою деякий показник ступеня (різний для різнок клітинок $i$). \n\n\n\n::: {.callout-tip}\n## Додатково по $\\alpha$\n\nСпрямовуючи значення $\\varepsilon$ до нуля, фрактальність можна розглядати локально для кожної точки (елемента) досліджуваної системи, і таким чином показник $\\alpha$ є локальною фрактальною розмірністю. Його ще називають *показником Гьолдера* або *силою сингулярності*\n\nМожемо спостерігати саме степеневу залежність, оскільки, вочевидь, розподіл маси (флуктуацій) концентрується з різною \"силою\" $\\alpha$, тож і ймовірнісна міра змінюється пропорційно розмірам вікон $\\varepsilon$\n\n:::\n\n::: {#fig-alpha-dependence}\n\n![](Images\\lab_7\\alpha.jpg){width=8cm, height=8cm}\n\nСхематичне представлення залежності сили сингулярності та густини порівняно з околицями \n\n:::\n\nСірий масштаб являє собою ймовірнісну міру для кожної локації, як показано на кожній панелі. На рисунку (a) тільки $i$-та локація має ненульову щільність, інші місця порожні. Імовірнісна міра на комірці залишається $\\rho$, навіть коли розмір клітинки $\\varepsilon$ збільшується. $\\varepsilon$ збільшується, що підкреслюється жирною лінією. Проте, через те, що далі ми не спостерігаємо зростання щільності, показник $\\alpha$ залишається нульовим. На [@fig-alpha-dependence] (b) усі комірки мають однакову щільність. Імовірнісні міри комірок дорівнюють $\\rho$, $9\\rho$ і $25\\rho$ для найменшої, другої найменшої та найбільшої комірки (виділено жирною лінією). Таким чином, сила сингулярності $i$-го осередку дорівнює 2. На [@fig-alpha-dependence] (c) $i$-й осередок є розрідженим порівняно з навколишніми осередками. Імовірнісна міра осередків дорівнює $\\rho$, $27\\rho$ і $125\\rho$ для найменшого, другого найменшого і найбільшого осередку (виділено жирною лінією). Таким чином, сила сингулярності $i$-ої комірки дорівнює 3.\n\n::: {.callout-tip}\n## Додатково по $\\alpha$\n\nМожна сказати, що чим більш гладкою видається поверхня системи, чим менше елементів задіяно в її розвитку, тим меншим є показник сингулярності. Що більше елементів системи вступають у взаємозв'язок один з одним, що більше процесів протікає під час еволюції системи, то більшим є показник сингулярності\n\n:::\n\n\nВідомо, що для регулярного (однорідного) фрактала всі показники ступеня $\\alpha_{i}$ однакові й рівні фрактальній розмірності $D$:\n\n$$\np_{i} = 1 \\big/ N(\\varepsilon) \\approx \\varepsilon^{D}.\n$$\n\nУ даному випадку статистична сума [@eq-1] приймає наступний вигляд:\n\n$$\nZ(q,\\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon) = N(\\varepsilon)\\varepsilon^{Dq}=\\varepsilon^{-D}\\varepsilon^{Dq} \\approx \\varepsilon^{D(q-1)}. \n$$\n\nТому $\\tau(q)=D(q-1)$ і всі узагальнені фрактальні розмірності $D_{q}=D$ у цьому випадку співпадають та не залежать від $q$. \n\nОднак, для такого складного об'єкта, як мультифрактал, унаслідок його неоднорідності, ймовірності заповнення клітинок $p_{i}$ у загальному випадку різняться, і показник ступеня $\\alpha_{i}$ для різних клітинок може приймати різні значення. Достатньо типовою є ситуація, коли ці значення неперервно заповнюють деякий закритий інтервал $\\left( \\alpha_{min}, \\alpha_{max} \\right)$, причому $p_{min} \\approx \\varepsilon^{\\alpha_{max}}$, a $p_{max} \\approx \\varepsilon^{\\alpha_{min}}$.\n\nТепер перейдемо до питання розподілу ймовірностей різних значень $\\alpha_{i}$. Нехай $n(\\alpha)d\\alpha$ є ймовірністю того, що $\\alpha_{i}$ знаходиться в інтервалі від $\\alpha$ до $\\alpha+d\\alpha$. Іншими словами, $n(\\alpha)d\\alpha$ представляє собою відносну кількість клітинок $i$, що характеризуються однією і тією самою мірою $p_{i}$ з $\\alpha_{i}$, що лежать у цьому інтервалі. У випадку монофрактала, для котрого всі $\\alpha_{i}$ однакові (і рівні фрактальній розмірності $D$), це число, очевидно, пропорційно повній кількості клітинок $N(\\varepsilon) \\approx \\varepsilon^{-D}$, степеневим чином залежних від розміру клітинки $\\varepsilon$. Показник степеня в цьому співвідношені визначається фрактальною розмірністю множини $D$. \n\nДля мультифрактала, однак, це не так, і різні значення $\\alpha_{i}$ зустрічаються з ймовірністю, що характеризується не однією і тією ж величиною $D$, а різними (в залежності від $\\alpha$) значеннями показниками степеня $f(\\alpha)$, \n\n$$\nn(\\alpha) \\approx \\varepsilon^{-f(\\alpha)}.\n$$ {#eq-5}\n\nТаким чином, фізичний сенс функції $f(\\alpha)$ полягає в тому, що вона представляє собою розмірність Хаусдорфа деякої однорідної підмножини $\\Omega_{\\alpha}$ із вихідної множини $\\Omega$, що характеризується однаковими ймовірностями заповнення клітинок $p_{i} \\approx \\varepsilon^{\\alpha}$. Оскільки фрактальна розмірність підмножини очевидно завжди менша або рівна фрактальній розмірності вихідної множини $D_{0}$, має місце важлива нерівність для функції $f(\\alpha)$:\n\n$$\nf(\\alpha) \\leq D_{0}. \n$$\n\nУ результаті можна зробити висновок, що множина різних значень функції $f(\\alpha)$ (при різних $\\alpha$) представляє собою **спектр фрактальних розмірностей** [@PhysRevA.33.1141;@frisch1985turbulence] однорідних підмножин $\\Omega_{\\alpha}$, на які можна розбити вихідну множину $\\Omega$, кожна з яких характеризується власним значенням фрактальної розмірності $f(\\alpha)$. \n\n\n#### Перетворення Лежандра\n\nВстановимо зв'язок функції $f(\\alpha)$ із введенною раніше функцією $\\tau(q)$. Обчислимо для цього статистичну суму $Z(q,\\varepsilon)$. Підставляючи у $Z(q,\\varepsilon)$ ймовірності $p_i \\approx \\varepsilon^{\\alpha_i}$, та переходячи від підсумовування по $i$ до інтегрування по $\\alpha$ з щільністю ймовірностей ([-@eq-5]), отримаємо\n\n$$\nZ(q,\\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)} p_{i}^{q}(\\varepsilon) \\approx \\int d\\alpha n(\\alpha)\\varepsilon^{q\\alpha} \\approx \\int d\\alpha\\varepsilon^{q\\alpha-f(\\alpha)}. \n$$ {#eq-6}\n\nТак як величина $\\varepsilon$ дуже мала, основний внесок у цей інтеграл вноситимуть ті значення $\\alpha(q)$, при яких показник степеня $q\\alpha-f(\\alpha)$ виявляється мінімальним (а підінтегральна функція --- максимальною). Цей вклад буде пропорційним значенню підінтегральної функції у точці максимума. Саме ж значення $\\alpha(q)$ визначається при цьому з наступної умови:\n\n$$\n\\left. \\frac{d}{d\\alpha}[ q\\alpha-f(\\alpha) ] \\right \\vert_{\\alpha=\\alpha(q)} = 0. \n$$\n\nТакож, з умови мінімуму ми маємо\n\n$$\n\\left. \\frac{d^{2}}{d\\alpha^{2}}[ q\\alpha-f(\\alpha) ] \\right \\vert_{\\alpha=\\alpha(q)} > 0. \n$$\n\nУ результаті отримуємо, що залежність $\\alpha(q)$ неявним чином визначається з $q = df(\\alpha) \\big/ d\\alpha$, і що функція $f(\\alpha)$ усюди є випуклою:\n\n$$\nf^{''}(\\alpha)>0.\n$$\n\nЦе значить, що величина $f(\\alpha(q))$ дійсно є фрактальною розмірністю підмножини $\\Omega_{\\alpha(q)}$, що має найбільший домінуючий внесок у статистичну суму ([-@eq-6]) при заданій величині показника ступеня $q$. \n\nОскільки $Z(q,\\varepsilon)=\\tau(q)$, приходимо до висновку, що \n\n$$\n\\tau(q) = q\\alpha(q) - f(\\alpha(q)). \n$$ {#eq-7}\n\nПам'ятаючи, що $\\tau(q)=D(q-1)$, можемо віднайти функцію $D_{q}$: \n\n$$\nD_{q} = \\frac{1}{q-1}[ q\\alpha(q)-f(\\alpha(q)) ]. \n$$ {#eq-8}\n\nТаким чином, якщо ми знаємо функцію мультифрактального спектра $f(\\alpha)$, то за домомогою співвідношень ([-@eq-8]) та ([-@eq-9]) ми можемо знайти функцію $D_{q}$. Навпаки, знаючи $D_{q}$, ми можемо відтворити залежність $\\alpha(q)$ за допомогою рівняння\n\n$$\n\\alpha(q) = \\frac{d}{dq}[(q-1)D_{q}]\n$$ {#eq-9}\n\nі після цього знайти із ([-@eq-9]) $f(\\alpha(q))$. Ці два рівняння і визначають функцію $f(\\alpha)$. \n\n$$\n\\frac{d\\tau}{dq}\\frac{dq}{d\\alpha} = q + \\alpha\\frac{dq}{d\\alpha} - \\frac{df}{d\\alpha}.\n$$\n\nПриймаючи до уваги, що $q=df/d\\alpha$, і скорочуючи це рівняння на $dq/d\\alpha$, приходимо до співвідношення \n\n$$\n\\alpha = \\frac{d\\tau(q)}{dq},\n$$\n\nяке еквівалентне ([-@eq-9]). \n\nВирази для $\\tau(q)$ та $\\alpha(q)$ задають **перетворення Лежандра** [@GRASSBERGER1983227;@HALSEY1987501] від змінних $\\{ q, \\tau(q) \\}$ до змінних $\\{\\alpha, f(\\alpha)\\}$: $\\alpha = d\\tau \\big/ dq$ та $f(\\alpha) = q\\left( d\\tau \\big/ dq \\right) - \\tau(q)$. Як відомо, для однорідного фрактала $D_{q}=D=\\text{const}$. Тому $\\alpha=d\\tau/dq=D$ і $f(\\alpha)=q\\alpha-\\tau(q)=qD-D(q-1)=D$. У цьому випадку \"графік\" функції $f(\\alpha)$ на площині $\\left( \\alpha, f(\\alpha) \\right)$ складається лише з однієї точки  $\\left( D, D \\right)$. \n\n### Мультифрактальний аналіз детрендованих флуктуацій\n\nМонофрактальні та мультифрактальні структури фінансових сигналів є особливим різновидом масштабно-інваріантних структур. Найчастіше монофрактальна структура фінансових часових рядів визначається одним степеневим показником і передбачає, що масштабо-інваріантність не залежить від часу і простору. Однак, часто ми маємо змогу спостерігати просторово-часову варіацію масштабно-інваріантної структури досліджуваної складної системи. Ці просторово-часові варіації вказують на мультифрактальність фінансового сигналу, яка визначається мультифрактальним спектром. Мультифрактальний спектр може допомогти кількісно визначити асиметрію підйомів та спадів на фондовому чи криптовалютному ринках, передбачити фінансову кризу, що поступово наближується, і, таким чином, сприяти успішності подальших торгівельних рішень. Основна мета цього розділу --- представити одну з найточніших процедур для визначення множини фрактальних показників --- **мультифрактальний аналіз детрендованих флуктуацій** (multifractal detrended fluctuation analysis, MFDFA) [@KANTELHARDT2001441;@Kantelhardt2011;@KANTELHARDT200287], котрий і досі залишається одним із найпотужніших методів для аналізу систем різної природи та складності [@Dutta_2010; @MAIORINO2015302; @FIGUEIREDO20102090; @Jafari_2012; @Jiang_2019; @Telesca_2005; @doi:10.1080/00045608.2011.592733; @Liao_2011; @TELESCA2005629; @PhysRevE.84.021103; @MALI201525; @Pedron_2010; @Rak_2015; @WATOREK20211].\n\nПобудова MFDFA складається з 9 кроків:\n\n1. *\"Шум і випадкові блукання у часовому ряді\"* представляє метод приведення часового ряду до такого, що подібний до випадкового блукання. \n2. *\"Обчислення середньоквадратичної варіації часового ряду\"* представляє середньоквадратичну варіацію, яка є основною процедурою для подальших обчислень в MFDFA і типовим способом обчислення середньої варіації часових рядів різної природи. \n3. *\"Локальна середньоквадратична варіація часового ряду\"* представляє обчислення локальної варіації часового ряду як середньоквадратичного відхилення часового ряду в межах сегментів, що можуть як перекриватися, так і не перекриватися. \n4. *\"Локальне детрендування часового ряду\"* представляє обчислення такого ж локального середньоквадратичного відхилення навколо трендів, які часто зустрічаються у фінансових часових рядах. \n5. *\"Монофрактальний аналіз детрендованих флуктуацій\"*: амплітуди локальних середніх квадратичних відхилень підсумовуються в узагальнене середнє квадратичне відхилення. У сумарному середньоквадратичному відхиленні для сегментів з малими розмірами вибірки переважають швидкі флуктуації часового ряду. На противагу цьому, у сумарному середньоквадратичному відхиленні для сегментів з великими розмірами вибірки переважають повільні коливання. Степенева залежність між загальним середнім квадратичним відхиленням для декількох розмірів вибірки (тобто масштабів) визначається за допомогою монофрактального аналізу дентрендованих флуктуацій (monofractal detrended fluctuation analysis, DFA) і називається показником Херста (Hurst exponent, $H$). \n6. *\"Мультифрактальний аналіз детрендованих флуктуацій\"*: MFDFA отримують шляхом розширення на $q$-й порядок узагальненого середньоквадратичного відхилення. Середньоквадратичне відхилення $q$-го порядку може розрізняти сегменти з малими та великими флуктуаціями. Степенева залежність між середньоквадратичним відхиленням $q$-го порядку чисельно визначається як узагальнейний показник Херста $q$-го порядку. \n7. *\"Мультифрактальний спектр часових рядів\"*: на основі показника Херста $q$-го порядку обчислено декілька мультифрактальних спектрів. \n8. *\"Узагальнені фрактальні розмірності\"* представляє більш детальний опис показників $D_{q}$, що будуть описані в подальшому.\n9. *\"Аналогії мультифракталів із термодинамікою\"* показує, що отримані кількісні мультифрактальні показники мають зв'язок із термодинамічними показниками, що дозволило нам вивести мультифрактальну \"теплоємність\". \n\nДля подальшої візуалізації кожного кроку процедури MFDFA імпортуємо наступні модулі:\n\nІ виконаємо налаштування рисунків для виведення:\n\nЦього разу розглянему можливість побудови індикаторів або індикаторів-передвісників на прикладі індексу сирої нафти West Texas Intermediate (WTI). При описі процедури MFDFA порівнюватимемо мультифрактальність даного ряду зі штучно згенерованими монофрактальними рядами, складність яких, очевидно, має бути меншою.\n\nСам сайт Yahoo! Finance містить досить коротку історію щодених цін на нафту даної марки. Цього разу, в якості альтернативного прикладу, будемо послуговуватись альтернативним джерелом фінансових даних --- [федеральним резервом економічних даних федерального резервного банку Сент-Луїса](https://fred.stlouisfed.org) (Federal Reserve Economic Data of the Federal Reserve Bank of St. Louis, FRED). На Python було створено бібліотеку для вивантаження даних із даного джерела --- `pandas-datareader`. Для її встановлення достатньо прописати наступну команду:\n\nТепер імпортуємо відповідну бібліотеку:\n\nта виконаємо зчитування індексу з FRED, використовуючи функціонал даної бібліотеки. Завантажимо дані за весь період, що нам буде доступний:\n\nВиведемо досліджуваний ряд:\n\nРозглянемо опис нашого масиву даних:\n\nНа представленому рисунку видно, що в значеннях досліджуваного індексу існують пропуски та негативні значення на ціну нафти. Для того, щоб позбутися від'ємного значення, можна виконати заміну значення на таке, що близьке до нуля. Для видалення значень `NaN` достатньо скористатися методом `dropna()` бібліотеки `pandas`.\n\nЗнову візуалізуємо результат:\n\nОстаннє, що нам залишається, це приведення вихідного ряду до прибутковостей. Для цього визначимо функцію `transformation()` та знайдемо з її допомогою прибутковості: \n\nЯк вже зазначалося, при описі процедури MFDFA, ми будемо послуговуватись для порівняння і монофрактальними сигналами. Для подальших розрахунків згенеруємо сигнал білого та рожевого шумів. У цьому нам може допомогти функція `signal_noise()` бібліотеки `neurokit2`. Ця функція генерує чистий гаусовий `(1/f)**beta` шум. Спектр потужності згенерованого шуму пропорційний `S(f) = (1/f)**beta`. Було описано наступні категорії шуму: \n\n- фіолетовий шум: beta = -2;\n- синій шум: beta = -1;\n- білий шум: beta = 0;\n- флікер/рожевий шум: beta = 1;\n- коричневий шум: beta = 2.\n\nЇї синтаксис:\n\n**`signal_noise(duration=10, sampling_rate=1000, beta=1, random_state=None)`**\n\n**Параметри:**\n\n- **duration** (*float*) --- бажана тривалість (у секундах);\n- **sampling_rate** (*int*) --- бажана частота дискретизації (у Гц, тобто відліків на секунду);\n- **beta** (*float*) --- експонента шуму;\n- **random_state** (*None, int, numpy.random.RandomState або numpy.random.Generator*) --- початкове значення (зерно) для генератора випадкових чисел.\n\n**Повертає:**\n\n- **noise** (*array*) --- сигнал чистого шуму.\n\nТепер можемо згенерувати 2 види шумів:\n\n#### Шум і випадкові блукання у часовому ряді\n\nМультифрактальний аналіз детрендованих флуктуацій базується на класичному аналізі детрендованих флуктуацій (DFA). Класичний DFA застосовується до часових рядів зі структурою, подібною до випадкових блукань [@Peng_1995]. Однак більшість фінансових часових рядів мають коливання, які більш схожі на прирости випадкових блукань. Якщо фінансовий часовий ряд має структуру, подібну до шуму, як у прибутковостей, його слід перетворити на випадково-блукаючий часовий ряд перед застосуванням DFA. Шуми можна перетворити на випадкові блукання шляхом віднімання середнього значення та інтегрування часового ряду (знаходження його кумулятивної суми). Часовий ряд з білим шумом, монофрактал (рожевий шум) і мультифрактал є шумовими часовими рядами і перетворюються на випадкові блукання за допомогою коду, наведеного на [-@fig-step-1]:\n\n#### Обчислення середньоквадратичної варіації часового ряду \n\nТрадиційний аналіз варіації часових рядів полягає в обчисленні середнього значення варіації як середньоквадратичного відхилення. Читач може скористатися наведеним нижче кодом для обчислення середньоквадратичного відхилення для часових рядів з білим шумом, монофрактальних і мультифрактальних даних:\n\n@fig-step-2 ілюструє, що середня амплітуда варіації (тобто середньоквадратичне відхилення) є однаковою для всіх трьох часових рядів, навіть якщо вони мають досить різну структуру. MFDFA може розрізняти ці структури.\n\n#### Локальна середньоквадратична варіація часового ряду\n\nМультифрактальні часові ряди на верхній панелі мають локальні флуктуації різної величини. Середньоквадратичне відхилення (RMS) у попередньому коді можна обчислити для сегментів часового ряду, щоб розрізнити величини локальних флуктуацій. Проста процедура полягає в тому, щоб розділити часовий ряд на однакові за розміром сегменти, що не перекриваються, і обчислити локальне середнє квадратичне відхилення для кожного сегмента. Це можна зробити за допомогою коду наведеного нижче:\n\nПерший рядок коду функції `calc_rms()` перетворює зашумлений часовий ряд, мультифрактал, на часовий ряд випадкового блукання $X$. Третій рядок коду задає масштаб параметра, який визначає розмір вибірки сегментів, що не перетинаються, для яких обчислюється локальне середнє квадратичне відхилення, `RMS`. П'ятий рядок --- це кількість сегментів, на які можна розбити часовий ряд $X$, де `len(X)` --- розмір вибірки часового ряду $X$. Таким чином, `segments = 6` при `len(X) = 9335` і `scale = 1335`. З дев'ятого по шістнадцятий рядки --- це цикл, що обчислює локальне середньоквадратичне значення навколо тренду `fit[v]` для кожного сегмента, оновлюючи часовий індекс. У першому циклі `v = 0`, `Index[0]` переходить від 0 до 1335 значення сегмента (не включно). У другому циклі $v = 1$, `Index[1]` переходить від 1335 до 2670 значення другого сегмента. В останньому циклі $v = 6$, `Index[6]` переходить від 8010-го до 9345-го значення (не включно).\n\n#### Локальне детрендування часового ряду\n\nУ складних системах наявні повільні мінливі тренди, тому для кількісної оцінки масштабо-інваріантності флуктуацій навколо цих трендів необхідно провести детрендування сигналу. У попередньому коді до $X$ на кожному сегменті $v$ підбирається поліноміальний тренд `fit[v]`. Параметр $m$ визначає порядок полінома. Поліноміальний тренд є лінійним, якщо $m = 1$, квадратичним, якщо $m = 2$, і кубічним, якщо $m = 3$. Рядок `C = np.polyfit(Index[v], X[Index[v]], m)` визначає коефіцієнти полінома `C`, які використовуються для створення поліноміальної залежності тренду `fit[v]` для кожного сегмента. Потім для залишкової варіації, `X(Index[v])-fit[v]`, обчислюється локальне середньоквадратичне відхилення, `RMS[v]`, в межах кожного сегмента $v$. Локальна середньоквадратична варіація, `RMS[v]`, представлена на [@fig-step-3] як відстань між червоними пунктирними трендами і червоними суцільними лініями.\n\n#### Монофрактальний аналіз детрендованих флуктуацій\n\nУ DFA варіації локального середньоквадратичного відхилення кількісно оцінюються загальним середньоквадратичним відхиленням ($F$).\n\nШвидкі коливання часового ряду $X$ впливатимуть на загальне середньоквадратичне відхилення $F$ у сегментах малої довжини (масштабу), тоді як повільні коливання впливатимуть на $F$ у сегментах великої довжини (масштабу). Таким чином, функція флуктуацій $F$ повинна бути обчислена для декількох масштабів, щоб виокремити вплив як швидкоплинних, так і повільних коливань, які у свою чергу визначають структурні перетворення часового ряду. Функція флуктуацій $F(ns)$ може бути обчислена для декількох масштабів шляхом модифікації попереднього коду:\n\nDFA визначає монофрактальну структуру часового ряду відповідно до степеневої залежність між загальним середнім квадратичним відхиленням (тобто $F$), обчисленим для декількох масштабів. Степенева залежність між загальним середнім квадратичним відхиленням позначається нахилом ($H$) лінії регресії, розрахованим за допомогою наступного коду:\n\nМодифікуємо попередній код, додавши нові фрагменти:\n\nТепер розглянемо залежність загальної функції флуктуацій $F$ від різних довжин (масштабів) локальних сегментів ряду для досліджуваних нами рядів:\n\nПоказник Херста визначає монофрактальну структуру часового ряду, вказуючи, наскільки швидко зростає загальне середньоквадратичне відхилення $F$ локальних коливань `RMS` зі збільшенням розміру локальних сегментів ряду (тобто, масштабу). [@fig-step-6] показує, що загальне середньоквадратичне значення локальних флуктуацій $F$ у порівнянні з індексом нафти та білим шумом зростає швидше зі збільшенням розміру вибірки сегментів для монофрактального рожевого шуму. [@fig-hurst] ілюструє, що показник Херста визначає континуум між часовими рядами, подібними до шуму, і часовими рядами, подібними до випадкового блукання. Показник Херста знаходиться в інтервалі від 0 до 1 для зашумлений часових рядів, тоді як для часових рядів, подібних до випадкових блукань, він перевищує 1. Часовий ряд має довгострокову залежну (тобто корельовану) структуру, коли показник Херста знаходиться в інтервалі 0.5-1, і антикорельовану структуру, коли показник Херста знаходиться в інтервалі 0-0.5. Часовий ряд має незалежну або короткострокову залежну структуру в окремому випадку, коли показник Херста дорівнює 0.5. Згідно з попереднім рисунком, часові ряди білого шуму та нафти представляються непередбачуваними, оскільки показник Херста близький до 0.5, тоді як рожевий шум довгостроково залежну структуру з показником Херста близьким до 1.\n\n#### Мультифрактальний аналіз детрендованих флуктуацій\n\nСтруктури монофрактального та мультифрактального часових рядів відрізняється, хоча вони мають схожі загальні середньоквадратичні значення. Мультифрактальні часові ряди містять локальні флуктуації як з екстремально малими, так і з екстремально великими значеннями, що не характерно для монофрактальних часових рядів. Відсутність флуктуацій з екстремально великими та малими значеннями призводить до нормального розподілу для монофрактального часового ряду, де варіація описується лише статистичним моментом другого порядку (дисперсією). Отже, монофрактальний DFA базується на статистиці другого порядку загального середньоквадратичного відхилення (тобто, $F\\,$). У мультифрактальному часовому ряді локальні коливання, `RMS[ns][v]`, будуть екстремально великими для сегментів $v$ в межах часових періодів великих коливань і екстремально малими для сегментів $v$ в межах часових періодів малих коливань. Отже, мультифрактальні часові ряди не є нормально розподіленими і слід враховувати всі статистичні моменти $q$-го порядку. Таким чином, необхідно розширити загальне середньоквадратичне значення монофрактального DFA до середньоквадратичної функції флуктуацій $q$-го порядку мультифрактального DFA $(F_{q})$:\n\nУ новому блоці коду запускається цикл, який обчислює загальне середньоквадратичне значення $q$-порядку $F_{q}(nq)$ від від'ємних до додатних $q$. Порядок $q$ зважує вплив сегментів ряду з великими та малими коливаннями, `RMS`, як показано на наступному рисунку. На величину $F_{q}(nq)$ для від'ємних $q$ впливають сегменти $v$ з малими `RMS(v)`. Навпаки, на $F_{q}(nq)$ для додатних $q$ впливають відрізки $v$ з великими `RMS(v)`. Локальні флуктуації `RMS` з великими та малими величинами класифікуються за величиною від'ємного або додатного порядку $q$ відповідно. На $F_{q}$ для $q = -3$ і $3$ більше впливають відрізки $v$ з найменшим і найбільшим `RMS(v)`, відповідно, порівняно з $F_{q}$ для $q = -1$ і $1$. Середня точка $q = 0$ є нейтральною щодо впливу відрізків з малим та великим `RMS`. Зверніть увагу, що в останньому рядку коду нового блоку перевизначено окремий випадок $q(nq) = 0$, оскільки $1/0$ прямує до нескінченності (тобто, $1/q(q = 0) = \\infty$). Читач також повинен помітити, що $F_{q}[q == 2]$ дорівнює статистиці другого порядку $F$, оскільки $\\sqrt{x} = x^{1/2}$. Монофрактальний DFA тепер розширюється до MFDFA.\n\n`qRMS` на [@fig-step-7] --- це $q$-порядок локальних флуктуацій (тобто, `RMS`) і є складовою частиною загального$q$-порядку `RMS` (тобто, $F_{q}$). `qRMS` представлено для монофрактального (зелена смуга) та мультифрактальних (синя смуга) часових рядів. Від'ємний порядок $q$ ($q = -3$ і $-1$) підсилює сегменти в мультифрактальному часовому ряді з екстремально малими `RMS`, тоді як додатний порядок $q$ ($q = 3$ і $1$) підсилює відрізки з екстремально великими `RMS`. Зверніть увагу, що $q = -3$ і $q = 3$ підсилюють малу і велику варіацію відповідно більше, ніж $q = -1$ і $q = 1$. Зауважте також, що монофрактальний часовий ряд не має відрізків з екстремально великими або малими коливаннями і, таким чином, не має піків у `qRMS`. Загальне середньоквадратичне відхилення $q$-го порядку здатне розрізняти структуру малих і великих флуктуацій і, відповідно, монофрактальних і мультифрактальних часових рядів. \n\nТепер можна визначити показники Херста $q$-го порядку як нахили $h(q)$ ліній регресії для кожного середньоквадратичного значення $F_{q}$ $q$-го порядку. І $h(q)$, і лінія регресії визначаються в циклі для кожного $q$-го порядку:\n\nМожемо бачити, що узагальнена функція флуктуацій для мультифракталу залежить не лише від масштабу, але й від $q$, що демонструють різні нахили ліній регресії $h(q)$. Масштабуючі узагальнені функції флуктуацій $F_{q}$ для монофракталу та білого шуму є $q$-незалежними, оскільки їх лінії регресії для різних масштабів мають один і той самий кут нахилу. Показник Херста $q$-го порядку $h(q)$ для мультифрактального ряду (синя лінія) представляється незалежним для $q<0$ і змінним для $q>0$. Це вказує на те, що джерелом мультифрактальності нафти є аномально великі флуктуацій як, наприклад, криза коронавірусної пандемії. Для монофракталу (рожева лінія) та білого шуму (червона лінія) $h(q)$ залишаються сталими. \n\n#### Мультифрактальний спектр часових рядів\n\nПоказник Херста $q$-го порядку $h(q)$ є лише одним з декількох типів масштабних показників, що використовуються для параметризації мультифрактальної структури часових рядів. Як уже було представлено попередньо, ми можемо вивести показник маси $q$-го порядку ($\\tau(q)$), а потім через $\\tau(q)$ отримати показник сингулярності $q$-го порядку ($\\alpha(q)$) і фрактальну розмірність ($f(\\alpha)$) флуктуацій (областей) із ступенем сингулярності $\\alpha(q)$. Графік залежності $\\alpha(q)$ від $f(\\alpha)$ представляє мультифрактальний спектр. Показники маси, сингулярності та фрактальності можна обчислити згідно коду, що наведений нижче:\n\nПоказники сингулярності $\\alpha$ для великих висококонцентрованих флуктуацій малі й розташовані в лівому хвості спектра, тоді як $\\alpha$ для малих флуктуацій великі й розташовані в правому хвості спектра.\n\nТаким чином, сила мультифрактальності описується великим відхиленням експоненти локальної сингулярності $\\alpha$ від центральної тенденції $\\alpha(0)$. Монофрактальний сигнал --- це випадок, коли $\\alpha$ залишається майже константною, і в деяких випадках мультифрактальний спектр зводиться до однієї точки за даною $\\alpha$. \n\nДіапазон $\\alpha$ вказує на різноманітність експонент сингулярності, що описують динаміку системи, а величина $f(\\alpha)$ вказує на величину внеску елементів із відповідним показником $\\alpha$.\n\nМультифрактальний спектр може характеризуватися різною шириною, що вказує на варіативність процесів, що відбуваються всередині системи. Так само він може бути як симетричним, так і асиметричним. Асиметрія буває як правосторонньою, так і лівосторонньою, що вказує на різний ступінь впливу висококонцентрованих і низькоконцентрованих елементів (флуктуацій). Мультифрактальний спектр матиме довгий лівий хвіст, коли часовий ряд має мультифрактальну структуру, чутливу до локальних флуктуацій з великими амплітудами. \n\nНавпаки, мультифрактальний спектр матиме довгий правий хвіст, коли він чутливий до локальних флуктуацій з малими амплітудами.\n\nПроілюструємо залежність ширини спектра мультифрактальності від рівня флуктуацій у ряді. Дану залежність будемо демонструвати на прикладі рядів, що розподілятимуться згідно [альфа-стабільному розподілу Леві](https://en.wikipedia.org/wiki/Stable_distribution), який ми ще розглядатимемо в наступних роботах. Для генерації випадкових величин із даного розподілу, використовуватимемо модуль `scipy.stats`. З нього імпортуємо клас `levy_stable` для використання методу `rvs()`. Метод приймає показник $\\alpha$, що відповідає за частоту виникнення подій, що виходять за межі нормального розподілу. Розглянемо діапазон таких значень $\\alpha$ та спектри згенерованих рядів. \n\nСистема, складність якої зумовлена висококонцентрованими елементами, матиме чітко виражений лівосторонній спектр. Складність системи, що зумовлена слабко концентрованими елементами, характеризує правий хвіст мультифрактального спектра. Якщо складність системи розвивається за рахунок елементів двох типів, тоді спектр представлятиметься симетричним, де  елементи двох типів будуть рівноймовірними. Для згенерованих вище Леві альфа-стабільних процесів видно, що чим нижче значення $\\alpha$, тим сильніша домінація висококонцентрованих (великих) флуктуацій.  При $\\alpha=2.0$ спектр усе сильніше звужується до сингулярної точки. \n\nДалі буде показано, що для отриманої мультифрактальної параболи мультифрактального спектра можуть бути розраховані показники як всієї ширини спектра $(\\Delta\\alpha)$, так і окремо його правого та лівого хвостів ($R$ та $L$). Також можна розрахувати значення сингулярності, де $f(\\alpha)$ приймає максимальне значення $\\alpha_0$, і навіть так звану \"асиметрію\" цього спектра $(\\Delta f)$. На [@fig-alpha-indicators] схематично представлено положення ключових індикаторів мультифрактальності спектра. \n\n::: {#fig-alpha-indicators}\n\n![](Images\\lab_7\\f_alpha.jpg)\n\nГрафік мультифрактального спектра із відміченними на ньому показниками ширини спектра мультифрактальності ($\\Delta\\alpha$), значень мінімальної, центральної та максимальної сингулярності ($\\alpha_{min}, \\alpha_0, \\alpha_{max}$), ширини лівого та правого хвостів спектра ($L, R$) та різниці між фрактальними розмірностями в кінцях параболи ($\\Delta f$)\n\n:::\n\nТакож варто зазначити, що дана схема не представляє вичерпний список індикаторів мультифрактальності системи, що ми використовуватимемо в подальшому, але має надавати інтуїтивне розуміння того, як виводиться більшість мультифрактальних показників. \n\n#### Узагальнені фрактальні розмірності\n\nНаряду з мультифрактальним спектром корисно буде розглянути спектр узагальнених фрактальних розмірностей або по іншому, *розмірностей Реньї*, оскільки вони також мають інформаційно-теоретичне значення. З'ясуємо фізичний сенс узагальнених фрактальних розмірностей для деяких значень $q$. При $q=0$, $Z(0, \\varepsilon) = N(\\varepsilon)$. З іншого боку, можна визначити, що $Z(0, \\varepsilon) \\approx \\varepsilon^{\\tau(0)} = \\varepsilon^{-D_{0}}$. Співставляючи зазначені рівності, можемо прийти до співвідношення $N(\\varepsilon) \\approx \\varepsilon^{-D_{0}}$. Отже, величина $D_{0}$ представляє собою звичайну хаусдорфову розмірність множини $\\Omega$. Також вона відповідає максимуму мультифрактального спектра, $f(\\alpha)$, що завжди дорівнює одиниці для одновимірного сигналу. Для задач розпізнавання кризових явищ ця характеристика є найгрубішою і не несе інформації про статистичні властивості системи. \n\nТепер з'ясуємо сенс величини $D_{1}$. Оскільки при $q=1$ статистична сума $Z(1, \\varepsilon) = 1$, то $\\tau(1)=0$. Таким чином, ми маємо невизначеність, коли $D_{1}=\\tau(1)/(1-1)$. Розкриємо цю невизначеність за допомогою наступної рівності:\n\n$$\nZ(q, \\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)} p_{i}^{q} = \\sum_{i=1}^{N(\\varepsilon)} p_{i}\\exp{[(q-1)\\ln{p_{i}}]}. \n$$\n\nТепер, спрямовуючи $q \\to 1$, розкладаючи експоненту і враховуючи умову нормування ймовірностей $p_{i}$, отримуємо \n\n$$\nZ(q \\to 1, \\varepsilon) \\approx \\sum_{i=1}^{N(\\varepsilon)} [p_{i} + (q-1)p_{i}\\ln{p_{i}}] = 1 + (q-1)\\sum_{i=1}^{N(\\varepsilon)} p_{i}\\ln{p_{i}}. \n$$\n\nУ результаті ми приходимо до наступного виразу:\n\n$$\nD_{1} = \\lim_{\\varepsilon \\to 0} \\sum_{i=1}^{N(\\varepsilon)}p_{i}\\ln{p_{i}} \\bigg/ \\ln{\\varepsilon}. \n$$\n\nЗ точністю до знака, чисельник у цій формулі представляє собою **інформаційну ентропію** фрактальної множини $S(\\varepsilon)$: \n\n$$\nS(\\varepsilon) = -\\sum_{i=1}^{N(\\varepsilon)}p_i\\ln{p_i}. \n$$\n\nТаким чином, результуюча величина узагальненої фрактальної розмірності $D_{1}$ пов'язана з ентропією $S(\\varepsilon)$ наступним співвідношенням:\n\n$$\nD_{1} = - \\lim_{\\varepsilon \\to 0} S(\\varepsilon) \\big/ \\ln{\\varepsilon}.\n$$\n\nПовертаючись до задачі розподілу точок на фрактальній множині $\\Omega$, можно сказати, що оскільки $S(\\varepsilon) \\approx \\varepsilon^{-D_1}$, величина $D_{1}$ характеризує інформацію, необхідну для опису положення точки в деякій комірці. \n\n::: {.callout-tip}\n## Додаткова інформація по інформаційній розмірності\n\nІнформаційна розмірність може бути використана для опису просторової неоднорідності системи. Що однорідніший атрактор, то вищим має бути цей показник. Тобто, чим більшу кількість конфігурацій здатні займати елементи даної системи, тим більша кількість інформації нам потрібна для обліку кожного елемента. За просторової однорідності інформаційна ентропія так само зростає, що пов'язує інформаційну розмірність із поняттям ентропії. Оскільки $D_{1}$ це тангенс кута нахилу лінії регресії, що будується для залежності між ентропією та радіусом кіл, у яких вимірюється частота влучання окремих елементів атрактора, можна сказати, що інформаційна розмірність відображає швидкість зміни інформаційної ентропії. Чим вища $D_{1}$, тим стрімкіше зростає ентропія --- міра нашого нинішнього незнання про систему. Чим нижча $D_{1}$, тим менша сама ентропія. Інакше кажучи, тим більша просторова асиметрія, упорядкованіша складність, вищі наші знання про поточний стан системи, і тим менше інформації нам потрібно для опису тих конфігурацій, які система може займати \n\n::: \n\nДля узагальненої фрактальної розмірності при $q=2$ справедливий наступний вираз:\n\n$$\nD_{2} = \\lim_{\\varepsilon \\to 0} \\ln{\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{2}} \\bigg/ \\ln{\\varepsilon}. \n$$\n\nВеличина $p_{i}$ представляє собою ймовірність попадання точки в комірку розміром $\\varepsilon$. Тоді величина $p_{i}^{2}$ є ймовірністю попадання в цю комірку двох точок. Знаходячи суму $p_{i}^{2}$ по всім зайнятим коміркам, ми отримуємо ймовірність того, що дві навмання обрані точки з множини $\\Omega$ знаходяться всередині однієї комірки з розміром $\\varepsilon$. Отже, відстань між цима двома точками буде менше або порядку $\\varepsilon$. Ймовірність знаходження двох траєкторій у межах околиці з радіусом $\\varepsilon$ можна знайти за допомогою кореляційного інтеграла. \n\nУ такому разі ми приходимо до висновку, що узагальнена розмірність визначає залежність кореляційного інтеграла $C(\\varepsilon)$ від $\\varepsilon$. З цієї причини величину $D_{2}$ в літературі іменують **кореляційною розмірністю**.\n\nТепер проаналізуємо поведінку $f(\\alpha)$. Значення функції в максимумі легко визначити, якщо скористатися виразом ([-@eq-7]), де $\\tau(q) = q\\alpha(q) - f(\\alpha(q))$ або $(q-1)D_{q} = q\\alpha(q) - f(\\alpha(q))$. При $q=0$ ми отримаємо, що $f(\\alpha_0)=D_{0}$, тобто максимальне значення спектра дорівнює хаусдорфовій розмірності. \n\n::: {#fig-D0}\n\n![](Images\\lab_7\\D-0.jpg){width=10cm, height=10cm}\n\nМаксимум функції $f(\\alpha)$ дорівнює фрактальній розмірності $D_{0}$\n\n:::\n\nРозглянемо випадок, коли $q=1$. Оскільки $\\tau(1) = 0$, тоді з рівняння вище слідує, що $\\alpha(1) = f(\\alpha(1))$. З іншого боку ми знаємо, що оскільки $q = df(\\alpha) \\big/ d\\alpha$, похідна $f(\\alpha)$ в цій точці дорівнює 1. Диференцюючи співвідношення $\\tau(q) = (q-1)D_{q}$ по $q$, \n\n$$\n\\frac{d\\tau}{dq} = D_{q} + (q-1)D_{q}^{'} = \\alpha(q), \n$$\n\nі припускаючи, що $q=1$, ми отримуємо, що $\\alpha(1)=D_{1}$. Таким чином, ми маємо $D_{1} = \\alpha(1) = f(\\alpha(1))$. Отже, інформаційна розмірність $D_{1}$ лежить на кривій $f(\\alpha)$ в точці, де $\\alpha=f(\\alpha)$ і $f^{'}(\\alpha)=1$.\n\n::: {#fig-D1}\n\n![](Images\\lab_7\\D-1.jpg){width=10cm, height=10cm}\n\nПоложення інформаційної розмірності $D_{1}: D_{1}=\\alpha=f(\\alpha)$\n\n:::\n\nТепер розглянемо випадок, коли $q=2$. Користуючись попередньою формулою, отримаємо, що $D_{2} = 2\\alpha(2) - f(\\alpha(2))$ або $f(\\alpha(2)) = 2\\alpha(2)-D_{2}$. \n\n::: {#fig-D2}\n\n![](Images\\lab_7\\D-2.jpg){width=10cm, height=10cm}\n\nГеометричне визначення кореляційної розмірності $D_{2}$\n\n:::\n\nДалі розглянемо залежність узагальненої фрактальної розмірності $D_{q}$ від різних значень $q$ для мультифрактального ряду, монофрактального та білого шуму. \n\nЗ представленого рисунку видно, що, по-переше, для всіх сигналів $D_{0}=1$, що відповідає теоретичним міркуванням. Інформаційна розмірність $D_{1}$ для мультифрактала та білого шуму однакова, що може говорити і про інформаційну зачущість обох сигналів. Для монофрактала вона близька до нуля. Кореляційна розмірність $D_{2}$ показує, що загалом як WTI, так і білий шум доволі схожі: їх значення в більшості своїй постають незалежними один від одного. Це розбігається з тими висновками, що були зробені в попередній роботі, де наближення $D_{2}$ до нуля вказувало на зростання ступеня корельованості системи. Для монофракталу $D_{2}$ знаходиться на рівні 1, що вказує на вищий ступінь кореляцій у цьому сигналі, порівнюючи з мульти- та монофракталами.  \n\n#### Аналогії мультифракталів із термодинамікою\n\nВикористовуючи концепції MFDFA, ми можемо по-новому поглянути на часовий сигнал як на термодинамічну систему. В рамках MFDFA показник маси $\\tau(q)$ можна розглядати як аналоги вільної енергії, показник сингулярності $\\alpha$ як аналог внутрішньої енергії $U$, мультифрактальний спектр $f(\\alpha)$ як ентропію. Дійсно, форма мультифрактального спектра нагадує залежність ентропії термодинамічної системи від енергії $U$. Показники $\\alpha_{min}$ та $\\alpha_{max}$ можна охарактеризувати як верхній та нижній ліміти внутрішньої енергії системи. Функція $Z(q)$ є формальним аналогом статистичної суми $Z(\\beta)$ в термодинаміці, де $\\beta=1/T=q$.\n\n::: {#fig-alpha-dependence}\n\n![](Images\\lab_7\\multifractal-physics.jpg){width=13cm, height=13cm}\n\nСхематичне представлення аналогії мультифракталів із концепціями термодинаміки\n\n:::\n\nОкрім цього, ми можемо прорахувати \"температуру\" досліджуваного сигнала. Більш конкретно, мультифрактальну \"питому теплоємність\" $C(q)$ [@EnriqueCanessa_2000] можна визначити як \n\n$$\nC(q) \\equiv -\\left(\\partial^{2} \\tau(q) \\big/ \\partial q^{2} \\right) = -\\left(\\partial \\alpha \\big/ \\partial q \\right) \\approx \\tau(q+1) - 2\\tau(q) + \\tau(q-1). \n$$\n\nПитома теплоємність, як міра швидкості зміни енергії, слугує індикатором явищ фазового переходу. У термодинамічній системі фаза характеризується однорідними фізичними властивостями, а фазовий перехід --- стрибкоподібною зміною певних властивостей за критичної зовнішньої умови. Вивчення фазових переходів у мультифрактальному спектрі обмежувалося простими системами, такими як множина Кантора та логістична карта. Однак наш аналіз показує наявність фазових переходів [@RePEc:spr:eurphb:v:76:y:2010:i:4:p:513-527] у мультифрактальному спектрі фінансових систем. Зокрема, \"енергія\" $\\alpha$ виявляє значні флуктуації в околі $q_c$, які відображаються піком питомої теплоємності $C(q_c)$.\n\n@fig-step10 демонструє, що $C(q)$ досягає максимуму в діапазоні $q$ від 2 до 3, що свідчить про те, що індекс WTI стає вкрай нерегулярним через велику флуктуацію катастрофи \"COVID-19\", яка слугує квазіфазовим переходом досліджуваного індексу. Можна стверджувати, що колапс коронавірусної пандемії має найбільший вплив на мультифрактальність досліджуваного ряду.\n\n## Хід роботи \n\nЗвісно ж фрактальний аналіз усього ряду є важливим, але такий підхід ігнорує припущення про існування в часовій послідовності як монофрактальних, так і мультифрактальних ділянок. Тобто, ігнорується припущення про зміну ступеня складності з плином часу. Кількісні міри мультифрактальності, розраховані в рамках підходу ковзного вікна, є найбільш об'єктивними та практичними при аналізі систем. Окрім цього кількісні показники можуть бути використані як індикатори або індикатори-провісники аномальних явищ, або як базис для побудови іншої прогностичної моделі. \n\nПовторно зчитаємо значення ряду із сайту FRED: \n\n::: {.callout-warning}\n## Увага\n\nВиконайте цей блок, якщо хочете зчитати дані не з Yahoo! Finance або FRED, а із власного файлу. Зрозуміло, що й аналіз результатів, і висновки залежать від того з яким рядом ми працюємо \n\n:::\n\n---\n\n---\n\nВиводимо досліджуваний ряд:\n\nДеякі графіки будуть представляти парну побудову лише часового ряду та мультифрактального індикатора. Скористаємось функцією `plot_pair()`, що ми визначали в попередніх лабораторних:\n\n#### Віконна процедура\n\nДля подальших розрахунків знову скористаємось бібліотекою `fathon`, що ми використовували попередньо для виконання класичного аналізу детрендованих флуктуацій. Переваги саме цієї бібліотеки полягають у можливості використання процедури розрахунку розбиття ряду на сегменти починаючи з кінця ряду, оскільки довжина ряду не завжди дозволяє поділити його на локальні сегменти націло. Тобто, теоретично у нас залишається сегмент ряду, що не піддається розбиттю на локальні сегменти. Тому повторна процедура розбиття на локальні сегменти починаючи з кінця ряду дозволяє обійти дану проблему. Для спрощення представлення теоретичного матеріалу ми не стали імплементувати дану процедуру, але вона доступна в бібліотеці `fathon`. Окрім цього, бібліотека надає можливість обчислення крос-кореляційного аналізу детрендованих флуктуацій та його мультифрактального аналогу. \n\nПриступимо до ініціалізації параметрів.\n\nРозпочнемо процедуру рухомого вікна, що об'єднуватиме у собі попередні етапи розрахунків:\n\nЗберігаємо абсолютні значення показників до текстових файлів. \n\nПроаналізуємо динаміку отриманих індикаторів.\n\n### Ширина спектра мультифрактальності ($\\Delta\\alpha$)\n\nПершим і одним із найпрактичніших індикаторів складності системи є ширина спектра мультифрактальності, $\\Delta\\alpha$, яку можна подати як різницю між максимальним ступенем синґулярності та мінімальним:\n\n$$\n\\Delta\\alpha = \\alpha_{max} - \\alpha_{min}. \n$$ {#eq-7-1}\n\nЯкщо проводити аналогію з термодинамічними показниками, то в такому разі ширина спектра мультифрактальності становитиме різницю між найбільшим і найменшим значенням внутрішньої енергії системи. Розглянемо динаміку даного показника для ринку нафти.\n\nНа [-@fig-wti-wind-delta-alpha] видно, що ширина спектра мультифрактальності зростає під час кризових подій, що вказує на зростання загального ступеня складності та періодизації. Тобто, даний показник слугує ще одним підтвердженням, що трейдери на ринку, наприклад, нафти поводять себе у синхронній манері в ході кризи. Зростання загального ступеня мультифрактальності є індикатором зростання кореляцій в системі, що підтверджувалось і попередніми індикаторами складності.\n\n### Різниця між кінцями спектра мультифрактальності ($\\Delta f$)\n\nОднак проста ширина спектра мультифрактальності не показує, наприклад, флуктуації якого типу є найвірогіднішими, елементи якого типу щільності відіграють найбільшу роль у зростанні або зниженні складності системи. Надалі було запропоновано такий показник мультифрактальності як $\\Delta f$, який можна представити наступним чином [@DAI2014332;@DAI2016722;@SUN2001553]:\n\n$$\n\\Delta f = f(\\alpha_{min}) - f(\\alpha_{max}). \n$$ {#eq-7-2}\n\nСенс даного показника полягає в тому, що він дає нам змогу визначити ступінь імовірності появи елементів з великими щільностями і малими. Якщо цей показник менший за нуль, тоді флуктуації, що відображають елементи з найбільшою концентрацією (найбільшими фруктуаціями), мають найбільшу ймовірність. Якщо цей показник вищий за нуль, тоді флуктуації, що відображають малоконцентровані елементи (малі флуктуації), визначають динаміку системи. Якщо цей показник перебуває в нулі, тоді як високосингулярні, так і малосингулярні елементи мають рівномірний внесок у динаміку системи.\n\nЗвертаючись до термодинаміки, можна згадати, що $f(\\alpha)$ --- це ентропія системи. Тоді стає зрозуміло, що варіативність спектра мультифрактальності дає нам змогу визначити ступінь внеску висококонцентрованих і малоконцентрованих елементів у мінімізацію ентропії системи. Лівостороння асиметрія мультифрактального спектра $(\\Delta f > 0)$ підказує нам, що висококонцентровані елементи фазового простору дають найбільший внесок у мінімум термодинамічної ентропії. Іншими словами, ці елементи і є двигуном зростання впорядкованості динаміки системи. Своєю чергою, правостороння асиметрія мультифрактального спектра $(\\Delta f < 0)$ вказує на мінімізацію ентропії за рахунок малоконцентрованих елементів. Симетрія кінців спектра вказує на рівний внесок високощільних і розріджених областей на мінімізацію ентропії. Як уже згадувалося, трапляються випадки, коли мультифрактальний спектр практично сходиться в сингулярність (одну точку). У такому разі ми маємо справу з простою монофрактальною системою, яка в нашому випадку характеризувалася незалежними і нормально розподіленими випадковими величинами. Для такого спектра і $\\Delta\\alpha$, і $\\Delta f$ будуть прямувати до нуля. Для такого часового ряду вже спостерігається не множина фрактальних розмірностей, а тільки один фрактальний показник, $f[\\alpha(q=0)] = 1$. Це саме та область, де система досягає своєї термодинамічної рівноваги --- максимуму ентропії. У свою чергу $\\Delta f$ можна охарактеризувати як різницю ентропій за граничної максимальної та мінімальної внутрішньої енергії системи. \n\n### Ширина лівого ($\\Delta\\alpha_{L}$) та правого ($\\Delta\\alpha_{R}$) хвостів мультифрактального спектра\n\nКрім цього, ми можемо дослідити ступінь складності динаміки окремо високощільних областей (з великими флуктуаціями) і низькощільних (з малими флуктуаціями). Для цього виміряємо ширину окремо лівого і правого хвостів. Ширину лівого хвоста визначимо як\n\n$$\n\\Delta\\alpha_{L} = \\alpha_{0} - \\alpha_{min},\n$$ {#eq-7-3}\n\nа ширину правого хвоста як \n\n$$\n\\Delta\\alpha_{R} = \\alpha_{max} - \\alpha_{0}.\n$$ {#eq-7-4}\n\nУ свою чергу ширина лівого хвоста вимірює ступінь складності флуктуацій з великою амплітудою, а ширина правого хвоста --- малих. Зростання ширини кожного з хвостів відображатиме зростання ступеня кореляцій між елементами. \n\nІз [@fig-delta-alpha-left-right] видно, що досліджувані індикатори реагують у характерний спосіб на кризові події. Ширина лівої сторони спектра мультифрактальності зростає під час 1992, 1996-2000, 2008, 2016 років та коронавірусної пандемії. Це вказує на домінацію висококонцентрованих флуктуацій (з великою амплітудою коливань). Окрім цього, зростання ширини лівого хвоста вказує на те, що флуктуації з великою амплітудою коливань характеризуються зростанням ступеня кореляцій під час кризових подій, що в свою чергу може слугувати індикатором зростання процесів самоорганізації. \n\nХоча і меншою, але не менш примітною є динаміка ширини правого хвоста мультифрактального спектра. Цей індикатор працює майже аналогічно до ширини лівого хвоста, але характеризує динаміку малоконцентрованих величин --- флуктуацій з малою амплітудою коливань. Майже синхронна динаміка обох показників указує на зростання впливу коливань як флуктуацій з великою амплітудою коливань, так і флуктуацій з малою амплітудою коливань. Тобто, два типи флуктуацій є джерелом зростання нелінійних кореляцій під час кризових подій. \n\n### Показник сингулярності $\\alpha$ та його різновиди\n\nВ якості можливих індикаторів складності системи можна взяти $\\alpha_{min}$, $\\alpha_{max}$, $\\alpha_{mean}$ і $\\alpha_0$, які, відповідно, характеризують мінімальну силу сингулярності, максимальну, середню і сингулярність за умови рівноважного врахування як великих флуктуацій, так і малих.\n\nЯк видно з [@fig-wti-wind-alphas], усі показники сингулярності зростають в області фінансового фазового переходу зі стану стабільності до стану кризи. Це говорить про зростання складності системи: різкому прирості кількості агентів, що задіяні в самоорганізованому розвитку досліджуваної системи. З погляду термодинаміки можна було б сказати, що при фінансових крахових подіях зростає внутрішня енергія системи.  \n\n### Тип довгого хвоста мультифрактального спектра ($\\Delta S$)\n\nКрім такої міри як, наприклад, $\\Delta f$ можна представити й інші міри асиметрії мультифрактального спектра. Наприклад, ми можемо визначити тип довгого хвоста мультифрактального спектра за допомогою показника $\\Delta S$ [@10.3389/fphys.2012.00141]: \n\n$$\n\\Delta S = \\Delta\\alpha_{R} - \\Delta\\alpha_{L}. \n$$ {#eq-7-5}\n\nЯкщо $\\Delta S < 0$, мультифрактальний спектр має довгий лівий хвіст, що свідчить про чутливість часового ряду до локальних флуктуацій з великою амплітудою. Якщо $\\Delta S > 0$, мультифрактальний спектр має довгий правий хвіст, який вказує на чутливість структури сигналу до локальних флуктуацій з малою амплітудою коливань. У тих випадках, коли високо- і низькофлуктуаційні компоненти сигналу співставні, спектр сингулярностей буде приблизно симетричним і  $\\Delta\\alpha_{R} = \\Delta\\alpha_{L}$.\n\nЗ огляду на [@fig-wti-wind-delta-s] видно, що $\\Delta S < 0$, що свідчить про те, що найбільш крахові ділянки нафтового ринку зумовлені флуктуаціями з великою амплітудою коливань. Особливо помітними тут предстають кризи 1992 та 2020 років.\n\n### Показник асиметрії $A$\n\nДалі ми можемо визначити наступний параметр асиметрії [@OSWIECIMKA2018231;@PhysRevE.91.030902;@Dro_d__2018]:\n\n$$\nA = (\\Delta\\alpha_{L} - \\Delta\\alpha_{R})\\big/(\\Delta\\alpha_{R} + \\Delta\\alpha_{L}) = -\\Delta S \\big/ \\Delta\\alpha.\n$$ {#eq-7-6}\n\nПараметр асиметрії пов'язаний з предомінуючим типом коливань у досліджуваній системі. Якщо $A=0$ ($\\Delta\\alpha_{L}=\\Delta\\alpha_{R}$), динаміку системи представляє симетричний спектр. Якщо $A<0$ ($\\Delta\\alpha_{L}<\\Delta\\alpha_{R}$), мультифрактальний спектр має правосторонню асиметрію, що підкреслює сильніший вплив малих флуктуацій на мультифрактальність. І навпаки, коли $A>0$ ($\\Delta\\alpha_{L}>\\Delta\\alpha_{R}$), тоді ми маємо справу з лівостороннім спектром, який позначає більшу неоднорідність для великих флуктуацій і вказує на те, що в часовому ряді переважає мультифрактальна природа неоднорідностей з високими щільностями. Оскільки асиметрію виявляють за знаком $A$, що еквівалентний знаку $\\Delta S$, то, ґрунтуючись тільки по знаку $\\Delta S$, можна зробити висновки як про тип довгого хвоста, так і про знак показника $A$ мультифрактального спектра, тобто нечутливість і тип домінантних коливань мультифрактальності часового ряду.\n\nЗ [@fig-wti-asymmetry] видно, що, як правило, показник асиметрії зростає під час крахових подій і вказує на домінацію лівостороннього спектра (висококонцентрованих флуктуацій з великою амплітудою коливань). Окрім цього видно, що, наприклад, для криз 2008 та 2015-2016 років спостерігалась помітна короткочасна правостороння асиметрія, що характеризується швидкоплинним сплеском показника асиметрії у сторону від'ємних значень. Асоціювати малі та великі флуктуації з конкретними настроями або поведінковими патернами ринку доволі складно. На даний момент ми можемо відзначити тільки те, що дані події представляли найбільш багату варіацію як короткострокових, так і довгострокових кореляцій.  \n\n### Індекс $h$-флуктуацій ($hFI$)\n\nФлуктуацію можна проаналізувати за допомогою другої похідної узагальненого показника Херста. Зауважимо, що амплітуда другої похідної у випадку мультифрактальних сигналів більша, ніж для монофрактальних. \nДля одержання потрібної інформації з $h(q)$ було запропоновано $h$-індекс флуктуації $(hFI)$ [@Orozco_Duque_2015], що визначається як степінь другої похідної від $h(q)$:\n\n$$\nhFI = \\frac{1}{2|q_{max}|+2}\\sum_{q=q_{min}-2}^{q_{max}}\\left[ h(q) - 2h(q-1) + h(q-2) \\right]^{2}.\n$$ {#eq-7-7}\n\nЧим вище значення даного показника, тим вища самоорганізованість системи.\n\nВидно, що за $hFI$ найвищий ступінь мультифрактальності проявляється саме для криз 1992, 2008, 2016 та 2020 років. Дані крахові події включають в себе найбільшу кількість різноманітних факторів, що впливали на динаміку досліджуваної системи. Особливо помітно це для коронавірусної пандемії. \n\n### Кумулятивний індекс інкрементів узагальнених показників Херста ($\\alpha CF$)\n\nКумулятивна функція квадратів інкрементів ($\\alpha CF$) [@doi:10.1098/rsta.2020.0254] узагальнених показників Херста між послідовними моментними порядками є більш надійним показником розподілу узагальнених показників Херста. \n\nПредставлений кумулятивний індекс дещо відрізняється від $hFI$, але за логікою приблизно однаковий: події з найвищим ступенем мультифрактальності характеризуються вищою амплітудою $\\alpha CF$. Представлений показник виділяє ті самі кризи, що й попередній, але динаміка цього показника більш виразна, що робить його більш надійним для ідентифікації періодів самоорганізації системи. \n\n### Інтегральна мультифрактальна теплоємність $C(q)$\n\nЗагальний ступінь мультифрактальності, інтегральну мультифрактальну питому теплоємність ($C_{area}$), можна виразити через рівняння ([-@eq-7-8]):\n\n$$\nC_{area} = \\int C(q)dq.\n$$ {#eq-7-8}\n\nРозрахуємо і проаналізуємо динаміку цього показника. \n\nЗ представленого рисунку видно, що динаміка інтегральної теплоємності дуже подібна до ширини спектра мультифрактальності. Тобто, $C_{area}$ є показником складності, що вказує на ступінь самоорганізованості фінансового фазового переходу. Видно, що фінансові крахи представляють доволі трендостійку динаміку, що є наслідком цілеспрямованих та колективних дій трейдерів на ринку. \n\n### Хаусдорфова розмірність ($D_{0}$)\n\nЯк уже зазначалось, $D_{0}$ представляє верхню межу змін розмірностей фрактальних підмножин атрактора системи. Інформацію про статистичні властивості системи він не містить і не представляє особливої цінності. \n\n### Інформаційна розмірність ($D_{1}$)\n\nІнформаційна розмірність тісно пов'язана з інформаційною ентропією Шеннона. Чим вище значення $D_1$, тим швидше збільшується ентропія, що є показником того, наскільки мало ми знаємо про поточний стан системи. Зі зменшенням $D_1$ ентропія знижується, що, своєю чергою, свідчить про збільшення асиметрії в просторі, зменшення складності та розширення нашого розуміння поточного стану системи. Це також означає, що для опису можливих конфігурацій системи нам буде потрібно менше інформації.\n\nНа [@fig-wti-informdim] видно, що інформаційна розмірність характеризується спадом під час крахових подій. Це вказує на зростання ступеня впорядкованості системи та колективної атракції агентів ринку до конкретної області фазового простору досліджуваної системи. \n\n### Кореляційна розмірність ($D_{2}$)\n\nКореляційну розмірність, аналогічно інформаційній розмірності, можна подати як тангенс кута нахилу лінії регресії, побудованої в логарифмічному масштабі, щодо залежності кореляційного інтеграла $C(\\varepsilon)$ від $\\varepsilon$. Подібно до $D_1$, кореляційна розмірність також визначає, як швидко змінюється значення кореляційного інтеграла.\n\nКореляційна розмірність на [@fig-wti-corrdim] характеризується зростанням у передкризовий період та спадом під час кризи. Це говорить про те, що більшість агентів ринку починає орієнтуватися на один конкретний вектор розвитку системи.   \n\n### Кривизна лівого ($\\Delta D_{L}$) та правого ($\\Delta D_{R}$) хвостів розподілу узагальнених фрактальних розмірностей\n\nОхарактеризувати ступінь цієї складності можна за кривизною окремо правого та лівого хвостів узагальнених фрактальних розмірностей. Праву сторону ($\\Delta D_{R}$) можна визначити як \n\n$$\n\\Delta D_{R} = D_0 - D_{q_{max}}.\n$$ {#eq-7-9}\n\nІ чим більшим буде значення цієї міри, тим сильнішим буде ступінь впливу елементів із найбільшою концентрацією (щільністю, амплітудою флуктуацій) на загальну складність системи.\n\nКривизна лівого хвоста кривої узагальнених фрактальних розмірностей ($\\Delta D_{L}$): \n\n$$\n\\Delta D_{L} = D_{q_{min}} - D_{0}. \n$$ {#eq-7-10}\n\nЦей показник буде говорити нам про те, наскільки сильним є вплив найменш концентрованих елементів на складність системи.\n\nНа рисунку ([@fig-delta-lr]) видно, що спостерігаються етапи, при який два показники можуть вести себе як асинхронно, так і синхронно. Для 1992 року видно, що у передкризовий етап спостерігалась короткочасна домінація великих флуктуацій, на що і вказує $\\Delta D_{R}$. Під час краху спостерігалась домінація малоконцентрованих елементів, що демонструє зростання $\\Delta D_{L}$. Для 2001 року бачимо зростання впливу правого хвоста і зменшення впливу лівого. Для краху 2008 року видно зростання впливу висококонцентрованих елементів напередодні кризи. Після цього домінують малоконцентровані елементи. Бачимо зростання впливу малоконцентрованих елементів під час кризи 2016 року, і закономірне зменшення участі великоконцентрованих елементів. Пандемія 2020-2021 років характеризувалась активною участю як малоконцентрованих елементів, так і великоконцентрованих, на що вказує зростання обох показників кривизни хвостів узагальнених розмірностей.  \n\n### Дво- та тривимірна візуалізація показників мультифрактальності\n\nПопередньо ми аналізували залежності $h(q)$, $\\tau(q)$, $D(q)$, $C(q)$ та $f(\\alpha)$ для всього часового ряду. Тепер, скориставшись процедурою ковзного вікна, ми можемо подивитися на їх зміну з плином часу. Скористаємось часовим рядом цін на нафту. \n\nПерш за все оголосимо функції для побудови двовимірних графіків:\n\nта тривимірних:\n\nПісля оголошення необхідний функцій можна приступати до візуалізації. \n\n#### Динаміка $h(q)$ з ходом часу в дво- та тривимірному просторах\n\nНа представлений рисунках ([@fig-hq-2d] та [@fig-hq-3d]) видно, що узагальнений показник Херста характеризується значним ростом саме в період криз. Особливо високим $h(q)$ предстає для $q < 0$, що говорить про значну персистентність малих флуктуацій у періоди турбулентності. Найвищим ступінь нелінійності в даному випадку представляють кризи 1992, 2008-2009, 2015-2016 та 2020-2021 років, що підтверджується й попередніми індикаторами. \n\n#### Динаміка $\\tau(q)$ з ходом часу в дво- та тривимірному просторах\n\nЯк видно з представлений рисунків ([@fig-tauq-2d] та [@fig-tauq-3d]), $\\tau(q)$ стає більш нелінійним для всіх значень $q$. На кінцях хвостів цього індикатора можна помітити значні впадини, що можуть слугувати індикаторами крахових подій, але в порівнянні з тим же показником Херста даний індикатор є менш виразним. \n\n#### Динаміка $D(q)$ з ходом часу в дво- та тривимірному просторах\n\nДво- та тривимірні представлення узагальненої фрактальної розмірності показують, що $D(q)$ зростає під час кризових подій. Узагальнена фрактальна розмірність також представляє найбільш індикативну динаміку для негативних значень $q$, хоча для позитивних $q$ також спостерігаються незначні коливання. \n\n#### Динаміка $C(q)$ в дво- та тривимірному просторах\n\nНа даних рисунках ([@fig-heat-2d] та [@fig-heat-3d]) під час кризових подій спостерігаються стрибки мультифрактальної теплоємності, що вказує аналогії фізичних фазових переходів та кризових подій. Можна бачити, що при різних ринкових режимах $C(q)$ може бути симетричною, демонструючи рівномірний вплив на динаміку ринку як висококонцентрованих елементів, так і низькоконцентрованих. Також $C(q)$ може зміщуватись як у ліву сторону, так і вправу, що говорить про мінливість ринку та впливовість різних початкових умов на його структуризацію. \n\n#### Динаміка $f(\\alpha)$ з ходом часу в дво- та тривимірному просторах\n\nЯк видно з останніх рисунків ([@fig-falpha-2d] та [@fig-falpha-3d]), ширина спектра мультифрактальності змінюється у формі з плином часу, і стає ширшою під час кризових подій, що підтверджувалось таким індикатором як, наприклад, $\\Delta\\alpha$. Видно, що у передкризові періоди зростає лівостороння асиметрія, що характеризує флуктуації значної амплітуди коливань. Самі кризи представляють зміщення $f(\\alpha)$ у праву сторону, що вказує на домінацію флуктуацій з малою амплітудою. У будь-якому разі, зростання ширини спектра є індикатором зростання ступеня самоорганізованості елементів, що залучені до досліджуваної системи. Тобто, як $f(\\alpha)$, так і попередні індикатори можна рекомендувати в якості індикаторів або індикаторів-передвісників кризових подій. \n\n## Завдання для виконання\n\n1. Вибрати із запропонованої бази даних варіант завдання \n2. Провести повний аналіз ряду за допомогою методу MF-DFA\n3. Дати інтерпретацію отриманим результатам\n\n## Контрольні запитання\n\n1. В чому переваги мультифрактальних характеристик у порівнянні з монофрактальними?\n2. На що вказує мультифрактальність часового ряду?\n3. Яким чином поводять себе різні характеристики, якщо ряд містить кризу?\n","srcMarkdownNoYaml":"\n\n\n\n\n\n\n**Тема.** Мультифрактальний аналіз складних систем \n\n**Мета.** Навчитися використовувати мультифрактальний аналіз детрендованих флуктуацій для отримання індикаторів нелінійних змін у системі\n\n## Теоретичні відомості\n\n### Визначення мультифракталів\n\nУ цій лабораторній ми викладемо основи теорії мультифракталів --- **неоднорідних фрактальних об'єктів**, для повного опису яких, на відміну від регулярних фракталів, недостатньо введення лише однієї величини, його фрактальної розмірності $D$, а потрібен цілий спектр таких розмірностей, кількість яких, взагалі кажучи, нескінченна. Причина цього полягає в тому, що поряд із суто геометричними характеристиками, які визначаються величиною $D$, такі фрактали характеризуються й деякими специфічними статистичними властивостями.\n\nПростіше всього пояснити, що розуміється під “неоднорідним фракталом” на прикладі трикутника Серпинського, отриманого за допомогою методу випадкових ітерацій ([@fig-triangle]).\n\n::: {#fig-triangle}\n\n![](Images\\lab_7\\triangle.jpg){width=10cm, height=10cm}\n\nТрикутник Серпинського, області якого згенеровані з різними ймовірностями\n\n:::\n\nПрипустимо, що в методі випадкових ітерацій ми тепер із якоїсь причини віддали перевагу одній із вершин трикутника, наприклад, вершині А, і стали вибирати її з імовірністю 90%. Дві ж інші вершини В і С для нас рівноцінні, але на їхню частку тепер припадає всього лише по 5%. Результат такої несиметричної гри\" зображено нижче на рисунку вище. \n\nВидно, що точки всередині трикутника АВС розподілені тепер вкрай нерівномірно. Більша їх частина перебуває біля вершини А та її прообразів. Водночас у вершин В і С (і їхніх прообразів) їх є вкрай мало. Проте, за звичайною термінологією, ця множина точок (за умови прагнення числа ітерацій до нескінченності) є фракталом, тому що збереглася основна властивість фрактала --- самоподібність. Дійсно, трикутник DFC, хоча в ньому у 20 разів менше точок, за своїми статистичними і геометричними властивостями повністю подібний до великого трикутника АВС. Так само, як і у великому трикутнику, точки в ньому концентруються здебільшого поблизу вершини D --- аналогу вершини А.\n\n@fig-dist-serp більш детально демонструє результуючий розподіл точок по трикутнику Серпинського. Цифри в кожному з маленьких трикутників показують його відносну заселеність точками множини. \n\n::: {#fig-dist-serp}\n\n![](Images\\lab_7\\distribution_of_points.jpg){width=6cm, height=6cm}\n\nРозподіл точок по трикутнику Серпинського, представленого на попередньому рисунку\n\n:::\n\nОднак, не дивлячись на нерівномірність розподілу точок фрактала, фрактальна розмірність залишилась при цьому такою ж, $D=\\ln{3}/\\ln{2}$. Покриття цієї множини все меншими трикутниками можна здійснити по тому ж алгоритму, що й раніше. Таке співпадіння змушує замислитись над пошуком нових кількісних характеристик, котрі могли б відрізнити нерівномірний розподіл точок від рівномірного. \n\n\nІнший, складніший приклад неоднорідного фрактала, який ми б хотіли ще навести, показано на наступному рисунку. Ліворуч продемонстровано великий квадрат зі стороною, що дорівнює одиниці, який на цьому (нульовому) етапі повністю покриває собою деяку фрактальну множину точок $M$. На наступному (першому) етапі, у центрі рисунка, показано, як ту саму множину можна покрити трьома меншими квадратами зі сторонами $l_1=1/2, \\ l_2=l_3=5/16$, у яких, відповідно, міститься частка $p_1=1/2, \\ p_2=1/3$ та $p_3=1/6$ усіх точок.\n\n::: {#fig-dist-square}\n\n![](Images\\lab_7\\square_fractal.jpg){width=6.5cm, height=6.5cm}\n\nПриклад мультифрактала, що підкоряється ренормалізаційній схемі \n\n:::\n\nНаступний етап покриття (зображений на рисунку праворуч) містить уже 9 квадратів зі сторонами $l_{1}^{2}=1/4, \\ l_{1}l_{2}=l_{1}l_{3}=5/32$ (у нижньому правому куті) і $l_{2}l_{1}=5/32, \\ l_{2}^{2}=l_{2}l_{3}=25/256$ (угорі праворуч і ліворуч). Відносна заселеність цих квадратів точками множини показана на рисунку. Вона відповідає добутку чинників заселеності (імовірностей): $p_{1}^{2}=1/4, \\ p_{1}p_{2}=1/6, \\ p_{1}p_{3}=1/12$ --- для нижньої правої групи, $p_{2}p_{1}=1/6, \\ p_{2}^{2}=1/9, \\ p_{2}p_{3} = 1/18$ --- для верхньої лівої та $p_{3}p_{1}=1/12, \\ p_{3}p_{2}=1/18, \\ p_{3}^{2}=1/36$ --- для верхньої правої групи. Зазначимо, що є чітка відповідність між заселеністю квадрата $p_{j}p_{i}$ і його розмірами $l_{i}l_{i}$.\n\n\nПодальший процес розбиття і покриття множини $M$ здійснюється згідно із цією ренормалізаційною схемою. Кожен квадрат, що має на $n$-му кроці розмір $l$ і заселеність $р$, замінюється на $n+1$ кроці трьома квадратами з розмірами $ll_{1}, \\ ll_{2}, \\ ll_{3}$ і заселеностями $pp_{1}, \\ pp_{2}, \\ pp_{3}$ відповідно, розміщеними таким самим чином відносно один одного, як показано на @fig-dist-square.\n\nДвоє з розглянутих вище випадки являють собою приклади неоднорідних фракталів. Під словом \"неоднорідний\" ми тут розуміємо нерівномірний розподіл точок множини по фракталу або нерівномірний розподіл малих та великих флуктуацій у часовому ряді. Причина неоднорідності в попередніх випадках одна й та сама --- різні ймовірності заповнення геометрично однакових елементів фрактала, або в загальному випадку невідповідність імовірностей заповнення геометричним розмірам відповідних областей. Такі неоднорідні фрактальні об'єкти в літературі називають мультифракталами, і їх вивченням ми й займемося надалі.\n\n\n### Узагальнені фрактальні розмірності $D_{q}$\n\nДамо загальне визначення мультифрактала. Розглянемо фрактальний об'єкт, що займає якусь обмежену ділянку $\\Omega$ розміру $L$ у Евклідовому просторі з розмірністю $d$. Нехай на якомусь етапі його побудови він являє собою множину з $N \\gg 1$ точок, якось розподілених у цій області. Ми будемо припускати, що врешті-решт $N \\to \\infty$. Прикладом такої множини може слугувати трикутник Серпінського, побудований методом випадкових ітерацій. Кожен крок ітераційної процедури додає до цієї множини одну нову точку.\n\nРозіб'ємо всю область $\\Omega$ на кубічні клітинки зі стороною $\\varepsilon \\ll L$ та об'ємом $\\varepsilon^{d}$. Далі нас будуть цікавити тільки зайняті клітинки, у яких міститься хоча б одна точка. Нехай номер зайнятих комірок $i$ змінюється в межах $і=1, 2,..., N(\\varepsilon)$, де $N(\\varepsilon)$ --- сумарна кількість зайнятих клітинок, яка, звісно, залежить від розміру клітинки $\\varepsilon$.\n\nНехай $n_{i}(\\varepsilon)$ представляє собою кількість точок у клітинці з номером $i$, тоді величина $p_{i}(\\varepsilon) = \\lim_{N\\to\\infty}n_{i}(\\varepsilon)/{N}$ представляє собою ймовірність того, що навмання взята точка з нашої множини знаходиться в комірці $i$. Інакше кажучи, ймовірності $р_{i}$ характеризують відносну заселеність комірок. З умови нормування ймовірності випливає, що \n\n$$\n\\sum_{i=1}^{N(\\varepsilon)}p_{i}(\\varepsilon)=1.\n$$\n\n\nУведемо тепер у розгляд **узагальнену статистичну суму** $Z(q,\\varepsilon)$, що характеризується показником ступеня $q$, який може набувати будь-яких значень в інтервалі $-\\infty<q<+\\infty$\n\n$$\nZ(q,\\varepsilon)=\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon).\n$$\n\nСпектр **узагальнених фрактальних розмірностей** $D_{q}$, що характеризує даний розподіл точок в області $\\Omega$, визначається за допомогою співвідношення $D_{q} = \\tau(q)\\big/(q-1)$, де функція $\\tau(q)$ має вид \n\n$$\n\\tau(q)=\\lim_{\\varepsilon\\to 0} \\ln{Z(q,\\varepsilon)} \\big/ \\ln{\\varepsilon}.\n$$\n\n\nЯк ми покажемо нижче, якщо $D_{q}=D=\\text{const}$, тобто не залежить від $q$, то дана множина точок являє собою звичайний, регулярний фрактал, який характеризується лише однією величиною --- фрактальною розмірністю $D$. Навпаки, якщо функція $D_{q}$ якось змінюється з $q$, то розглянута множина точок представляє мультифрактал.\n\nТаким чином, мультифрактал у загальному випадку характеризується деякою **нелінійною** функцією $\\tau(q)$, що визначає поведінку статистичної суми $Z(q,\\varepsilon)$ при $\\varepsilon\\to 0$\n\n$$\nZ(q,\\varepsilon)=\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon) \\approx \\varepsilon^{\\tau(q)}.\n$$ {#eq-1}\n\n\nСлід мати на увазі, що в реальній ситуації ми завжди маємо скінченне, хоча й дуже велике число дискретних точок $N$, тому при комп'ютерному моделюванні конкретної множини граничний перехід $\\varepsilon\\to 0$ треба виконувати з обережністю, пам'ятаючи, що йому завжди передує ліміт $N \\to 0$.\n\nПокажемо тепер, як поводиться узагальнена статистична сума у випадку звичайного регулярного фрактала з фрактальною розмірністю $D$. У цьому випадку в усіх зайнятих комірках міститься однакова кількість точок, $n_{i}(\\varepsilon) = N \\big/ N(\\varepsilon)$, тобто фрактал представляється **однорідним**. Тоді очевидно, що відносні населеності клітинок, $p_{i}(\\varepsilon)=1/N(\\varepsilon)$, також однакові, і узагальнена статистична сума набуває вигляду \n\n$$\nZ(q,\\varepsilon) = N^{1-q}(\\varepsilon). \n$$ {#eq-2}\n\nВрахуємо тепер, що, згідно визначеню фрактальної розмірності $D$, кількість зайнятих клітинок при достатньо малому $\\varepsilon$ поводить себе наступним чином:\n\n$$\nN(\\varepsilon) \\approx \\varepsilon^{-D}.\n$$ {#eq-3}\n\nПідставляючи ([-@eq-3]) у ([-@eq-2]), і порівнюючи з ([-@eq-1]), отримуємо\n\n$$\n\\varepsilon^{\\tau(q)} = \\varepsilon^{-D(1-q)} \\to \\tau(q)=(q-1)D. \n$$ {#eq-4}\n\nМи приходимо до висновку, що у випадку звичайного фрактала функція ([-@eq-4]) є лінійною. Тоді всі $D_{q}$ дійсно не залежать від $q$. Фрактал у якого всі узагальнені фрактальні розмірності $D_{q}$ співпадають називається **монофракталом**.\n\nЯкщо розподіл точок по клітинкам неоднаковий, тоді фрактал називається неоднорідним, тобто представляє із себе мультифрактал, і для його характеристики необхідний цілий спектр узагальнених фрактальних розмірностей $D_{q}$, кількість котрих, у загальному випадку, нескінченна. \n\nТак, наприклад, при $q \\to +\\infty$ основний внесок в узагальнену статистичну суму ([-@eq-1]) вносять комірки, що містять найбільшу кількість частинок $n_{i}$ у них і, відповідно, що характеризуються найбільшою ймовірністю їх заповнення $p_{i}$. Навпаки, при $q \\to -\\infty$ основний внесок в узагальнену статистичну суму вносять найбільш розрідженні комірки з найменшою ймовірністю їх заповнення $p_{i}$. Таким чином, функція $D_{q}$ показує, наскільки неоднорідним представляється досліджувана множина точок $\\Omega$. \n\nУ подальшому для характеристики розподілу точок необхідно знати не тільки функцію $\\tau(q)$, але і її похідну:\n\n$$\n\\frac{d\\tau(q)}{dq} = \\lim_{\\varepsilon\\to 0} \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}\\ln{p_{i}} \\Bigg/ \\left( \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q} \\right)\\ln{\\varepsilon}.\n$$\n\nЦя похідна має важливий фізичний зміст, який буде продемонстровано пізніше. Зараз знову зазначимо, що для мультифрактальної системи вона не залишається константною і змінюється з $q$. \n\n### Функція мультифрактального спектра $f(\\alpha)$\n\n#### Спектр фрактальних розмірностей\n\nУ попередньому пункті ми ввели поняття мультифрактала --- об'єкта, що представляє собою неоднорідний фрактал. Для його опису ми ввели множину узагальнених фрактальних розмірностей $D_{q}$, де $q$ приймає будь-які значення в інтервалі $-\\infty<q<+\\infty$. Однак величини $D_{q}$ не є, строго кажучи, фрактальними розмірностями в загальному розумінні цього слова. \n\n\nТому часто поряд із ними для характеристики мультифрактальної множини використовують так звану **функцію мультифрактального спектра** $f(\\alpha)$ (спектр сингулярностей мультифрактала), до якої, як ми побачимо надалі, більше підходить термін фрактальна розмірність. Ми покажемо, що величина $f(\\alpha)$ фактично дорівнює хаусдорфовій розмірності якоїсь однорідної фрактальної підмножини із вихідної множини $\\Omega$, що дає домінантний внесок у статистичну суму при заданій величині $q$.\n\nОднією з основних характеристик мультифрактала є набір імовірностей $р_{i}$, що показують відносну заселеність клітинок $\\varepsilon$, якими ми покриваємо цю множину. Чим менший розмір клітинки, тим менша величина її заселеності. Для самоподібних множин залежність $p_{i}$ від розміру клітинки $\\varepsilon$ має степеневий характер:\n\n$$\np_{i}(\\varepsilon) \\approx \\varepsilon^{\\alpha_{i}}, \n$$\n\nде $\\alpha_{i}$ являє собою деякий показник ступеня (різний для різнок клітинок $i$). \n\n\n\n::: {.callout-tip}\n## Додатково по $\\alpha$\n\nСпрямовуючи значення $\\varepsilon$ до нуля, фрактальність можна розглядати локально для кожної точки (елемента) досліджуваної системи, і таким чином показник $\\alpha$ є локальною фрактальною розмірністю. Його ще називають *показником Гьолдера* або *силою сингулярності*\n\nМожемо спостерігати саме степеневу залежність, оскільки, вочевидь, розподіл маси (флуктуацій) концентрується з різною \"силою\" $\\alpha$, тож і ймовірнісна міра змінюється пропорційно розмірам вікон $\\varepsilon$\n\n:::\n\n::: {#fig-alpha-dependence}\n\n![](Images\\lab_7\\alpha.jpg){width=8cm, height=8cm}\n\nСхематичне представлення залежності сили сингулярності та густини порівняно з околицями \n\n:::\n\nСірий масштаб являє собою ймовірнісну міру для кожної локації, як показано на кожній панелі. На рисунку (a) тільки $i$-та локація має ненульову щільність, інші місця порожні. Імовірнісна міра на комірці залишається $\\rho$, навіть коли розмір клітинки $\\varepsilon$ збільшується. $\\varepsilon$ збільшується, що підкреслюється жирною лінією. Проте, через те, що далі ми не спостерігаємо зростання щільності, показник $\\alpha$ залишається нульовим. На [@fig-alpha-dependence] (b) усі комірки мають однакову щільність. Імовірнісні міри комірок дорівнюють $\\rho$, $9\\rho$ і $25\\rho$ для найменшої, другої найменшої та найбільшої комірки (виділено жирною лінією). Таким чином, сила сингулярності $i$-го осередку дорівнює 2. На [@fig-alpha-dependence] (c) $i$-й осередок є розрідженим порівняно з навколишніми осередками. Імовірнісна міра осередків дорівнює $\\rho$, $27\\rho$ і $125\\rho$ для найменшого, другого найменшого і найбільшого осередку (виділено жирною лінією). Таким чином, сила сингулярності $i$-ої комірки дорівнює 3.\n\n::: {.callout-tip}\n## Додатково по $\\alpha$\n\nМожна сказати, що чим більш гладкою видається поверхня системи, чим менше елементів задіяно в її розвитку, тим меншим є показник сингулярності. Що більше елементів системи вступають у взаємозв'язок один з одним, що більше процесів протікає під час еволюції системи, то більшим є показник сингулярності\n\n:::\n\n\nВідомо, що для регулярного (однорідного) фрактала всі показники ступеня $\\alpha_{i}$ однакові й рівні фрактальній розмірності $D$:\n\n$$\np_{i} = 1 \\big/ N(\\varepsilon) \\approx \\varepsilon^{D}.\n$$\n\nУ даному випадку статистична сума [@eq-1] приймає наступний вигляд:\n\n$$\nZ(q,\\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon) = N(\\varepsilon)\\varepsilon^{Dq}=\\varepsilon^{-D}\\varepsilon^{Dq} \\approx \\varepsilon^{D(q-1)}. \n$$\n\nТому $\\tau(q)=D(q-1)$ і всі узагальнені фрактальні розмірності $D_{q}=D$ у цьому випадку співпадають та не залежать від $q$. \n\nОднак, для такого складного об'єкта, як мультифрактал, унаслідок його неоднорідності, ймовірності заповнення клітинок $p_{i}$ у загальному випадку різняться, і показник ступеня $\\alpha_{i}$ для різних клітинок може приймати різні значення. Достатньо типовою є ситуація, коли ці значення неперервно заповнюють деякий закритий інтервал $\\left( \\alpha_{min}, \\alpha_{max} \\right)$, причому $p_{min} \\approx \\varepsilon^{\\alpha_{max}}$, a $p_{max} \\approx \\varepsilon^{\\alpha_{min}}$.\n\nТепер перейдемо до питання розподілу ймовірностей різних значень $\\alpha_{i}$. Нехай $n(\\alpha)d\\alpha$ є ймовірністю того, що $\\alpha_{i}$ знаходиться в інтервалі від $\\alpha$ до $\\alpha+d\\alpha$. Іншими словами, $n(\\alpha)d\\alpha$ представляє собою відносну кількість клітинок $i$, що характеризуються однією і тією самою мірою $p_{i}$ з $\\alpha_{i}$, що лежать у цьому інтервалі. У випадку монофрактала, для котрого всі $\\alpha_{i}$ однакові (і рівні фрактальній розмірності $D$), це число, очевидно, пропорційно повній кількості клітинок $N(\\varepsilon) \\approx \\varepsilon^{-D}$, степеневим чином залежних від розміру клітинки $\\varepsilon$. Показник степеня в цьому співвідношені визначається фрактальною розмірністю множини $D$. \n\nДля мультифрактала, однак, це не так, і різні значення $\\alpha_{i}$ зустрічаються з ймовірністю, що характеризується не однією і тією ж величиною $D$, а різними (в залежності від $\\alpha$) значеннями показниками степеня $f(\\alpha)$, \n\n$$\nn(\\alpha) \\approx \\varepsilon^{-f(\\alpha)}.\n$$ {#eq-5}\n\nТаким чином, фізичний сенс функції $f(\\alpha)$ полягає в тому, що вона представляє собою розмірність Хаусдорфа деякої однорідної підмножини $\\Omega_{\\alpha}$ із вихідної множини $\\Omega$, що характеризується однаковими ймовірностями заповнення клітинок $p_{i} \\approx \\varepsilon^{\\alpha}$. Оскільки фрактальна розмірність підмножини очевидно завжди менша або рівна фрактальній розмірності вихідної множини $D_{0}$, має місце важлива нерівність для функції $f(\\alpha)$:\n\n$$\nf(\\alpha) \\leq D_{0}. \n$$\n\nУ результаті можна зробити висновок, що множина різних значень функції $f(\\alpha)$ (при різних $\\alpha$) представляє собою **спектр фрактальних розмірностей** [@PhysRevA.33.1141;@frisch1985turbulence] однорідних підмножин $\\Omega_{\\alpha}$, на які можна розбити вихідну множину $\\Omega$, кожна з яких характеризується власним значенням фрактальної розмірності $f(\\alpha)$. \n\n\n#### Перетворення Лежандра\n\nВстановимо зв'язок функції $f(\\alpha)$ із введенною раніше функцією $\\tau(q)$. Обчислимо для цього статистичну суму $Z(q,\\varepsilon)$. Підставляючи у $Z(q,\\varepsilon)$ ймовірності $p_i \\approx \\varepsilon^{\\alpha_i}$, та переходячи від підсумовування по $i$ до інтегрування по $\\alpha$ з щільністю ймовірностей ([-@eq-5]), отримаємо\n\n$$\nZ(q,\\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)} p_{i}^{q}(\\varepsilon) \\approx \\int d\\alpha n(\\alpha)\\varepsilon^{q\\alpha} \\approx \\int d\\alpha\\varepsilon^{q\\alpha-f(\\alpha)}. \n$$ {#eq-6}\n\nТак як величина $\\varepsilon$ дуже мала, основний внесок у цей інтеграл вноситимуть ті значення $\\alpha(q)$, при яких показник степеня $q\\alpha-f(\\alpha)$ виявляється мінімальним (а підінтегральна функція --- максимальною). Цей вклад буде пропорційним значенню підінтегральної функції у точці максимума. Саме ж значення $\\alpha(q)$ визначається при цьому з наступної умови:\n\n$$\n\\left. \\frac{d}{d\\alpha}[ q\\alpha-f(\\alpha) ] \\right \\vert_{\\alpha=\\alpha(q)} = 0. \n$$\n\nТакож, з умови мінімуму ми маємо\n\n$$\n\\left. \\frac{d^{2}}{d\\alpha^{2}}[ q\\alpha-f(\\alpha) ] \\right \\vert_{\\alpha=\\alpha(q)} > 0. \n$$\n\nУ результаті отримуємо, що залежність $\\alpha(q)$ неявним чином визначається з $q = df(\\alpha) \\big/ d\\alpha$, і що функція $f(\\alpha)$ усюди є випуклою:\n\n$$\nf^{''}(\\alpha)>0.\n$$\n\nЦе значить, що величина $f(\\alpha(q))$ дійсно є фрактальною розмірністю підмножини $\\Omega_{\\alpha(q)}$, що має найбільший домінуючий внесок у статистичну суму ([-@eq-6]) при заданій величині показника ступеня $q$. \n\nОскільки $Z(q,\\varepsilon)=\\tau(q)$, приходимо до висновку, що \n\n$$\n\\tau(q) = q\\alpha(q) - f(\\alpha(q)). \n$$ {#eq-7}\n\nПам'ятаючи, що $\\tau(q)=D(q-1)$, можемо віднайти функцію $D_{q}$: \n\n$$\nD_{q} = \\frac{1}{q-1}[ q\\alpha(q)-f(\\alpha(q)) ]. \n$$ {#eq-8}\n\nТаким чином, якщо ми знаємо функцію мультифрактального спектра $f(\\alpha)$, то за домомогою співвідношень ([-@eq-8]) та ([-@eq-9]) ми можемо знайти функцію $D_{q}$. Навпаки, знаючи $D_{q}$, ми можемо відтворити залежність $\\alpha(q)$ за допомогою рівняння\n\n$$\n\\alpha(q) = \\frac{d}{dq}[(q-1)D_{q}]\n$$ {#eq-9}\n\nі після цього знайти із ([-@eq-9]) $f(\\alpha(q))$. Ці два рівняння і визначають функцію $f(\\alpha)$. \n\n$$\n\\frac{d\\tau}{dq}\\frac{dq}{d\\alpha} = q + \\alpha\\frac{dq}{d\\alpha} - \\frac{df}{d\\alpha}.\n$$\n\nПриймаючи до уваги, що $q=df/d\\alpha$, і скорочуючи це рівняння на $dq/d\\alpha$, приходимо до співвідношення \n\n$$\n\\alpha = \\frac{d\\tau(q)}{dq},\n$$\n\nяке еквівалентне ([-@eq-9]). \n\nВирази для $\\tau(q)$ та $\\alpha(q)$ задають **перетворення Лежандра** [@GRASSBERGER1983227;@HALSEY1987501] від змінних $\\{ q, \\tau(q) \\}$ до змінних $\\{\\alpha, f(\\alpha)\\}$: $\\alpha = d\\tau \\big/ dq$ та $f(\\alpha) = q\\left( d\\tau \\big/ dq \\right) - \\tau(q)$. Як відомо, для однорідного фрактала $D_{q}=D=\\text{const}$. Тому $\\alpha=d\\tau/dq=D$ і $f(\\alpha)=q\\alpha-\\tau(q)=qD-D(q-1)=D$. У цьому випадку \"графік\" функції $f(\\alpha)$ на площині $\\left( \\alpha, f(\\alpha) \\right)$ складається лише з однієї точки  $\\left( D, D \\right)$. \n\n### Мультифрактальний аналіз детрендованих флуктуацій\n\nМонофрактальні та мультифрактальні структури фінансових сигналів є особливим різновидом масштабно-інваріантних структур. Найчастіше монофрактальна структура фінансових часових рядів визначається одним степеневим показником і передбачає, що масштабо-інваріантність не залежить від часу і простору. Однак, часто ми маємо змогу спостерігати просторово-часову варіацію масштабно-інваріантної структури досліджуваної складної системи. Ці просторово-часові варіації вказують на мультифрактальність фінансового сигналу, яка визначається мультифрактальним спектром. Мультифрактальний спектр може допомогти кількісно визначити асиметрію підйомів та спадів на фондовому чи криптовалютному ринках, передбачити фінансову кризу, що поступово наближується, і, таким чином, сприяти успішності подальших торгівельних рішень. Основна мета цього розділу --- представити одну з найточніших процедур для визначення множини фрактальних показників --- **мультифрактальний аналіз детрендованих флуктуацій** (multifractal detrended fluctuation analysis, MFDFA) [@KANTELHARDT2001441;@Kantelhardt2011;@KANTELHARDT200287], котрий і досі залишається одним із найпотужніших методів для аналізу систем різної природи та складності [@Dutta_2010; @MAIORINO2015302; @FIGUEIREDO20102090; @Jafari_2012; @Jiang_2019; @Telesca_2005; @doi:10.1080/00045608.2011.592733; @Liao_2011; @TELESCA2005629; @PhysRevE.84.021103; @MALI201525; @Pedron_2010; @Rak_2015; @WATOREK20211].\n\nПобудова MFDFA складається з 9 кроків:\n\n1. *\"Шум і випадкові блукання у часовому ряді\"* представляє метод приведення часового ряду до такого, що подібний до випадкового блукання. \n2. *\"Обчислення середньоквадратичної варіації часового ряду\"* представляє середньоквадратичну варіацію, яка є основною процедурою для подальших обчислень в MFDFA і типовим способом обчислення середньої варіації часових рядів різної природи. \n3. *\"Локальна середньоквадратична варіація часового ряду\"* представляє обчислення локальної варіації часового ряду як середньоквадратичного відхилення часового ряду в межах сегментів, що можуть як перекриватися, так і не перекриватися. \n4. *\"Локальне детрендування часового ряду\"* представляє обчислення такого ж локального середньоквадратичного відхилення навколо трендів, які часто зустрічаються у фінансових часових рядах. \n5. *\"Монофрактальний аналіз детрендованих флуктуацій\"*: амплітуди локальних середніх квадратичних відхилень підсумовуються в узагальнене середнє квадратичне відхилення. У сумарному середньоквадратичному відхиленні для сегментів з малими розмірами вибірки переважають швидкі флуктуації часового ряду. На противагу цьому, у сумарному середньоквадратичному відхиленні для сегментів з великими розмірами вибірки переважають повільні коливання. Степенева залежність між загальним середнім квадратичним відхиленням для декількох розмірів вибірки (тобто масштабів) визначається за допомогою монофрактального аналізу дентрендованих флуктуацій (monofractal detrended fluctuation analysis, DFA) і називається показником Херста (Hurst exponent, $H$). \n6. *\"Мультифрактальний аналіз детрендованих флуктуацій\"*: MFDFA отримують шляхом розширення на $q$-й порядок узагальненого середньоквадратичного відхилення. Середньоквадратичне відхилення $q$-го порядку може розрізняти сегменти з малими та великими флуктуаціями. Степенева залежність між середньоквадратичним відхиленням $q$-го порядку чисельно визначається як узагальнейний показник Херста $q$-го порядку. \n7. *\"Мультифрактальний спектр часових рядів\"*: на основі показника Херста $q$-го порядку обчислено декілька мультифрактальних спектрів. \n8. *\"Узагальнені фрактальні розмірності\"* представляє більш детальний опис показників $D_{q}$, що будуть описані в подальшому.\n9. *\"Аналогії мультифракталів із термодинамікою\"* показує, що отримані кількісні мультифрактальні показники мають зв'язок із термодинамічними показниками, що дозволило нам вивести мультифрактальну \"теплоємність\". \n\nДля подальшої візуалізації кожного кроку процедури MFDFA імпортуємо наступні модулі:\n\nІ виконаємо налаштування рисунків для виведення:\n\nЦього разу розглянему можливість побудови індикаторів або індикаторів-передвісників на прикладі індексу сирої нафти West Texas Intermediate (WTI). При описі процедури MFDFA порівнюватимемо мультифрактальність даного ряду зі штучно згенерованими монофрактальними рядами, складність яких, очевидно, має бути меншою.\n\nСам сайт Yahoo! Finance містить досить коротку історію щодених цін на нафту даної марки. Цього разу, в якості альтернативного прикладу, будемо послуговуватись альтернативним джерелом фінансових даних --- [федеральним резервом економічних даних федерального резервного банку Сент-Луїса](https://fred.stlouisfed.org) (Federal Reserve Economic Data of the Federal Reserve Bank of St. Louis, FRED). На Python було створено бібліотеку для вивантаження даних із даного джерела --- `pandas-datareader`. Для її встановлення достатньо прописати наступну команду:\n\nТепер імпортуємо відповідну бібліотеку:\n\nта виконаємо зчитування індексу з FRED, використовуючи функціонал даної бібліотеки. Завантажимо дані за весь період, що нам буде доступний:\n\nВиведемо досліджуваний ряд:\n\nРозглянемо опис нашого масиву даних:\n\nНа представленому рисунку видно, що в значеннях досліджуваного індексу існують пропуски та негативні значення на ціну нафти. Для того, щоб позбутися від'ємного значення, можна виконати заміну значення на таке, що близьке до нуля. Для видалення значень `NaN` достатньо скористатися методом `dropna()` бібліотеки `pandas`.\n\nЗнову візуалізуємо результат:\n\nОстаннє, що нам залишається, це приведення вихідного ряду до прибутковостей. Для цього визначимо функцію `transformation()` та знайдемо з її допомогою прибутковості: \n\nЯк вже зазначалося, при описі процедури MFDFA, ми будемо послуговуватись для порівняння і монофрактальними сигналами. Для подальших розрахунків згенеруємо сигнал білого та рожевого шумів. У цьому нам може допомогти функція `signal_noise()` бібліотеки `neurokit2`. Ця функція генерує чистий гаусовий `(1/f)**beta` шум. Спектр потужності згенерованого шуму пропорційний `S(f) = (1/f)**beta`. Було описано наступні категорії шуму: \n\n- фіолетовий шум: beta = -2;\n- синій шум: beta = -1;\n- білий шум: beta = 0;\n- флікер/рожевий шум: beta = 1;\n- коричневий шум: beta = 2.\n\nЇї синтаксис:\n\n**`signal_noise(duration=10, sampling_rate=1000, beta=1, random_state=None)`**\n\n**Параметри:**\n\n- **duration** (*float*) --- бажана тривалість (у секундах);\n- **sampling_rate** (*int*) --- бажана частота дискретизації (у Гц, тобто відліків на секунду);\n- **beta** (*float*) --- експонента шуму;\n- **random_state** (*None, int, numpy.random.RandomState або numpy.random.Generator*) --- початкове значення (зерно) для генератора випадкових чисел.\n\n**Повертає:**\n\n- **noise** (*array*) --- сигнал чистого шуму.\n\nТепер можемо згенерувати 2 види шумів:\n\n#### Шум і випадкові блукання у часовому ряді\n\nМультифрактальний аналіз детрендованих флуктуацій базується на класичному аналізі детрендованих флуктуацій (DFA). Класичний DFA застосовується до часових рядів зі структурою, подібною до випадкових блукань [@Peng_1995]. Однак більшість фінансових часових рядів мають коливання, які більш схожі на прирости випадкових блукань. Якщо фінансовий часовий ряд має структуру, подібну до шуму, як у прибутковостей, його слід перетворити на випадково-блукаючий часовий ряд перед застосуванням DFA. Шуми можна перетворити на випадкові блукання шляхом віднімання середнього значення та інтегрування часового ряду (знаходження його кумулятивної суми). Часовий ряд з білим шумом, монофрактал (рожевий шум) і мультифрактал є шумовими часовими рядами і перетворюються на випадкові блукання за допомогою коду, наведеного на [-@fig-step-1]:\n\n#### Обчислення середньоквадратичної варіації часового ряду \n\nТрадиційний аналіз варіації часових рядів полягає в обчисленні середнього значення варіації як середньоквадратичного відхилення. Читач може скористатися наведеним нижче кодом для обчислення середньоквадратичного відхилення для часових рядів з білим шумом, монофрактальних і мультифрактальних даних:\n\n@fig-step-2 ілюструє, що середня амплітуда варіації (тобто середньоквадратичне відхилення) є однаковою для всіх трьох часових рядів, навіть якщо вони мають досить різну структуру. MFDFA може розрізняти ці структури.\n\n#### Локальна середньоквадратична варіація часового ряду\n\nМультифрактальні часові ряди на верхній панелі мають локальні флуктуації різної величини. Середньоквадратичне відхилення (RMS) у попередньому коді можна обчислити для сегментів часового ряду, щоб розрізнити величини локальних флуктуацій. Проста процедура полягає в тому, щоб розділити часовий ряд на однакові за розміром сегменти, що не перекриваються, і обчислити локальне середнє квадратичне відхилення для кожного сегмента. Це можна зробити за допомогою коду наведеного нижче:\n\nПерший рядок коду функції `calc_rms()` перетворює зашумлений часовий ряд, мультифрактал, на часовий ряд випадкового блукання $X$. Третій рядок коду задає масштаб параметра, який визначає розмір вибірки сегментів, що не перетинаються, для яких обчислюється локальне середнє квадратичне відхилення, `RMS`. П'ятий рядок --- це кількість сегментів, на які можна розбити часовий ряд $X$, де `len(X)` --- розмір вибірки часового ряду $X$. Таким чином, `segments = 6` при `len(X) = 9335` і `scale = 1335`. З дев'ятого по шістнадцятий рядки --- це цикл, що обчислює локальне середньоквадратичне значення навколо тренду `fit[v]` для кожного сегмента, оновлюючи часовий індекс. У першому циклі `v = 0`, `Index[0]` переходить від 0 до 1335 значення сегмента (не включно). У другому циклі $v = 1$, `Index[1]` переходить від 1335 до 2670 значення другого сегмента. В останньому циклі $v = 6$, `Index[6]` переходить від 8010-го до 9345-го значення (не включно).\n\n#### Локальне детрендування часового ряду\n\nУ складних системах наявні повільні мінливі тренди, тому для кількісної оцінки масштабо-інваріантності флуктуацій навколо цих трендів необхідно провести детрендування сигналу. У попередньому коді до $X$ на кожному сегменті $v$ підбирається поліноміальний тренд `fit[v]`. Параметр $m$ визначає порядок полінома. Поліноміальний тренд є лінійним, якщо $m = 1$, квадратичним, якщо $m = 2$, і кубічним, якщо $m = 3$. Рядок `C = np.polyfit(Index[v], X[Index[v]], m)` визначає коефіцієнти полінома `C`, які використовуються для створення поліноміальної залежності тренду `fit[v]` для кожного сегмента. Потім для залишкової варіації, `X(Index[v])-fit[v]`, обчислюється локальне середньоквадратичне відхилення, `RMS[v]`, в межах кожного сегмента $v$. Локальна середньоквадратична варіація, `RMS[v]`, представлена на [@fig-step-3] як відстань між червоними пунктирними трендами і червоними суцільними лініями.\n\n#### Монофрактальний аналіз детрендованих флуктуацій\n\nУ DFA варіації локального середньоквадратичного відхилення кількісно оцінюються загальним середньоквадратичним відхиленням ($F$).\n\nШвидкі коливання часового ряду $X$ впливатимуть на загальне середньоквадратичне відхилення $F$ у сегментах малої довжини (масштабу), тоді як повільні коливання впливатимуть на $F$ у сегментах великої довжини (масштабу). Таким чином, функція флуктуацій $F$ повинна бути обчислена для декількох масштабів, щоб виокремити вплив як швидкоплинних, так і повільних коливань, які у свою чергу визначають структурні перетворення часового ряду. Функція флуктуацій $F(ns)$ може бути обчислена для декількох масштабів шляхом модифікації попереднього коду:\n\nDFA визначає монофрактальну структуру часового ряду відповідно до степеневої залежність між загальним середнім квадратичним відхиленням (тобто $F$), обчисленим для декількох масштабів. Степенева залежність між загальним середнім квадратичним відхиленням позначається нахилом ($H$) лінії регресії, розрахованим за допомогою наступного коду:\n\nМодифікуємо попередній код, додавши нові фрагменти:\n\nТепер розглянемо залежність загальної функції флуктуацій $F$ від різних довжин (масштабів) локальних сегментів ряду для досліджуваних нами рядів:\n\nПоказник Херста визначає монофрактальну структуру часового ряду, вказуючи, наскільки швидко зростає загальне середньоквадратичне відхилення $F$ локальних коливань `RMS` зі збільшенням розміру локальних сегментів ряду (тобто, масштабу). [@fig-step-6] показує, що загальне середньоквадратичне значення локальних флуктуацій $F$ у порівнянні з індексом нафти та білим шумом зростає швидше зі збільшенням розміру вибірки сегментів для монофрактального рожевого шуму. [@fig-hurst] ілюструє, що показник Херста визначає континуум між часовими рядами, подібними до шуму, і часовими рядами, подібними до випадкового блукання. Показник Херста знаходиться в інтервалі від 0 до 1 для зашумлений часових рядів, тоді як для часових рядів, подібних до випадкових блукань, він перевищує 1. Часовий ряд має довгострокову залежну (тобто корельовану) структуру, коли показник Херста знаходиться в інтервалі 0.5-1, і антикорельовану структуру, коли показник Херста знаходиться в інтервалі 0-0.5. Часовий ряд має незалежну або короткострокову залежну структуру в окремому випадку, коли показник Херста дорівнює 0.5. Згідно з попереднім рисунком, часові ряди білого шуму та нафти представляються непередбачуваними, оскільки показник Херста близький до 0.5, тоді як рожевий шум довгостроково залежну структуру з показником Херста близьким до 1.\n\n#### Мультифрактальний аналіз детрендованих флуктуацій\n\nСтруктури монофрактального та мультифрактального часових рядів відрізняється, хоча вони мають схожі загальні середньоквадратичні значення. Мультифрактальні часові ряди містять локальні флуктуації як з екстремально малими, так і з екстремально великими значеннями, що не характерно для монофрактальних часових рядів. Відсутність флуктуацій з екстремально великими та малими значеннями призводить до нормального розподілу для монофрактального часового ряду, де варіація описується лише статистичним моментом другого порядку (дисперсією). Отже, монофрактальний DFA базується на статистиці другого порядку загального середньоквадратичного відхилення (тобто, $F\\,$). У мультифрактальному часовому ряді локальні коливання, `RMS[ns][v]`, будуть екстремально великими для сегментів $v$ в межах часових періодів великих коливань і екстремально малими для сегментів $v$ в межах часових періодів малих коливань. Отже, мультифрактальні часові ряди не є нормально розподіленими і слід враховувати всі статистичні моменти $q$-го порядку. Таким чином, необхідно розширити загальне середньоквадратичне значення монофрактального DFA до середньоквадратичної функції флуктуацій $q$-го порядку мультифрактального DFA $(F_{q})$:\n\nУ новому блоці коду запускається цикл, який обчислює загальне середньоквадратичне значення $q$-порядку $F_{q}(nq)$ від від'ємних до додатних $q$. Порядок $q$ зважує вплив сегментів ряду з великими та малими коливаннями, `RMS`, як показано на наступному рисунку. На величину $F_{q}(nq)$ для від'ємних $q$ впливають сегменти $v$ з малими `RMS(v)`. Навпаки, на $F_{q}(nq)$ для додатних $q$ впливають відрізки $v$ з великими `RMS(v)`. Локальні флуктуації `RMS` з великими та малими величинами класифікуються за величиною від'ємного або додатного порядку $q$ відповідно. На $F_{q}$ для $q = -3$ і $3$ більше впливають відрізки $v$ з найменшим і найбільшим `RMS(v)`, відповідно, порівняно з $F_{q}$ для $q = -1$ і $1$. Середня точка $q = 0$ є нейтральною щодо впливу відрізків з малим та великим `RMS`. Зверніть увагу, що в останньому рядку коду нового блоку перевизначено окремий випадок $q(nq) = 0$, оскільки $1/0$ прямує до нескінченності (тобто, $1/q(q = 0) = \\infty$). Читач також повинен помітити, що $F_{q}[q == 2]$ дорівнює статистиці другого порядку $F$, оскільки $\\sqrt{x} = x^{1/2}$. Монофрактальний DFA тепер розширюється до MFDFA.\n\n`qRMS` на [@fig-step-7] --- це $q$-порядок локальних флуктуацій (тобто, `RMS`) і є складовою частиною загального$q$-порядку `RMS` (тобто, $F_{q}$). `qRMS` представлено для монофрактального (зелена смуга) та мультифрактальних (синя смуга) часових рядів. Від'ємний порядок $q$ ($q = -3$ і $-1$) підсилює сегменти в мультифрактальному часовому ряді з екстремально малими `RMS`, тоді як додатний порядок $q$ ($q = 3$ і $1$) підсилює відрізки з екстремально великими `RMS`. Зверніть увагу, що $q = -3$ і $q = 3$ підсилюють малу і велику варіацію відповідно більше, ніж $q = -1$ і $q = 1$. Зауважте також, що монофрактальний часовий ряд не має відрізків з екстремально великими або малими коливаннями і, таким чином, не має піків у `qRMS`. Загальне середньоквадратичне відхилення $q$-го порядку здатне розрізняти структуру малих і великих флуктуацій і, відповідно, монофрактальних і мультифрактальних часових рядів. \n\nТепер можна визначити показники Херста $q$-го порядку як нахили $h(q)$ ліній регресії для кожного середньоквадратичного значення $F_{q}$ $q$-го порядку. І $h(q)$, і лінія регресії визначаються в циклі для кожного $q$-го порядку:\n\nМожемо бачити, що узагальнена функція флуктуацій для мультифракталу залежить не лише від масштабу, але й від $q$, що демонструють різні нахили ліній регресії $h(q)$. Масштабуючі узагальнені функції флуктуацій $F_{q}$ для монофракталу та білого шуму є $q$-незалежними, оскільки їх лінії регресії для різних масштабів мають один і той самий кут нахилу. Показник Херста $q$-го порядку $h(q)$ для мультифрактального ряду (синя лінія) представляється незалежним для $q<0$ і змінним для $q>0$. Це вказує на те, що джерелом мультифрактальності нафти є аномально великі флуктуацій як, наприклад, криза коронавірусної пандемії. Для монофракталу (рожева лінія) та білого шуму (червона лінія) $h(q)$ залишаються сталими. \n\n#### Мультифрактальний спектр часових рядів\n\nПоказник Херста $q$-го порядку $h(q)$ є лише одним з декількох типів масштабних показників, що використовуються для параметризації мультифрактальної структури часових рядів. Як уже було представлено попередньо, ми можемо вивести показник маси $q$-го порядку ($\\tau(q)$), а потім через $\\tau(q)$ отримати показник сингулярності $q$-го порядку ($\\alpha(q)$) і фрактальну розмірність ($f(\\alpha)$) флуктуацій (областей) із ступенем сингулярності $\\alpha(q)$. Графік залежності $\\alpha(q)$ від $f(\\alpha)$ представляє мультифрактальний спектр. Показники маси, сингулярності та фрактальності можна обчислити згідно коду, що наведений нижче:\n\nПоказники сингулярності $\\alpha$ для великих висококонцентрованих флуктуацій малі й розташовані в лівому хвості спектра, тоді як $\\alpha$ для малих флуктуацій великі й розташовані в правому хвості спектра.\n\nТаким чином, сила мультифрактальності описується великим відхиленням експоненти локальної сингулярності $\\alpha$ від центральної тенденції $\\alpha(0)$. Монофрактальний сигнал --- це випадок, коли $\\alpha$ залишається майже константною, і в деяких випадках мультифрактальний спектр зводиться до однієї точки за даною $\\alpha$. \n\nДіапазон $\\alpha$ вказує на різноманітність експонент сингулярності, що описують динаміку системи, а величина $f(\\alpha)$ вказує на величину внеску елементів із відповідним показником $\\alpha$.\n\nМультифрактальний спектр може характеризуватися різною шириною, що вказує на варіативність процесів, що відбуваються всередині системи. Так само він може бути як симетричним, так і асиметричним. Асиметрія буває як правосторонньою, так і лівосторонньою, що вказує на різний ступінь впливу висококонцентрованих і низькоконцентрованих елементів (флуктуацій). Мультифрактальний спектр матиме довгий лівий хвіст, коли часовий ряд має мультифрактальну структуру, чутливу до локальних флуктуацій з великими амплітудами. \n\nНавпаки, мультифрактальний спектр матиме довгий правий хвіст, коли він чутливий до локальних флуктуацій з малими амплітудами.\n\nПроілюструємо залежність ширини спектра мультифрактальності від рівня флуктуацій у ряді. Дану залежність будемо демонструвати на прикладі рядів, що розподілятимуться згідно [альфа-стабільному розподілу Леві](https://en.wikipedia.org/wiki/Stable_distribution), який ми ще розглядатимемо в наступних роботах. Для генерації випадкових величин із даного розподілу, використовуватимемо модуль `scipy.stats`. З нього імпортуємо клас `levy_stable` для використання методу `rvs()`. Метод приймає показник $\\alpha$, що відповідає за частоту виникнення подій, що виходять за межі нормального розподілу. Розглянемо діапазон таких значень $\\alpha$ та спектри згенерованих рядів. \n\nСистема, складність якої зумовлена висококонцентрованими елементами, матиме чітко виражений лівосторонній спектр. Складність системи, що зумовлена слабко концентрованими елементами, характеризує правий хвіст мультифрактального спектра. Якщо складність системи розвивається за рахунок елементів двох типів, тоді спектр представлятиметься симетричним, де  елементи двох типів будуть рівноймовірними. Для згенерованих вище Леві альфа-стабільних процесів видно, що чим нижче значення $\\alpha$, тим сильніша домінація висококонцентрованих (великих) флуктуацій.  При $\\alpha=2.0$ спектр усе сильніше звужується до сингулярної точки. \n\nДалі буде показано, що для отриманої мультифрактальної параболи мультифрактального спектра можуть бути розраховані показники як всієї ширини спектра $(\\Delta\\alpha)$, так і окремо його правого та лівого хвостів ($R$ та $L$). Також можна розрахувати значення сингулярності, де $f(\\alpha)$ приймає максимальне значення $\\alpha_0$, і навіть так звану \"асиметрію\" цього спектра $(\\Delta f)$. На [@fig-alpha-indicators] схематично представлено положення ключових індикаторів мультифрактальності спектра. \n\n::: {#fig-alpha-indicators}\n\n![](Images\\lab_7\\f_alpha.jpg)\n\nГрафік мультифрактального спектра із відміченними на ньому показниками ширини спектра мультифрактальності ($\\Delta\\alpha$), значень мінімальної, центральної та максимальної сингулярності ($\\alpha_{min}, \\alpha_0, \\alpha_{max}$), ширини лівого та правого хвостів спектра ($L, R$) та різниці між фрактальними розмірностями в кінцях параболи ($\\Delta f$)\n\n:::\n\nТакож варто зазначити, що дана схема не представляє вичерпний список індикаторів мультифрактальності системи, що ми використовуватимемо в подальшому, але має надавати інтуїтивне розуміння того, як виводиться більшість мультифрактальних показників. \n\n#### Узагальнені фрактальні розмірності\n\nНаряду з мультифрактальним спектром корисно буде розглянути спектр узагальнених фрактальних розмірностей або по іншому, *розмірностей Реньї*, оскільки вони також мають інформаційно-теоретичне значення. З'ясуємо фізичний сенс узагальнених фрактальних розмірностей для деяких значень $q$. При $q=0$, $Z(0, \\varepsilon) = N(\\varepsilon)$. З іншого боку, можна визначити, що $Z(0, \\varepsilon) \\approx \\varepsilon^{\\tau(0)} = \\varepsilon^{-D_{0}}$. Співставляючи зазначені рівності, можемо прийти до співвідношення $N(\\varepsilon) \\approx \\varepsilon^{-D_{0}}$. Отже, величина $D_{0}$ представляє собою звичайну хаусдорфову розмірність множини $\\Omega$. Також вона відповідає максимуму мультифрактального спектра, $f(\\alpha)$, що завжди дорівнює одиниці для одновимірного сигналу. Для задач розпізнавання кризових явищ ця характеристика є найгрубішою і не несе інформації про статистичні властивості системи. \n\nТепер з'ясуємо сенс величини $D_{1}$. Оскільки при $q=1$ статистична сума $Z(1, \\varepsilon) = 1$, то $\\tau(1)=0$. Таким чином, ми маємо невизначеність, коли $D_{1}=\\tau(1)/(1-1)$. Розкриємо цю невизначеність за допомогою наступної рівності:\n\n$$\nZ(q, \\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)} p_{i}^{q} = \\sum_{i=1}^{N(\\varepsilon)} p_{i}\\exp{[(q-1)\\ln{p_{i}}]}. \n$$\n\nТепер, спрямовуючи $q \\to 1$, розкладаючи експоненту і враховуючи умову нормування ймовірностей $p_{i}$, отримуємо \n\n$$\nZ(q \\to 1, \\varepsilon) \\approx \\sum_{i=1}^{N(\\varepsilon)} [p_{i} + (q-1)p_{i}\\ln{p_{i}}] = 1 + (q-1)\\sum_{i=1}^{N(\\varepsilon)} p_{i}\\ln{p_{i}}. \n$$\n\nУ результаті ми приходимо до наступного виразу:\n\n$$\nD_{1} = \\lim_{\\varepsilon \\to 0} \\sum_{i=1}^{N(\\varepsilon)}p_{i}\\ln{p_{i}} \\bigg/ \\ln{\\varepsilon}. \n$$\n\nЗ точністю до знака, чисельник у цій формулі представляє собою **інформаційну ентропію** фрактальної множини $S(\\varepsilon)$: \n\n$$\nS(\\varepsilon) = -\\sum_{i=1}^{N(\\varepsilon)}p_i\\ln{p_i}. \n$$\n\nТаким чином, результуюча величина узагальненої фрактальної розмірності $D_{1}$ пов'язана з ентропією $S(\\varepsilon)$ наступним співвідношенням:\n\n$$\nD_{1} = - \\lim_{\\varepsilon \\to 0} S(\\varepsilon) \\big/ \\ln{\\varepsilon}.\n$$\n\nПовертаючись до задачі розподілу точок на фрактальній множині $\\Omega$, можно сказати, що оскільки $S(\\varepsilon) \\approx \\varepsilon^{-D_1}$, величина $D_{1}$ характеризує інформацію, необхідну для опису положення точки в деякій комірці. \n\n::: {.callout-tip}\n## Додаткова інформація по інформаційній розмірності\n\nІнформаційна розмірність може бути використана для опису просторової неоднорідності системи. Що однорідніший атрактор, то вищим має бути цей показник. Тобто, чим більшу кількість конфігурацій здатні займати елементи даної системи, тим більша кількість інформації нам потрібна для обліку кожного елемента. За просторової однорідності інформаційна ентропія так само зростає, що пов'язує інформаційну розмірність із поняттям ентропії. Оскільки $D_{1}$ це тангенс кута нахилу лінії регресії, що будується для залежності між ентропією та радіусом кіл, у яких вимірюється частота влучання окремих елементів атрактора, можна сказати, що інформаційна розмірність відображає швидкість зміни інформаційної ентропії. Чим вища $D_{1}$, тим стрімкіше зростає ентропія --- міра нашого нинішнього незнання про систему. Чим нижча $D_{1}$, тим менша сама ентропія. Інакше кажучи, тим більша просторова асиметрія, упорядкованіша складність, вищі наші знання про поточний стан системи, і тим менше інформації нам потрібно для опису тих конфігурацій, які система може займати \n\n::: \n\nДля узагальненої фрактальної розмірності при $q=2$ справедливий наступний вираз:\n\n$$\nD_{2} = \\lim_{\\varepsilon \\to 0} \\ln{\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{2}} \\bigg/ \\ln{\\varepsilon}. \n$$\n\nВеличина $p_{i}$ представляє собою ймовірність попадання точки в комірку розміром $\\varepsilon$. Тоді величина $p_{i}^{2}$ є ймовірністю попадання в цю комірку двох точок. Знаходячи суму $p_{i}^{2}$ по всім зайнятим коміркам, ми отримуємо ймовірність того, що дві навмання обрані точки з множини $\\Omega$ знаходяться всередині однієї комірки з розміром $\\varepsilon$. Отже, відстань між цима двома точками буде менше або порядку $\\varepsilon$. Ймовірність знаходження двох траєкторій у межах околиці з радіусом $\\varepsilon$ можна знайти за допомогою кореляційного інтеграла. \n\nУ такому разі ми приходимо до висновку, що узагальнена розмірність визначає залежність кореляційного інтеграла $C(\\varepsilon)$ від $\\varepsilon$. З цієї причини величину $D_{2}$ в літературі іменують **кореляційною розмірністю**.\n\nТепер проаналізуємо поведінку $f(\\alpha)$. Значення функції в максимумі легко визначити, якщо скористатися виразом ([-@eq-7]), де $\\tau(q) = q\\alpha(q) - f(\\alpha(q))$ або $(q-1)D_{q} = q\\alpha(q) - f(\\alpha(q))$. При $q=0$ ми отримаємо, що $f(\\alpha_0)=D_{0}$, тобто максимальне значення спектра дорівнює хаусдорфовій розмірності. \n\n::: {#fig-D0}\n\n![](Images\\lab_7\\D-0.jpg){width=10cm, height=10cm}\n\nМаксимум функції $f(\\alpha)$ дорівнює фрактальній розмірності $D_{0}$\n\n:::\n\nРозглянемо випадок, коли $q=1$. Оскільки $\\tau(1) = 0$, тоді з рівняння вище слідує, що $\\alpha(1) = f(\\alpha(1))$. З іншого боку ми знаємо, що оскільки $q = df(\\alpha) \\big/ d\\alpha$, похідна $f(\\alpha)$ в цій точці дорівнює 1. Диференцюючи співвідношення $\\tau(q) = (q-1)D_{q}$ по $q$, \n\n$$\n\\frac{d\\tau}{dq} = D_{q} + (q-1)D_{q}^{'} = \\alpha(q), \n$$\n\nі припускаючи, що $q=1$, ми отримуємо, що $\\alpha(1)=D_{1}$. Таким чином, ми маємо $D_{1} = \\alpha(1) = f(\\alpha(1))$. Отже, інформаційна розмірність $D_{1}$ лежить на кривій $f(\\alpha)$ в точці, де $\\alpha=f(\\alpha)$ і $f^{'}(\\alpha)=1$.\n\n::: {#fig-D1}\n\n![](Images\\lab_7\\D-1.jpg){width=10cm, height=10cm}\n\nПоложення інформаційної розмірності $D_{1}: D_{1}=\\alpha=f(\\alpha)$\n\n:::\n\nТепер розглянемо випадок, коли $q=2$. Користуючись попередньою формулою, отримаємо, що $D_{2} = 2\\alpha(2) - f(\\alpha(2))$ або $f(\\alpha(2)) = 2\\alpha(2)-D_{2}$. \n\n::: {#fig-D2}\n\n![](Images\\lab_7\\D-2.jpg){width=10cm, height=10cm}\n\nГеометричне визначення кореляційної розмірності $D_{2}$\n\n:::\n\nДалі розглянемо залежність узагальненої фрактальної розмірності $D_{q}$ від різних значень $q$ для мультифрактального ряду, монофрактального та білого шуму. \n\nЗ представленого рисунку видно, що, по-переше, для всіх сигналів $D_{0}=1$, що відповідає теоретичним міркуванням. Інформаційна розмірність $D_{1}$ для мультифрактала та білого шуму однакова, що може говорити і про інформаційну зачущість обох сигналів. Для монофрактала вона близька до нуля. Кореляційна розмірність $D_{2}$ показує, що загалом як WTI, так і білий шум доволі схожі: їх значення в більшості своїй постають незалежними один від одного. Це розбігається з тими висновками, що були зробені в попередній роботі, де наближення $D_{2}$ до нуля вказувало на зростання ступеня корельованості системи. Для монофракталу $D_{2}$ знаходиться на рівні 1, що вказує на вищий ступінь кореляцій у цьому сигналі, порівнюючи з мульти- та монофракталами.  \n\n#### Аналогії мультифракталів із термодинамікою\n\nВикористовуючи концепції MFDFA, ми можемо по-новому поглянути на часовий сигнал як на термодинамічну систему. В рамках MFDFA показник маси $\\tau(q)$ можна розглядати як аналоги вільної енергії, показник сингулярності $\\alpha$ як аналог внутрішньої енергії $U$, мультифрактальний спектр $f(\\alpha)$ як ентропію. Дійсно, форма мультифрактального спектра нагадує залежність ентропії термодинамічної системи від енергії $U$. Показники $\\alpha_{min}$ та $\\alpha_{max}$ можна охарактеризувати як верхній та нижній ліміти внутрішньої енергії системи. Функція $Z(q)$ є формальним аналогом статистичної суми $Z(\\beta)$ в термодинаміці, де $\\beta=1/T=q$.\n\n::: {#fig-alpha-dependence}\n\n![](Images\\lab_7\\multifractal-physics.jpg){width=13cm, height=13cm}\n\nСхематичне представлення аналогії мультифракталів із концепціями термодинаміки\n\n:::\n\nОкрім цього, ми можемо прорахувати \"температуру\" досліджуваного сигнала. Більш конкретно, мультифрактальну \"питому теплоємність\" $C(q)$ [@EnriqueCanessa_2000] можна визначити як \n\n$$\nC(q) \\equiv -\\left(\\partial^{2} \\tau(q) \\big/ \\partial q^{2} \\right) = -\\left(\\partial \\alpha \\big/ \\partial q \\right) \\approx \\tau(q+1) - 2\\tau(q) + \\tau(q-1). \n$$\n\nПитома теплоємність, як міра швидкості зміни енергії, слугує індикатором явищ фазового переходу. У термодинамічній системі фаза характеризується однорідними фізичними властивостями, а фазовий перехід --- стрибкоподібною зміною певних властивостей за критичної зовнішньої умови. Вивчення фазових переходів у мультифрактальному спектрі обмежувалося простими системами, такими як множина Кантора та логістична карта. Однак наш аналіз показує наявність фазових переходів [@RePEc:spr:eurphb:v:76:y:2010:i:4:p:513-527] у мультифрактальному спектрі фінансових систем. Зокрема, \"енергія\" $\\alpha$ виявляє значні флуктуації в околі $q_c$, які відображаються піком питомої теплоємності $C(q_c)$.\n\n@fig-step10 демонструє, що $C(q)$ досягає максимуму в діапазоні $q$ від 2 до 3, що свідчить про те, що індекс WTI стає вкрай нерегулярним через велику флуктуацію катастрофи \"COVID-19\", яка слугує квазіфазовим переходом досліджуваного індексу. Можна стверджувати, що колапс коронавірусної пандемії має найбільший вплив на мультифрактальність досліджуваного ряду.\n\n## Хід роботи \n\nЗвісно ж фрактальний аналіз усього ряду є важливим, але такий підхід ігнорує припущення про існування в часовій послідовності як монофрактальних, так і мультифрактальних ділянок. Тобто, ігнорується припущення про зміну ступеня складності з плином часу. Кількісні міри мультифрактальності, розраховані в рамках підходу ковзного вікна, є найбільш об'єктивними та практичними при аналізі систем. Окрім цього кількісні показники можуть бути використані як індикатори або індикатори-провісники аномальних явищ, або як базис для побудови іншої прогностичної моделі. \n\nПовторно зчитаємо значення ряду із сайту FRED: \n\n::: {.callout-warning}\n## Увага\n\nВиконайте цей блок, якщо хочете зчитати дані не з Yahoo! Finance або FRED, а із власного файлу. Зрозуміло, що й аналіз результатів, і висновки залежать від того з яким рядом ми працюємо \n\n:::\n\n---\n\n---\n\nВиводимо досліджуваний ряд:\n\nДеякі графіки будуть представляти парну побудову лише часового ряду та мультифрактального індикатора. Скористаємось функцією `plot_pair()`, що ми визначали в попередніх лабораторних:\n\n#### Віконна процедура\n\nДля подальших розрахунків знову скористаємось бібліотекою `fathon`, що ми використовували попередньо для виконання класичного аналізу детрендованих флуктуацій. Переваги саме цієї бібліотеки полягають у можливості використання процедури розрахунку розбиття ряду на сегменти починаючи з кінця ряду, оскільки довжина ряду не завжди дозволяє поділити його на локальні сегменти націло. Тобто, теоретично у нас залишається сегмент ряду, що не піддається розбиттю на локальні сегменти. Тому повторна процедура розбиття на локальні сегменти починаючи з кінця ряду дозволяє обійти дану проблему. Для спрощення представлення теоретичного матеріалу ми не стали імплементувати дану процедуру, але вона доступна в бібліотеці `fathon`. Окрім цього, бібліотека надає можливість обчислення крос-кореляційного аналізу детрендованих флуктуацій та його мультифрактального аналогу. \n\nПриступимо до ініціалізації параметрів.\n\nРозпочнемо процедуру рухомого вікна, що об'єднуватиме у собі попередні етапи розрахунків:\n\nЗберігаємо абсолютні значення показників до текстових файлів. \n\nПроаналізуємо динаміку отриманих індикаторів.\n\n### Ширина спектра мультифрактальності ($\\Delta\\alpha$)\n\nПершим і одним із найпрактичніших індикаторів складності системи є ширина спектра мультифрактальності, $\\Delta\\alpha$, яку можна подати як різницю між максимальним ступенем синґулярності та мінімальним:\n\n$$\n\\Delta\\alpha = \\alpha_{max} - \\alpha_{min}. \n$$ {#eq-7-1}\n\nЯкщо проводити аналогію з термодинамічними показниками, то в такому разі ширина спектра мультифрактальності становитиме різницю між найбільшим і найменшим значенням внутрішньої енергії системи. Розглянемо динаміку даного показника для ринку нафти.\n\nНа [-@fig-wti-wind-delta-alpha] видно, що ширина спектра мультифрактальності зростає під час кризових подій, що вказує на зростання загального ступеня складності та періодизації. Тобто, даний показник слугує ще одним підтвердженням, що трейдери на ринку, наприклад, нафти поводять себе у синхронній манері в ході кризи. Зростання загального ступеня мультифрактальності є індикатором зростання кореляцій в системі, що підтверджувалось і попередніми індикаторами складності.\n\n### Різниця між кінцями спектра мультифрактальності ($\\Delta f$)\n\nОднак проста ширина спектра мультифрактальності не показує, наприклад, флуктуації якого типу є найвірогіднішими, елементи якого типу щільності відіграють найбільшу роль у зростанні або зниженні складності системи. Надалі було запропоновано такий показник мультифрактальності як $\\Delta f$, який можна представити наступним чином [@DAI2014332;@DAI2016722;@SUN2001553]:\n\n$$\n\\Delta f = f(\\alpha_{min}) - f(\\alpha_{max}). \n$$ {#eq-7-2}\n\nСенс даного показника полягає в тому, що він дає нам змогу визначити ступінь імовірності появи елементів з великими щільностями і малими. Якщо цей показник менший за нуль, тоді флуктуації, що відображають елементи з найбільшою концентрацією (найбільшими фруктуаціями), мають найбільшу ймовірність. Якщо цей показник вищий за нуль, тоді флуктуації, що відображають малоконцентровані елементи (малі флуктуації), визначають динаміку системи. Якщо цей показник перебуває в нулі, тоді як високосингулярні, так і малосингулярні елементи мають рівномірний внесок у динаміку системи.\n\nЗвертаючись до термодинаміки, можна згадати, що $f(\\alpha)$ --- це ентропія системи. Тоді стає зрозуміло, що варіативність спектра мультифрактальності дає нам змогу визначити ступінь внеску висококонцентрованих і малоконцентрованих елементів у мінімізацію ентропії системи. Лівостороння асиметрія мультифрактального спектра $(\\Delta f > 0)$ підказує нам, що висококонцентровані елементи фазового простору дають найбільший внесок у мінімум термодинамічної ентропії. Іншими словами, ці елементи і є двигуном зростання впорядкованості динаміки системи. Своєю чергою, правостороння асиметрія мультифрактального спектра $(\\Delta f < 0)$ вказує на мінімізацію ентропії за рахунок малоконцентрованих елементів. Симетрія кінців спектра вказує на рівний внесок високощільних і розріджених областей на мінімізацію ентропії. Як уже згадувалося, трапляються випадки, коли мультифрактальний спектр практично сходиться в сингулярність (одну точку). У такому разі ми маємо справу з простою монофрактальною системою, яка в нашому випадку характеризувалася незалежними і нормально розподіленими випадковими величинами. Для такого спектра і $\\Delta\\alpha$, і $\\Delta f$ будуть прямувати до нуля. Для такого часового ряду вже спостерігається не множина фрактальних розмірностей, а тільки один фрактальний показник, $f[\\alpha(q=0)] = 1$. Це саме та область, де система досягає своєї термодинамічної рівноваги --- максимуму ентропії. У свою чергу $\\Delta f$ можна охарактеризувати як різницю ентропій за граничної максимальної та мінімальної внутрішньої енергії системи. \n\n### Ширина лівого ($\\Delta\\alpha_{L}$) та правого ($\\Delta\\alpha_{R}$) хвостів мультифрактального спектра\n\nКрім цього, ми можемо дослідити ступінь складності динаміки окремо високощільних областей (з великими флуктуаціями) і низькощільних (з малими флуктуаціями). Для цього виміряємо ширину окремо лівого і правого хвостів. Ширину лівого хвоста визначимо як\n\n$$\n\\Delta\\alpha_{L} = \\alpha_{0} - \\alpha_{min},\n$$ {#eq-7-3}\n\nа ширину правого хвоста як \n\n$$\n\\Delta\\alpha_{R} = \\alpha_{max} - \\alpha_{0}.\n$$ {#eq-7-4}\n\nУ свою чергу ширина лівого хвоста вимірює ступінь складності флуктуацій з великою амплітудою, а ширина правого хвоста --- малих. Зростання ширини кожного з хвостів відображатиме зростання ступеня кореляцій між елементами. \n\nІз [@fig-delta-alpha-left-right] видно, що досліджувані індикатори реагують у характерний спосіб на кризові події. Ширина лівої сторони спектра мультифрактальності зростає під час 1992, 1996-2000, 2008, 2016 років та коронавірусної пандемії. Це вказує на домінацію висококонцентрованих флуктуацій (з великою амплітудою коливань). Окрім цього, зростання ширини лівого хвоста вказує на те, що флуктуації з великою амплітудою коливань характеризуються зростанням ступеня кореляцій під час кризових подій, що в свою чергу може слугувати індикатором зростання процесів самоорганізації. \n\nХоча і меншою, але не менш примітною є динаміка ширини правого хвоста мультифрактального спектра. Цей індикатор працює майже аналогічно до ширини лівого хвоста, але характеризує динаміку малоконцентрованих величин --- флуктуацій з малою амплітудою коливань. Майже синхронна динаміка обох показників указує на зростання впливу коливань як флуктуацій з великою амплітудою коливань, так і флуктуацій з малою амплітудою коливань. Тобто, два типи флуктуацій є джерелом зростання нелінійних кореляцій під час кризових подій. \n\n### Показник сингулярності $\\alpha$ та його різновиди\n\nВ якості можливих індикаторів складності системи можна взяти $\\alpha_{min}$, $\\alpha_{max}$, $\\alpha_{mean}$ і $\\alpha_0$, які, відповідно, характеризують мінімальну силу сингулярності, максимальну, середню і сингулярність за умови рівноважного врахування як великих флуктуацій, так і малих.\n\nЯк видно з [@fig-wti-wind-alphas], усі показники сингулярності зростають в області фінансового фазового переходу зі стану стабільності до стану кризи. Це говорить про зростання складності системи: різкому прирості кількості агентів, що задіяні в самоорганізованому розвитку досліджуваної системи. З погляду термодинаміки можна було б сказати, що при фінансових крахових подіях зростає внутрішня енергія системи.  \n\n### Тип довгого хвоста мультифрактального спектра ($\\Delta S$)\n\nКрім такої міри як, наприклад, $\\Delta f$ можна представити й інші міри асиметрії мультифрактального спектра. Наприклад, ми можемо визначити тип довгого хвоста мультифрактального спектра за допомогою показника $\\Delta S$ [@10.3389/fphys.2012.00141]: \n\n$$\n\\Delta S = \\Delta\\alpha_{R} - \\Delta\\alpha_{L}. \n$$ {#eq-7-5}\n\nЯкщо $\\Delta S < 0$, мультифрактальний спектр має довгий лівий хвіст, що свідчить про чутливість часового ряду до локальних флуктуацій з великою амплітудою. Якщо $\\Delta S > 0$, мультифрактальний спектр має довгий правий хвіст, який вказує на чутливість структури сигналу до локальних флуктуацій з малою амплітудою коливань. У тих випадках, коли високо- і низькофлуктуаційні компоненти сигналу співставні, спектр сингулярностей буде приблизно симетричним і  $\\Delta\\alpha_{R} = \\Delta\\alpha_{L}$.\n\nЗ огляду на [@fig-wti-wind-delta-s] видно, що $\\Delta S < 0$, що свідчить про те, що найбільш крахові ділянки нафтового ринку зумовлені флуктуаціями з великою амплітудою коливань. Особливо помітними тут предстають кризи 1992 та 2020 років.\n\n### Показник асиметрії $A$\n\nДалі ми можемо визначити наступний параметр асиметрії [@OSWIECIMKA2018231;@PhysRevE.91.030902;@Dro_d__2018]:\n\n$$\nA = (\\Delta\\alpha_{L} - \\Delta\\alpha_{R})\\big/(\\Delta\\alpha_{R} + \\Delta\\alpha_{L}) = -\\Delta S \\big/ \\Delta\\alpha.\n$$ {#eq-7-6}\n\nПараметр асиметрії пов'язаний з предомінуючим типом коливань у досліджуваній системі. Якщо $A=0$ ($\\Delta\\alpha_{L}=\\Delta\\alpha_{R}$), динаміку системи представляє симетричний спектр. Якщо $A<0$ ($\\Delta\\alpha_{L}<\\Delta\\alpha_{R}$), мультифрактальний спектр має правосторонню асиметрію, що підкреслює сильніший вплив малих флуктуацій на мультифрактальність. І навпаки, коли $A>0$ ($\\Delta\\alpha_{L}>\\Delta\\alpha_{R}$), тоді ми маємо справу з лівостороннім спектром, який позначає більшу неоднорідність для великих флуктуацій і вказує на те, що в часовому ряді переважає мультифрактальна природа неоднорідностей з високими щільностями. Оскільки асиметрію виявляють за знаком $A$, що еквівалентний знаку $\\Delta S$, то, ґрунтуючись тільки по знаку $\\Delta S$, можна зробити висновки як про тип довгого хвоста, так і про знак показника $A$ мультифрактального спектра, тобто нечутливість і тип домінантних коливань мультифрактальності часового ряду.\n\nЗ [@fig-wti-asymmetry] видно, що, як правило, показник асиметрії зростає під час крахових подій і вказує на домінацію лівостороннього спектра (висококонцентрованих флуктуацій з великою амплітудою коливань). Окрім цього видно, що, наприклад, для криз 2008 та 2015-2016 років спостерігалась помітна короткочасна правостороння асиметрія, що характеризується швидкоплинним сплеском показника асиметрії у сторону від'ємних значень. Асоціювати малі та великі флуктуації з конкретними настроями або поведінковими патернами ринку доволі складно. На даний момент ми можемо відзначити тільки те, що дані події представляли найбільш багату варіацію як короткострокових, так і довгострокових кореляцій.  \n\n### Індекс $h$-флуктуацій ($hFI$)\n\nФлуктуацію можна проаналізувати за допомогою другої похідної узагальненого показника Херста. Зауважимо, що амплітуда другої похідної у випадку мультифрактальних сигналів більша, ніж для монофрактальних. \nДля одержання потрібної інформації з $h(q)$ було запропоновано $h$-індекс флуктуації $(hFI)$ [@Orozco_Duque_2015], що визначається як степінь другої похідної від $h(q)$:\n\n$$\nhFI = \\frac{1}{2|q_{max}|+2}\\sum_{q=q_{min}-2}^{q_{max}}\\left[ h(q) - 2h(q-1) + h(q-2) \\right]^{2}.\n$$ {#eq-7-7}\n\nЧим вище значення даного показника, тим вища самоорганізованість системи.\n\nВидно, що за $hFI$ найвищий ступінь мультифрактальності проявляється саме для криз 1992, 2008, 2016 та 2020 років. Дані крахові події включають в себе найбільшу кількість різноманітних факторів, що впливали на динаміку досліджуваної системи. Особливо помітно це для коронавірусної пандемії. \n\n### Кумулятивний індекс інкрементів узагальнених показників Херста ($\\alpha CF$)\n\nКумулятивна функція квадратів інкрементів ($\\alpha CF$) [@doi:10.1098/rsta.2020.0254] узагальнених показників Херста між послідовними моментними порядками є більш надійним показником розподілу узагальнених показників Херста. \n\nПредставлений кумулятивний індекс дещо відрізняється від $hFI$, але за логікою приблизно однаковий: події з найвищим ступенем мультифрактальності характеризуються вищою амплітудою $\\alpha CF$. Представлений показник виділяє ті самі кризи, що й попередній, але динаміка цього показника більш виразна, що робить його більш надійним для ідентифікації періодів самоорганізації системи. \n\n### Інтегральна мультифрактальна теплоємність $C(q)$\n\nЗагальний ступінь мультифрактальності, інтегральну мультифрактальну питому теплоємність ($C_{area}$), можна виразити через рівняння ([-@eq-7-8]):\n\n$$\nC_{area} = \\int C(q)dq.\n$$ {#eq-7-8}\n\nРозрахуємо і проаналізуємо динаміку цього показника. \n\nЗ представленого рисунку видно, що динаміка інтегральної теплоємності дуже подібна до ширини спектра мультифрактальності. Тобто, $C_{area}$ є показником складності, що вказує на ступінь самоорганізованості фінансового фазового переходу. Видно, що фінансові крахи представляють доволі трендостійку динаміку, що є наслідком цілеспрямованих та колективних дій трейдерів на ринку. \n\n### Хаусдорфова розмірність ($D_{0}$)\n\nЯк уже зазначалось, $D_{0}$ представляє верхню межу змін розмірностей фрактальних підмножин атрактора системи. Інформацію про статистичні властивості системи він не містить і не представляє особливої цінності. \n\n### Інформаційна розмірність ($D_{1}$)\n\nІнформаційна розмірність тісно пов'язана з інформаційною ентропією Шеннона. Чим вище значення $D_1$, тим швидше збільшується ентропія, що є показником того, наскільки мало ми знаємо про поточний стан системи. Зі зменшенням $D_1$ ентропія знижується, що, своєю чергою, свідчить про збільшення асиметрії в просторі, зменшення складності та розширення нашого розуміння поточного стану системи. Це також означає, що для опису можливих конфігурацій системи нам буде потрібно менше інформації.\n\nНа [@fig-wti-informdim] видно, що інформаційна розмірність характеризується спадом під час крахових подій. Це вказує на зростання ступеня впорядкованості системи та колективної атракції агентів ринку до конкретної області фазового простору досліджуваної системи. \n\n### Кореляційна розмірність ($D_{2}$)\n\nКореляційну розмірність, аналогічно інформаційній розмірності, можна подати як тангенс кута нахилу лінії регресії, побудованої в логарифмічному масштабі, щодо залежності кореляційного інтеграла $C(\\varepsilon)$ від $\\varepsilon$. Подібно до $D_1$, кореляційна розмірність також визначає, як швидко змінюється значення кореляційного інтеграла.\n\nКореляційна розмірність на [@fig-wti-corrdim] характеризується зростанням у передкризовий період та спадом під час кризи. Це говорить про те, що більшість агентів ринку починає орієнтуватися на один конкретний вектор розвитку системи.   \n\n### Кривизна лівого ($\\Delta D_{L}$) та правого ($\\Delta D_{R}$) хвостів розподілу узагальнених фрактальних розмірностей\n\nОхарактеризувати ступінь цієї складності можна за кривизною окремо правого та лівого хвостів узагальнених фрактальних розмірностей. Праву сторону ($\\Delta D_{R}$) можна визначити як \n\n$$\n\\Delta D_{R} = D_0 - D_{q_{max}}.\n$$ {#eq-7-9}\n\nІ чим більшим буде значення цієї міри, тим сильнішим буде ступінь впливу елементів із найбільшою концентрацією (щільністю, амплітудою флуктуацій) на загальну складність системи.\n\nКривизна лівого хвоста кривої узагальнених фрактальних розмірностей ($\\Delta D_{L}$): \n\n$$\n\\Delta D_{L} = D_{q_{min}} - D_{0}. \n$$ {#eq-7-10}\n\nЦей показник буде говорити нам про те, наскільки сильним є вплив найменш концентрованих елементів на складність системи.\n\nНа рисунку ([@fig-delta-lr]) видно, що спостерігаються етапи, при який два показники можуть вести себе як асинхронно, так і синхронно. Для 1992 року видно, що у передкризовий етап спостерігалась короткочасна домінація великих флуктуацій, на що і вказує $\\Delta D_{R}$. Під час краху спостерігалась домінація малоконцентрованих елементів, що демонструє зростання $\\Delta D_{L}$. Для 2001 року бачимо зростання впливу правого хвоста і зменшення впливу лівого. Для краху 2008 року видно зростання впливу висококонцентрованих елементів напередодні кризи. Після цього домінують малоконцентровані елементи. Бачимо зростання впливу малоконцентрованих елементів під час кризи 2016 року, і закономірне зменшення участі великоконцентрованих елементів. Пандемія 2020-2021 років характеризувалась активною участю як малоконцентрованих елементів, так і великоконцентрованих, на що вказує зростання обох показників кривизни хвостів узагальнених розмірностей.  \n\n### Дво- та тривимірна візуалізація показників мультифрактальності\n\nПопередньо ми аналізували залежності $h(q)$, $\\tau(q)$, $D(q)$, $C(q)$ та $f(\\alpha)$ для всього часового ряду. Тепер, скориставшись процедурою ковзного вікна, ми можемо подивитися на їх зміну з плином часу. Скористаємось часовим рядом цін на нафту. \n\nПерш за все оголосимо функції для побудови двовимірних графіків:\n\nта тривимірних:\n\nПісля оголошення необхідний функцій можна приступати до візуалізації. \n\n#### Динаміка $h(q)$ з ходом часу в дво- та тривимірному просторах\n\nНа представлений рисунках ([@fig-hq-2d] та [@fig-hq-3d]) видно, що узагальнений показник Херста характеризується значним ростом саме в період криз. Особливо високим $h(q)$ предстає для $q < 0$, що говорить про значну персистентність малих флуктуацій у періоди турбулентності. Найвищим ступінь нелінійності в даному випадку представляють кризи 1992, 2008-2009, 2015-2016 та 2020-2021 років, що підтверджується й попередніми індикаторами. \n\n#### Динаміка $\\tau(q)$ з ходом часу в дво- та тривимірному просторах\n\nЯк видно з представлений рисунків ([@fig-tauq-2d] та [@fig-tauq-3d]), $\\tau(q)$ стає більш нелінійним для всіх значень $q$. На кінцях хвостів цього індикатора можна помітити значні впадини, що можуть слугувати індикаторами крахових подій, але в порівнянні з тим же показником Херста даний індикатор є менш виразним. \n\n#### Динаміка $D(q)$ з ходом часу в дво- та тривимірному просторах\n\nДво- та тривимірні представлення узагальненої фрактальної розмірності показують, що $D(q)$ зростає під час кризових подій. Узагальнена фрактальна розмірність також представляє найбільш індикативну динаміку для негативних значень $q$, хоча для позитивних $q$ також спостерігаються незначні коливання. \n\n#### Динаміка $C(q)$ в дво- та тривимірному просторах\n\nНа даних рисунках ([@fig-heat-2d] та [@fig-heat-3d]) під час кризових подій спостерігаються стрибки мультифрактальної теплоємності, що вказує аналогії фізичних фазових переходів та кризових подій. Можна бачити, що при різних ринкових режимах $C(q)$ може бути симетричною, демонструючи рівномірний вплив на динаміку ринку як висококонцентрованих елементів, так і низькоконцентрованих. Також $C(q)$ може зміщуватись як у ліву сторону, так і вправу, що говорить про мінливість ринку та впливовість різних початкових умов на його структуризацію. \n\n#### Динаміка $f(\\alpha)$ з ходом часу в дво- та тривимірному просторах\n\nЯк видно з останніх рисунків ([@fig-falpha-2d] та [@fig-falpha-3d]), ширина спектра мультифрактальності змінюється у формі з плином часу, і стає ширшою під час кризових подій, що підтверджувалось таким індикатором як, наприклад, $\\Delta\\alpha$. Видно, що у передкризові періоди зростає лівостороння асиметрія, що характеризує флуктуації значної амплітуди коливань. Самі кризи представляють зміщення $f(\\alpha)$ у праву сторону, що вказує на домінацію флуктуацій з малою амплітудою. У будь-якому разі, зростання ширини спектра є індикатором зростання ступеня самоорганізованості елементів, що залучені до досліджуваної системи. Тобто, як $f(\\alpha)$, так і попередні індикатори можна рекомендувати в якості індикаторів або індикаторів-передвісників кризових подій. \n\n## Завдання для виконання\n\n1. Вибрати із запропонованої бази даних варіант завдання \n2. Провести повний аналіз ряду за допомогою методу MF-DFA\n3. Дати інтерпретацію отриманим результатам\n\n## Контрольні запитання\n\n1. В чому переваги мультифрактальних характеристик у порівнянні з монофрактальними?\n2. На що вказує мультифрактальність часового ряду?\n3. Яким чином поводять себе різні характеристики, якщо ряд містить кризу?\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"highlight-style":"arrow","css":["style.css"],"output-file":"lab_7.html"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Copyright","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Back to top","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Рис.","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.433","bibliography":["references.bib"],"csl":"physical-review-b.csl","callout-appearance":"default","grid":{"body-width":"1050px"},"page-layout":"full","theme":{"light":"cosmo","dark":"superhero"},"title":"Лабораторна робота № 7"},"extensions":{"book":{"multiFile":true}}},"docx":{"identifier":{"display-name":"MS Word","target-format":"docx","base-format":"docx"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","toc":true,"number-sections":true,"output-file":"lab_7.docx"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Copyright","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Back to top","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Рис.","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"bibliography":["references.bib"],"csl":"physical-review-b.csl","callout-appearance":"default","title":"Лабораторна робота № 7"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","docx"]}