{"title":"Лабораторна робота № 7","markdown":{"yaml":{"title":"Лабораторна робота № 7"},"headingText":"Теоретичні відомості","containsRefs":false,"markdown":"\n\n\n\n\n\n\n**Тема.** Мультифрактальний аналіз складних систем. \n\n**Мета.** Навчитися використовувати мультифрактальний аналіз детрендованих флуктуацій для отримання індикаторів нелінійних змін у системі.\n\n\n### Означення мультифракталів\n\nУ цій лабораторній ми викладемо основи теорії мультифракталів --- **неоднорідних фрактальних об'єктів**, для повного опису яких, на відміну від регулярних фракталів, недостатньо введення лише однієї величини, його фрактальної розмірності $D$, а потрібен цілий спектр таких розмірностей, кількість яких, взагалі кажучи, нескінченна. Причина цього полягає в тому, що поряд із суто геометричними характеристиками, які визначаються величиною $D$, такі фрактали характеризуються й деякими специфічними статистичними властивостями.\n\n::: {#fig-triangle}\n\n![](Images\\lab_7\\triangle.jpg)\n\nТрикутник Серпинського, області якого згенеровані з нерівномірними ймовірностями\n\n:::\n\nПростіше всього пояснити, що розуміється під \"неоднорідним фракталом\" на прикладі трикутника Серпинського, отриманого за допомогою методу випадкових ітерацій. \n\n\nПрипустімо, однак, що в методі випадкових ітерацій ми тепер із якоїсь причини віддали перевагу одній із вершин трикутника, наприклад, вершині А, і стали вибирати її з імовірністю 90%. Дві ж інші вершини В і С для нас рівноцінні, але на їхню частку тепер припадає всього лише по 5%. Результат такої несиметричної гри\" зображено нижче на рисунку вище. \n\nВидно, що точки всередині трикутника АВС розподілені тепер вкрай нерівномірно. Більша їх частина перебуває біля вершини А та її прообразів. Водночас у вершин В і С (і їхніх прообразів) їх є вкрай мало. Проте, за звичайною термінологією, ця множина точок (за умови прагнення числа ітерацій до нескінченності) є фракталом, тому що збереглася основна властивість фракта --- самоподібність. Дійсно, трикутник DFC, хоча в ньому у 20 разів менше точок, за своїми статистичними і геометричними властивостями повністю подібний до великого трикутника АВС. Так само, як і у великому трикутнику, точки в ньому концентруються здебільшого поблизу вершини D --- аналогу вершини А.\n\n::: {#fig-dist-serp}\n\n![](Images\\lab_7\\distribution_of_points.jpg)\n\nРозподіл точок по трикутнику Серпинського, представленого на попередньому рисунку\n\n:::\n\n@fig-dist-serp більш детально демонструє результуючий розподіл точок по трикутнику Серпинського. Цифри в кожному з маленьких трикутників показують його відносну заселеність точками множини. \n\nОднак, не дивлячись на нерівномірність розподілу точок фрактала, його фрактальна розмірність залишилась при цьому такою ж, $D=\\frac{\\ln{3}}{\\ln{2}}$. Покриття цієї множини все меншими трикутниками можна здійснити по тому ж алгоритму, що й раніше. Таке співпадіння змушує замислитись над пошуком нових кількісних характеристик, котрі могли б відрізнити нерівномірний розподіл точок від рівномірного. \n\n\nІнший, складніший приклад неоднорідного фрактала, який ми б хотіли ще навести, показано на наступному рисунку. Ліворуч продемонстровано великий квадрат зі стороною, що дорівнює одиниці, який на цьому (нульовому) етапі повністю покриває собою деяку фрактальну множину точок $M$. На наступному (першому) етапі, у центрі малюнка,\nпоказано, як ту саму множину можна покрити трьома меншими квадратами зі сторонами $l_1=1/2, \\ l_2=l_3=5/16$, у яких, відповідно, міститься частка $p_1=1/2, \\ p_2=1/3$ та $p_3=1/6$ усіх точок.\n\n::: {#fig-dist-square}\n\n![](Images\\lab_7\\square_fractal.jpg)\n\nПриклад мультифрактала, що підкоряється ренормалізаційній схемі \n\n:::\n\nНаступний етап покриття (зображений на рисунку праворуч) містить уже 9 квадратів зі сторонами $l_{1}^{2}=1/4, \\ l_{1}l_{2}=l_{1}l_{3}=5/32$ (у нижньому правому куті) і $l_{2}l_{1}=5/32, \\ l_{2}^{2}=l_{2}l_{3}=25/256$ (угорі праворуч і ліворуч). Відносна заселеність цих квадратів точками множини показана на рисунку. Вона відповідає добутку чинників заселеності (імовірностей): $p_{1}^{2}=1/4, \\ p_{1}p_{2}=1/6, \\ p_{1}p_{3}=1/12$ --- для нижньої правої групи, $p_{2}p_{1}=1/6, \\ p_{2}^{2}=1/9, \\ p_{2}p_{3} = 1/18$ --- для верхньої лівої та $p_{3}p_{1}=1/12, \\ p_{3}p_{2}=1/18, \\ p_{3}^{2}=1/36$ --- для верхньої правої групи. Зазначимо, що є чітка відповідність між заселеністю квадрата $p_{j}p_{i}$ і його розмірами $l_{i}l_{i}$.\n\n\nПодальший процес розбиття і покриття множини $M$ здійснюється згідно із цією ренормалізаційною схемою. Кожен квадрат, що має на $n$-му кроці розмір $l$ і заселеність $р$, замінюється на $n+1$ кроці трьома квадратами з розмірами $ll_{1}, \\ ll_{2}, \\ ll_{3}$ і заселеностями $pp_{1}, \\ pp_{2}, \\ pp_{3}$ відповідно, розміщеними таким самим чином відносно один одного, як показано на попередньому посередні рисунку.\n\nДвоє розглянутих вище випадки являють собою приклади неоднорідних фракталів. Під словом \"неоднорідний\" ми тут розуміємо нерівномірний розподіл точок множини по фракталу або нерівномірний розподіл малих та великих флуктуацій у часовому ряді. Причина неоднорідності в попередніх випадках одна й та сама --- різні ймовірності заповнення геометрично однакових елементів фрактала, або в загальному випадку невідповідність імовірностей заповнення геометричним розмірам відповідних областей. Такі неоднорідні фрактальні об'єкти в літературі називають мультифракталами, і їх вивченням ми й займемося надалі.\n\n\n### Узагальнені фрактальні розмірності $D_{q}$\n\nДамо загальне визначення мультифрактала. Розглянемо фрактальний об'єкт, що займає якусь обмежену ділянку $\\Omega$ розміру $L$ у Евклідовому просторі з розмірністю $d$. Нехай на якомусь етапі його побудови він являє собою множину з $N \\gg 1$ точок, якось розподілених у цій області. Ми будемо припускати, що врешті-решт $N \\to \\infty$. Прикладом такої множини може слугувати трикутник Серпінського, побудований методом випадкових ітерацій. Кожен крок ітераційної процедури додає до цієї множини одну нову точку.\n\nРозіб'ємо всю область $\\Omega$ на кубічні клітинки зі стороною $\\varepsilon \\ll L$ та об'ємом $\\varepsilon^{d}$. Далі нас будуть цікавити тільки зайняті клітинки, у яких міститься хоча б одна точка. Нехай номер зайнятих комірок $i$ змінюється в межах $і=1, 2,..., N(\\varepsilon)$, де $N(\\varepsilon)$ --- сумарна кількість зайнятих клітинок, яка, звісно, залежить від розміру клітинки $\\varepsilon$.\n\nНехай $n_{i}(\\varepsilon)$ представляє собою кількість точок у клітинці з номером $i$, тоді величина \n\n$$\np_{i}(\\varepsilon) = \\lim_{N\\to\\infty}\\frac{n_{i}(\\varepsilon)}{N}\n$$\n\nпредставляє собою ймовірність того, що навмання взята точка з нашої множини знаходиться в комірці $i$. Інакше кажучи, ймовірності $р_{i}$ характеризують відносну заселеність комірок. З умови нормування ймовірності випливає, що \n\n$$\n\\sum_{i=1}^{N(\\varepsilon)}p_{i}(\\varepsilon)=1.\n$$\n\n\nУведемо тепер у розгляд **узагальнену статистичну суму** $Z(q,\\varepsilon)$, що характеризується показником ступеня $q$, який може набувати будь-яких значень в інтервалі $-\\infty<q<+\\infty$\n\n$$\nZ(q,\\varepsilon)=\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon).\n$$\n\nСпектр **узагальнених фрактальних розмірностей** $D_{q}$, що характеризує даний розподіл точок в області $\\Omega$, визначається за допомогою співвідношення \n\n$$\nD_{q} = \\frac{\\tau(q)}{q-1}, \n$$\n\nде функція $\\tau(q)$ має вид \n\n$$\n\\tau(q)=\\lim_{\\varepsilon\\to 0}\\frac{\\ln{Z(q,\\varepsilon)}}{\\ln{\\varepsilon}}.\n$$\n\n\nЯк ми покажемо нижче, якщо $D_{q}=D=\\text{const}$, тобто не залежить від $q$, то дана множина точок являє собою звичайний, регулярний фрактал, який характеризується лише однією величиною --- фрактальною розмірністю $D$. Навпаки, якщо функція $D_{q}$ якось змінюється з $q$, то розглянута множина точок представляє мультифрактал.\n\nТаким чином, мультифрактал у загальному випадку характеризується деякою **нелінійною** функцією $\\tau(q)$, що визначає поведінку статистичної суми $Z(q,\\varepsilon)$ при $\\varepsilon\\to 0$\n\n$$\\tag{1}\nZ(q,\\varepsilon)=\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon) \\approx \\varepsilon^{\\tau(q)}.\n$$\n\n\nСлід мати на увазі, що в реальній ситуації ми завжди маємо скінченне, хоча й дуже велике число дискретних точок $N$, тому при комп'ютерному моделювані конкретної множини граничний перехід $\\varepsilon\\to 0$ треба виконувати з обережністю, пам'ятаючи, що йому завжди передує ліміт $N \\to 0$.\n\nПокажемо тепер, як поводиться узагальнена статистична сума у випадку звичайного регулярного фрактала з фрактальною розмірністю $D$. У цьому випадку в усіх зайнятих комірках міститься однакова кількість точок\n\n$$\nn_{i}(\\varepsilon)=\\frac{N}{N(\\varepsilon)}, \n$$\n\nтобто фрактал представляється **однорідним**. Тоді очевидно, що відносні населеності клітинок, $p_{i}(\\varepsilon)=1/N(\\varepsilon)$, також однакові, і узагальнена статистична сума набуває вигляду \n\n$$\\tag{2}\nZ(q,\\varepsilon) = N^{1-q}(\\varepsilon).\n$$\n\nВрахуємо тепер, що, згідно визначеню фрактальної розмірності $D$, кількість зайнятих клітинок при достатньо малому $\\varepsilon$ поводить себе наступним чином:\n\n$$\\tag{3}\nN(\\varepsilon) \\approx \\varepsilon^{-D}.\n$$\n\nПідставляючи (3) у формулу (2), і порівнюючи з (1), отримуємо\n\n$$\\tag{4}\n\\varepsilon^{\\tau(q)} = \\varepsilon^{-D(1-q)} \\to \\tau(q)=(q-1)D. \n$$\n\nМи приходимо до висновку, що у випадку звичайного фрактала функція (4) є лінійною. Тоді всі $D_{q}$ дійсно не залежать від $q$. Фрактал у якого всі узагальнені фрактальні розмірності $D_{q}$ співпадають називається **монофракталом**.\n\nЯкщо розподіл точок по клітинкам неоднаковий, тоді фрактал називається неоднорідним, тобто представляє із себе мультифрактал, і для його характеристики необхідний цілий спектр узагальнених фрактальних розмірностей $D_{q}$, кількість котрих, у загальному випадку, нескінченна. \n\nТак, наприклад, при $q \\to +\\infty$ основний внесок в узагальнену статистичну суму (1) вносять комірки, що містять найбільшу кількість частинок $n_{i}$ у них і, відповідно, що характеризуються найбільшою ймовірністю їх заповнення $p_{i}$. Навпаки, при $q \\to -\\infty$ основний внесок в узагальнену статистичну суму вносять найбільш розрідженні комірки з найменшою ймовірністю їх заповнення $p_{i}$. Таким чином, функція $D_{q}$ показує, наскільки неоднорідним представляється досліджувана множина точок $\\Omega$. \n\nУ подальшому для характеристики розподілу точок необхідно знати не тільки функцію $\\tau(q)$, але і її похідну:\n\n$$\n\\frac{d\\tau(q)}{dq} = \\lim_{\\varepsilon\\to 0}\\frac{\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}\\ln{p_{i}}}{\\left( \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q} \\right)\\ln{\\varepsilon}}.\n$$\n\nЦя похідна має важливий фізичний зміст, який буде продемонстровано пізніше. Зараз знову зазначимо, що для мультифрактальної системи вона не залишається константною і змінюється з $q$. \n\n### Функція мультифрактального спектра $f(\\alpha)$\n\n#### Спектр фрактальних розмірностей\n\nУ попередньому пункті ми ввели поняття мультифрактала --- об'єкта, що представляє собою неоднорідний фрактал. Для його опису ми ввели множину узагальнених фрактальних розмірностей $D_{q}$, де $q$ приймає будь-які значення в інтервалі $-\\infty<q<+\\infty$. Однак величини $D_{q}$ не є, строго кажучи, фрактальними розмірностями в загальному розумінні цього слова. \n\n\nТому часто поряд із ними для характеристики мультифрактальної множини використовують так звану **функцію мультифрактального спектра** $f(\\alpha)$ (спектр сингулярностей мультифрактала), до якої, як ми побачимо надалі, більше підходить термін фрактальна розмірність. Ми покажемо, що величина $f(\\alpha)$ фактично дорівнює хаусдорфовій розмірності якоїсь однорідної фрактальної підмножини із вихідної множини $\\Omega$, що дає домінантний внесок у статистичну суму при заданій величині $q$.\n\nОднією з основних характеристик мультифрактала є набір імовірностей $р_{i}$, що показують відносну заселеність клітинок $\\varepsilon$, якими ми покриваємо цю множину. Чим менший розмір клітинки, тим менша величина її заселеності. Для самоподібних множин залежність $p_{i}$ від розміру клітинки $\\varepsilon$ має степеневий характер:\n\n$$\np_{i}(\\varepsilon) \\approx \\varepsilon^{\\alpha_{i}}, \n$$\n\nде $\\alpha_{i}$ являє собою деякий показник ступеня (різний для різнок клітинок $i$). Відомо, що для регулярного (однорідного) фрактала всі показники ступеня $\\alpha_{i}$ однакові й рівні фрактальній розмірності $D$:\n\n$$\np_{i} = \\frac{1}{N(\\varepsilon)} \\approx \\varepsilon^{D}.\n$$\n\nУ даному випадку статистична сума (1) приймає наступний вигляд:\n\n$$\nZ(q,\\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon) = N(\\varepsilon)\\varepsilon^{Dq}=\\varepsilon^{-D}\\varepsilon^{Dq} \\approx \\varepsilon^{D(q-1)}. \n$$\n\nТому $\\tau(q)=D(q-1)$ і всі узагальнені фрактальні розмірності $D_{q}=D$ у цьому випадку співпадають та не залежать від $q$. \n\nОднак, для такого складного об'єкта, як мультифрактал, унаслідок його неоднорідності, ймовірності заповнення клітинок $p_{i}$ у загальному випадку різняться, і показник ступеня $\\alpha_{i}$ для різних клітинок може приймати різні значення. Достатньо типовою є ситуація, коли ці значення неперервно заповнюють деякий закритий інтервал $\\left( \\alpha_{min}, \\alpha_{max} \\right)$, причому \n\n$$\np_{min} \\approx \\varepsilon^{\\alpha_{max}}, \\; \\text{a} \\; p_{max} \\approx \\varepsilon^{\\alpha_{min}}. \n$$\n\nТепер перейдемо до питання о розподілі ймовірностей різних значень $\\alpha_{i}$. Нехай $n(\\alpha)d\\alpha$ є ймовірністю того, що $\\alpha_{i}$ знаходиться в інтервалі від $\\alpha$ до $\\alpha+d\\alpha$. Іншими словами, $n(\\alpha)d\\alpha$ представляє собою відносну кількість клітинок $i$, що характеризуються однією і тією самою мірою $p_{i}$ з $\\alpha_{i}$, що лежать у цьому інтервалі. У випадку монофрактала, для котрого всі $\\alpha_{i}$ однакові (і рівні фрактальній розмірності $D$), це число, очевидно, пропорційно повній кількості клітинок $N(\\varepsilon) \\approx \\varepsilon^{-D}$, степеневим чином залежних від розміру клітинки $\\varepsilon$. Показник ступеня в цьому співвідношені визначається фрактальною розмірністю множини $D$. \n\nДля мультифрактала, однак, це не так, і різні значення $\\alpha_{i}$ зустрічаються з ймовірністю, що характеризується не однією і тією ж величиною $D$, а різними (в залежності від $\\alpha$) значеннями показниками ступеня $f(\\alpha)$, \n\n$$\\tag{5}\nn(\\alpha) \\approx \\varepsilon^{-f(\\alpha)}.\n$$\n\nТаким чином, фізичний сенс функції $f(\\alpha)$ полягає в тому, що вона представляє собою розмірність хаусдорфа деякої однорідної підмножини $\\Omega_{\\alpha}$ із вихідної множини $\\Omega$, що характеризується однаковими ймовірностями заповнення клітинок $p_{i} \\approx \\varepsilon^{\\alpha}$. Оскільки фрактальна розмірність підмножини очевидно завжди менша або рівна фрактальній розмірності вихідної множини $D_{0}$, має місце важлива нерівність для функції $f(\\alpha)$:\n\n$$\nf(\\alpha) \\leq D_{0}. \n$$\n\nУ результаті можна зробити висновок, що множина різних значень функції $f(\\alpha)$ (при різних $\\alpha$) представляє собою **спектр фрактальних розмірностей** однорідних підмножин $\\Omega_{\\alpha}$, на які можна розбити вихідну множину $\\Omega$, кожна з яких характеризується власним значенням фрактальної розмірності $f(\\alpha)$. \n\nОскільки будь-якій підмножині належить лише частина загальної кількості клітинок $N(\\varepsilon)$, на котрі ми розділили вихідну множину $\\Omega$, умова нормування ймовірностей, очевидно, не виконується при підсумовуванні тільки по цій підмножині. Сума цих імовірностей стає менше одиниці. Тому й самі ймовірності $p_i$ з одним і тим самим значенням $\\alpha_i$ очевидно менше (або в крайньому випадку одного порядку), ніж величина $\\varepsilon^{f(\\alpha_i)}$, яка обернено пропорційна кількості наявних клітинок, що покривають дану підмножину (нагадаємо, що у випадку монофрактала $p_i \\approx 1/N(\\varepsilon)$). У результаті ми приходимо до наступної важливої нерівності для функції $f(\\alpha)$. А саме, при всіх значеннях $\\alpha$\n\n$$\nf(\\alpha) \\leq \\alpha. \n$$\n\nЗнак рівності має місце, наприклад, для повністю однорідного фрактала, де $f(\\alpha)=\\alpha=D$. \n\n\n#### Перетворення Лежандра\n\nВстановимо зв'язок функції $f(\\alpha)$ із введенною раніше функцією $\\tau(q)$. Обчислимо для цього статистичну суму $Z(q,\\varepsilon)$. Підставляє у статистичну суму ймовірності $p_i \\approx \\varepsilon^{\\alpha_i}$, та переходячи від підсумовування по $i$ до інтегрування по $\\alpha$ з плотністю ймовірностей (5), ми отримаємо\n\n$$\\tag{6}\nZ(q,\\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)} p_{i}^{q}(\\varepsilon) \\approx \\int d\\alpha n(\\alpha)\\varepsilon^{q\\alpha} \\approx \\int d\\alpha\\varepsilon^{q\\alpha-f(\\alpha)}. \n$$\n\nТак як величина $\\varepsilon$ дуже мала, основний внесок у цей інтеграл вноситимуть ті значення $\\alpha(q)$, при яких показник ступеня $q\\alpha-f(\\alpha)$ виявляється мінімальним (а підінтегральна функція --- максимальною). Цей вклад буде пропорційним значенню підінтегральної функції у точці максимума. Саме ж значення $\\alpha(q)$ визначається при цьому з наступної умови:\n\n$$\n\\left. \\frac{d}{d\\alpha}[ q\\alpha-f(\\alpha) ] \\right \\vert_{\\alpha=\\alpha(q)} = 0. \n$$\n\nТакож, з умови мінімуму ми маємо\n\n$$\n\\left. \\frac{d^{2}}{d\\alpha^{2}}[ q\\alpha-f(\\alpha) ] \\right \\vert_{\\alpha=\\alpha(q)} > 0. \n$$\n\nУ результаті отримуємо, що залежність $\\alpha(q)$ неявним чином визначається з рівняння \n\n$$\\tag{7}\nq = \\frac{df(\\alpha)}{d\\alpha}\n$$\n\nі що функція $f(\\alpha)$ усюди є випуклою\n\n$$\nf^{''}(\\alpha)>0.\n$$\n\nЦе значить, що величина $f(\\alpha(q))$ дійсно визначає фрактальну розмірність підмножини $\\Omega_{\\alpha(q)}$, що має найбільший домінуючий внесок у статистичну суму (6) при заданій величині показника ступеня $q$. \n\nОскільки $Z(q,\\varepsilon)=\\tau(q)$, приходимо до висновку, що \n\n$$\n\\tau(q) = q\\alpha(q) - f(\\alpha(q)). \n$$\n\nПам'ятаючи, що $\\tau(q)=D(q-1)$, можемо віднайти функцію $D_{q}$: \n\n$$\\tag{8}\nD_{q} = \\frac{1}{q-1}[ q\\alpha(q)-f(\\alpha(q)) ]. \n$$\n\nТаким чином, якщо ми знаємо функцію мультифрактального спектра $f(\\alpha)$, то з домомогою співвідношень (7) та (8) ми можемо знайти функцію $D_{q}$. Навпаки, знаючи $D_{q}$, ми можемо знайти залежність $\\alpha(q)$ з допомогою рівняння\n\n$$\\tag{9}\n\\alpha(q) = \\frac{d}{dq}[(q-1)D_{q}]\n$$\n\nі після цього знайти із (8) залежність $f(\\alpha(q))$. Ці два рівняння і визначають функцію $f(\\alpha)$. \n\n$$\n\\frac{d\\tau}{dq}\\frac{dq}{d\\alpha} = q + \\alpha\\frac{dq}{d\\alpha} - \\frac{df}{d\\alpha}.\n$$\n\nПриймаючи до уваги те, що $q=df/d\\alpha$, і скорочуючи це рівняння на $dq/d\\alpha$, приходимо до співвідношення \n\n$$\n\\alpha = \\frac{d\\tau(q)}{dq}, \n$$\n\nщо еквівалентне виразу (9). \n\nВирази для $\\tau(q)$ та $\\alpha(q)$ задають **перетворення Лежандра** від змінних $\\{ q, \\tau(q) \\}$ до змінних $\\{\\alpha, f(\\alpha)\\}$: \n\n$$\\tag{10}\n\\alpha = \\frac{d\\tau}{dq}\n$$\n\nта \n\n$$\\tag{11}\nf(\\alpha) = q\\frac{d\\tau}{dq} - \\tau.\n$$\n\nЯк відомо, для однорідного фрактала $D_{q}=D=\\text{const}$. Тому $\\alpha=d\\tau/dq=D$ і $f(\\alpha)=q\\alpha-\\tau(q)=qD-D(q-1)=D$. У цьому випадку \"графік\" функції $f(\\alpha)$ на площині $\\left( \\alpha, f(\\alpha) \\right)$ складається лише з однієї точки  $\\left( D, D \\right)$. \n\n### Мультифрактальний аналіз детрендованих флуктуацій\n\nМонофрактальні та мультифрактальні структури фінансових сигналів є особливим різновидом масштабно-інваріантних структур. Найчастіше монофрактальна структура фінансових часових рядів визначається одним степеневим показником і передбачає, що масштабо-інваріантність не залежить від часу і простору. Однак, часто ми маємо змогу спостерігати просторово-часову варіацію масштабно-інваріантної структури досліджуваної складної системи. Ці просторово-часові варіації вказують на мультифрактальність фінансового сигналу, яка визначається мультифрактальним спектром. Ширина і форма мультифрактального спектра можуть також допомогти диференціювати варіативність серцевого ритму у пацієнтів із серцевими захворюваннями, такими як шлуночкова тахікардія, фібриляція шлуночків і застійна серцева недостатність. Мультифрактальний спектр може допомогти кількісно визначити асиметрію підйомів та спадів на фондовому чи криптовалютному ринках, передбачити фінансову кризу, що поступово наближується, і, таким чином, сприяти успішності подальших торгівельних рішень. Основна мета цього розділу --- представити одну з найточніших процедур для визначення множини фрактальних показників --- **мультифрактальний аналіз детрендованих флуктуацій** (multifractal detrended fluctuation analysis, MFDFA).\n\nПобудова MFDFA складається з восьми кроків: Розділ *\"Шум і випадкові блукання у часовому ряді\"* представляє метод приведення часового ряду до такого, що подібний до випадкового блукання, що є попереднім кроком для MFDFA. Розділ *\"Обчислення середньоквадратичної варіації часового ряду\"* представляє середньоквадратичну варіацію, яка є основною процедурою для подальших обчислень в MFDFA і типовим способом обчислення середньої варіації часових рядів різної природи. Розділ *\"Локальна середньоквадратична варіація часового ряду\"* представляє обчислення локальної варіації часового ряду як середньоквадратичного відхилення часового ряду в межах сегментів, що можуть як перекриватися, так і не перекриватися. У розділі *\"Локальне детрендування часового ряду\"* таке ж локальне середньоквадратичне відхилення обчислюється навколо трендів, які часто зустрічаються у фінансових часових рядах. У розділі *\"Монофрактальний аналіз детрендованих флуктуацій\"* амплітуди локальних середніх квадратичних відхилень підсумовуються в узагальнене середнє квадратичне відхилення. У сумарному середньоквадратичному відхиленні для сегментів з малими розмірами вибірки переважають швидкі флуктуації часового ряду. На противагу цьому, у сумарному середньоквадратичному відхиленні для сегментів з великими розмірами вибірки переважають повільні коливання. Степенева залежність між загальним середнім квадратичним відхиленням для декількох розмірів вибірки (тобто масштабів) визначається за допомогою монофрактального аналізу дентрендованих флуктуацій (monofractal detrended fluctuation analysis, DFA) і називається показником Херста (Hurst exponent, $H$). У розділі *\"Мультифрактальний аналіз детрендованих флуктуацій\"* MFDFA отримують шляхом розширення на $q$-й порядок узагальненого середньоквадратичного відхилення. Середньоквадратичне відхилення $q$-го порядку може розрізняти сегменти з малими та великими флуктуаціями. Степенева залежність між середньоквадратичним відхиленням $q$-го порядку чисельно визначається як показник Херста $q$-го порядку. У розділі *\"Мультифрактальний спектр часових рядів\"* на основі показника Херста $q$-го порядку обчислено декілька мультифрактальних спектрів.\n\nДля подальшої візуалізації кожного кроку процедури MFDFA імпортуємо наступні модулі:\n\nІ виконаємо налаштування рисунків для виведення:\n\nЦього разу розглянему можливість побудови індикаторів або індикаторів-передвісників на прикладі індексу сирої нафти West Texas Intermediate (WTI). При описі процедури MFDFA порівнюватимемо мультифрактальність даного ряду зі штучно зненерованими монофрактальними рядами складність яких має представлятися меншою у порівняні з нафтою. \n\nСам сайт Yahoo! Finance містить досить коротку історію щодених цін на нафту даної марки. Цього разу, в якості альтернативного прикладу, будемо послуговуватись альтернативним джерелом фінансових даних --- [федеральним резервом економічних даних федерального резервного банку Сент-Луїса](https://fred.stlouisfed.org) (Federal Reserve Economic Data of the Federal Reserve Bank of St. Louis, FRED). На Python було створено бібліотеку для вивантаження даних із даного джерела --- `pandas-datareader`. Для її встановлення достатньо прописати наступну команду:\n\nТепер імпортуємо відповідну бібліотеку:\n\nта виконаємо зчитування індексу з FRED, використовуючи функціонал даної бібліотеки. Завантажимо дані за весь період, що нам буде доступний:\n\nВиведемо досліджуваний ряд:\n\nРозглянемо опис нашого масиву даних:\n\nНа представленому рисунку видно, що в значеннях досліджуваного індексу існують пропуски та негативні значення на ціну нафти. Для того, щоб позбутися від'ємного значення, можна виконати заміну значення на таке, що близьке до нуля. Для видалення значень `NaN` достатньо скористатися методом `dropna()` бібліотеки `pandas`.\n\nЗнову візуалізуємо результат:\n\nОстаннє, що нам залишається, це приведення вихідного ряду до прибутковостей. Для цього визначимо функцію `transformation()` та знайдемо з її допомогою прибутковості: \n\nЯк вже зазначалося, при описі процедури MFDFA, ми будемо послуговуватись для порівняння і монофрактальними сигналами. Для подальших розрахунків згенеруємо сигнал білого та рожевого шумів. У цьому нам може допомогти функція `signal_noise()` бібліотеки `neurokit2`. Ця функція генерує чистий гаусовий `(1/f)**beta` шум. Спектр потужності згенерованого шуму пропорційний `S(f) = (1/f)**beta`. Було описано наступні категорії шуму: \n\n- фіолетовий шум: beta = -2\n- синій шум: beta = -1\n- білий шум: beta = 0\n- флікер / рожевий шум: beta = 1\n- коричневий шум: beta = 2\n\nЇї синтаксис виглядає наступним чином:\n\n**`signal_noise(duration=10, sampling_rate=1000, beta=1, random_state=None)`**\n\n**Параметри**\n\n- **duration** (*float*) --- бажана тривалість (у секундах).\n- **sampling_rate** (*int*) --- бажана частота дискретизації (у Гц, тобто відліків на секунду).\n- **beta** (*float*) --- експонента шуму.\n- **random_state** (*None, int, numpy.random.RandomState або numpy.random.Generator*) --- початкове значення (зерно) для генератора випадкових чисел.\n\n**Повертає**\n\n- **noise** (*array*) --- сигнал чистого шуму.\n\nТепер можемо згенерувати 2 види шумів:\n\nІ тепер приступаємо до подальшої роботи. \n\n#### Шум і випадкові блукання у часовому ряді\n\nМультифрактальний аналіз детрендованих флуктуацій базується на класичному аналізі детрендованих флуктуацій (DFA). Класичний DFA застосовується до часових рядів зі структурою, подібною до випадкових блукань. Однак більшість фінансових часових рядів мають коливання, які більш схожі на прирости випадкових блукань. Якщо фінансовий часовий ряд має структуру, подібну до шуму, як у прибутковостей, його слід перетворити на випадково-блукаючий часовий ряд перед застосуванням DFA. Шуми можна перетворити на випадкові блукання шляхом віднімання середнього значення та інтегрування часового ряду (знаходження його кумулятивної суми). Часовий ряд з білим шумом, монофрактал (рожевий шум) і мультифрактал є шумовими часовими рядами і перетворюються на випадкові блукання за допомогою коду, що наведеного нижче:\n\n#### Обчислення середньоквадратичної варіації часового ряду \n\nТрадиційний аналіз варіації часових рядів полягає в обчисленні середнього значення варіації як середньоквадратичного відхилення. Читач може скористатися наведеним нижче кодом для обчислення середньоквадратичного відхилення для часових рядів з білим шумом, монофрактальних і мультифрактальних даних:\n\n@fig-step-2 ілюструє, що середня амплітуда варіації (тобто середньоквадратичне відхилення) є однаковою для всіх трьох часових рядів --- білого шуму, монофрактального та мультифрактального, навіть якщо вони мають досить різну структуру. MFDFA може розрізняти ці структури, як ми побачимо в наступних розділах.\n\n#### Локальна середньоквадратична варіація часового ряду\n\nМультифрактальні часові ряди на верхній панелі мають локальні флуктуації як з великими, так і з малими величинами. Середньоквадратичне відхилення (RMS) у попередньому коді можна обчислити для сегментів часового ряду, щоб розрізнити величини локальних флуктуацій. Проста процедура полягає в тому, щоб розділи часовий ряд на однакові за розміром сегменти, що не перекриваються, і обчислити локальне середнє квадратичне відхилення для кожного сегмента. Це можна зробити за допомогою коду наведеного нижче, і це є основною MFDFA:\n\nПерший рядок коду функції `calc_rms()` перетворює зашумлений часовий ряд, мультифрактал, на часовий ряд випадкового блукання $X$. Третій рядок коду задає масштаб параметра, який визначає розмір вибірки сегментів, що не перетинаються, для яких обчислюється локальне середнє квадратичне відхилення, `RMS`. П'ятий рядок --- це кількість сегментів, на які можна розбити часовий ряд $X$, де `len(X)` --- розмір вибірки часового ряду $X$. Таким чином, `segments = 6` при `len(X) = 9335` і `scale = 1335`. З дев'ятого по шістнадцятий рядок --- це цикл, який обчислює локальне середньоквадратичне значення навколо тренду `fit[v]` для кожного сегмента, оновлюючи часовий індекс. У першому циклі `v = 0`, `Index[0]` переходить від 0 до 1335 значення сегмента (не включно). У другому циклі $v = 1$, `Index[1]` переходить від 1335 до 2670 значення другого сегмента. В останньому циклі $v = 6$, `Index[6]` переходить від 8010-го до 9345-го значення (не включно).\n\n#### Локальне детрендування часового ряду\n\nУ складних системах наявні повільні мінливі тренди, тому для кількісної оцінки масштабо-інваріантності флуктуацій навколо цих трендів необхідно провести детрендування сигналу. У попередньому коді до $X$ на кожному сегменті $v$ підбирається поліноміальний тренд `fit[v]`. Параметр $m$ визначає порядок полінома. Поліноміальний тренд є лінійним, якщо $m = 1$, квадратичним, якщо $m = 2$, і кубічним, якщо $m = 3$. Рядок `C = np.polyfit(Index[v], X[Index[v]], m)` визначає коефіцієнти полінома `C`, які використовуються для створення поліноміальної залежності тренду `fit[v]` для кожного сегмента. Потім для залишкової варіації, `X(Index[v])-fit[v]`, обчислюється локальне середньоквадратичне відхилення, `RMS[v]`, в межах кожного сегмента $v$. Локальна середньоквадратична варіація, `RMS[v]`, представлено на наступному рисунку як відстань між червоними пунктирними трендами і червоними суцільними лініями.\n\n#### Монофрактальний аналіз детрендованих флуктуацій\n\nУ DFA варіації локального середньоквадратичного відхилення кількісно оцінюються загальним середньоквадратичним відхиленням ($F$).\n\nШвидкі коливання часового ряду $X$ впливатимуть на загальне середньоквадратичне відхилення, $F$, у сегментах малої довжини (масштабу), тоді як повільні коливання впливатимуть на $F$ у сегментах великої довжини (масштабу). Таким чином, функція флуктуацій, $F$, повинна бути обчислена для декількох масштабів, щоб виокремити вплив як швидкоплинних, так і повільних коливань, які у свою чергу визначають структурні перетворення часового ряду. Функція флуктуацій $F(ns)$ може бути обчислена для декількох масштабів шляхом модифікації попереднього коду:\n\nDFA визначає монофрактальну структуру часового ряду відповідно до степеневої залежність між загальним середнім квадратичним відхиленням (тобто $F$), обчисленим для декількох масштабів. Степенева залежність між загальним середнім квадратичним відхиленням позначається нахилом ($H$) лінії регресії, розрахованим за допомогою коду, що представлений нижче:\n\nМодифікуємо попередній код, додавши нові фрагменти:\n\nТепер розглянемо залежність загальної функції флуктуацій $F$ від різних довжин (масштабів) локальних сегментів ряду для досліджуваних нами рядів:\n\nЯк уже зазначалося в попередній лабораторній роботі, кут нахилу $H$ ліній регресії називається показником Херста. Показник Херста визначає монофрактальну структуру часового ряду, показуючи, наскільки швидко зростає загальне середньоквадратичне відхилення, $F$, локальних коливань, `RMS`, зі збільшенням розміру локальних сегментів ряду (тобто, масштабу). @fig-step-6 показує, що загальне середньоквадратичне значення локальних флуктуацій, $F$, зростає швидше зі збільшенням розміру вибірки сегментів для монофрактального рожевого шуму порівняно з індексом нафти та білим шумом. Більший показник Херста, $H$, візуально свідчить про повільнішу еволюцію варіацій (тобто більш стійку структуру) в рожевому шумі порівняно з нафтою та білим шумом. @fig-hurst ілюструє, що показник Херста визначає континуум між часовими рядами, подібними до шуму, і часовими рядами, подібними до випадкового блукання. Показник Херста знаходиться в інтервалі від 0 до 1 для часових рядів, подібних до шуму, тоді як для часових рядів, подібних до випадкових блукань, він перевищує 1. Часовий ряд має довгострокову залежну (тобто корельовану) структуру, коли показник Херста знаходиться в інтервалі 0.5-1, і антикорельовану структуру, коли показник Херста знаходиться в інтервалі 0-0.5. Часовий ряд має незалежну або короткострокову залежну структуру в окремому випадку, коли показник Херста дорівнює 0.5. Згідно з попереднім рисунком, часові ряди білого шуму та нафти представляються непередбачуваними, оскільки показник Херста близький до 0.5, тоді як рожевий шум довгостроково залежну структуру з показником Херста близьким до 1.\n\n#### Мультифрактальний аналіз детрендованих флуктуацій\n\n\n","srcMarkdownNoYaml":"\n\n\n\n\n\n\n**Тема.** Мультифрактальний аналіз складних систем. \n\n**Мета.** Навчитися використовувати мультифрактальний аналіз детрендованих флуктуацій для отримання індикаторів нелінійних змін у системі.\n\n## Теоретичні відомості\n\n### Означення мультифракталів\n\nУ цій лабораторній ми викладемо основи теорії мультифракталів --- **неоднорідних фрактальних об'єктів**, для повного опису яких, на відміну від регулярних фракталів, недостатньо введення лише однієї величини, його фрактальної розмірності $D$, а потрібен цілий спектр таких розмірностей, кількість яких, взагалі кажучи, нескінченна. Причина цього полягає в тому, що поряд із суто геометричними характеристиками, які визначаються величиною $D$, такі фрактали характеризуються й деякими специфічними статистичними властивостями.\n\n::: {#fig-triangle}\n\n![](Images\\lab_7\\triangle.jpg)\n\nТрикутник Серпинського, області якого згенеровані з нерівномірними ймовірностями\n\n:::\n\nПростіше всього пояснити, що розуміється під \"неоднорідним фракталом\" на прикладі трикутника Серпинського, отриманого за допомогою методу випадкових ітерацій. \n\n\nПрипустімо, однак, що в методі випадкових ітерацій ми тепер із якоїсь причини віддали перевагу одній із вершин трикутника, наприклад, вершині А, і стали вибирати її з імовірністю 90%. Дві ж інші вершини В і С для нас рівноцінні, але на їхню частку тепер припадає всього лише по 5%. Результат такої несиметричної гри\" зображено нижче на рисунку вище. \n\nВидно, що точки всередині трикутника АВС розподілені тепер вкрай нерівномірно. Більша їх частина перебуває біля вершини А та її прообразів. Водночас у вершин В і С (і їхніх прообразів) їх є вкрай мало. Проте, за звичайною термінологією, ця множина точок (за умови прагнення числа ітерацій до нескінченності) є фракталом, тому що збереглася основна властивість фракта --- самоподібність. Дійсно, трикутник DFC, хоча в ньому у 20 разів менше точок, за своїми статистичними і геометричними властивостями повністю подібний до великого трикутника АВС. Так само, як і у великому трикутнику, точки в ньому концентруються здебільшого поблизу вершини D --- аналогу вершини А.\n\n::: {#fig-dist-serp}\n\n![](Images\\lab_7\\distribution_of_points.jpg)\n\nРозподіл точок по трикутнику Серпинського, представленого на попередньому рисунку\n\n:::\n\n@fig-dist-serp більш детально демонструє результуючий розподіл точок по трикутнику Серпинського. Цифри в кожному з маленьких трикутників показують його відносну заселеність точками множини. \n\nОднак, не дивлячись на нерівномірність розподілу точок фрактала, його фрактальна розмірність залишилась при цьому такою ж, $D=\\frac{\\ln{3}}{\\ln{2}}$. Покриття цієї множини все меншими трикутниками можна здійснити по тому ж алгоритму, що й раніше. Таке співпадіння змушує замислитись над пошуком нових кількісних характеристик, котрі могли б відрізнити нерівномірний розподіл точок від рівномірного. \n\n\nІнший, складніший приклад неоднорідного фрактала, який ми б хотіли ще навести, показано на наступному рисунку. Ліворуч продемонстровано великий квадрат зі стороною, що дорівнює одиниці, який на цьому (нульовому) етапі повністю покриває собою деяку фрактальну множину точок $M$. На наступному (першому) етапі, у центрі малюнка,\nпоказано, як ту саму множину можна покрити трьома меншими квадратами зі сторонами $l_1=1/2, \\ l_2=l_3=5/16$, у яких, відповідно, міститься частка $p_1=1/2, \\ p_2=1/3$ та $p_3=1/6$ усіх точок.\n\n::: {#fig-dist-square}\n\n![](Images\\lab_7\\square_fractal.jpg)\n\nПриклад мультифрактала, що підкоряється ренормалізаційній схемі \n\n:::\n\nНаступний етап покриття (зображений на рисунку праворуч) містить уже 9 квадратів зі сторонами $l_{1}^{2}=1/4, \\ l_{1}l_{2}=l_{1}l_{3}=5/32$ (у нижньому правому куті) і $l_{2}l_{1}=5/32, \\ l_{2}^{2}=l_{2}l_{3}=25/256$ (угорі праворуч і ліворуч). Відносна заселеність цих квадратів точками множини показана на рисунку. Вона відповідає добутку чинників заселеності (імовірностей): $p_{1}^{2}=1/4, \\ p_{1}p_{2}=1/6, \\ p_{1}p_{3}=1/12$ --- для нижньої правої групи, $p_{2}p_{1}=1/6, \\ p_{2}^{2}=1/9, \\ p_{2}p_{3} = 1/18$ --- для верхньої лівої та $p_{3}p_{1}=1/12, \\ p_{3}p_{2}=1/18, \\ p_{3}^{2}=1/36$ --- для верхньої правої групи. Зазначимо, що є чітка відповідність між заселеністю квадрата $p_{j}p_{i}$ і його розмірами $l_{i}l_{i}$.\n\n\nПодальший процес розбиття і покриття множини $M$ здійснюється згідно із цією ренормалізаційною схемою. Кожен квадрат, що має на $n$-му кроці розмір $l$ і заселеність $р$, замінюється на $n+1$ кроці трьома квадратами з розмірами $ll_{1}, \\ ll_{2}, \\ ll_{3}$ і заселеностями $pp_{1}, \\ pp_{2}, \\ pp_{3}$ відповідно, розміщеними таким самим чином відносно один одного, як показано на попередньому посередні рисунку.\n\nДвоє розглянутих вище випадки являють собою приклади неоднорідних фракталів. Під словом \"неоднорідний\" ми тут розуміємо нерівномірний розподіл точок множини по фракталу або нерівномірний розподіл малих та великих флуктуацій у часовому ряді. Причина неоднорідності в попередніх випадках одна й та сама --- різні ймовірності заповнення геометрично однакових елементів фрактала, або в загальному випадку невідповідність імовірностей заповнення геометричним розмірам відповідних областей. Такі неоднорідні фрактальні об'єкти в літературі називають мультифракталами, і їх вивченням ми й займемося надалі.\n\n\n### Узагальнені фрактальні розмірності $D_{q}$\n\nДамо загальне визначення мультифрактала. Розглянемо фрактальний об'єкт, що займає якусь обмежену ділянку $\\Omega$ розміру $L$ у Евклідовому просторі з розмірністю $d$. Нехай на якомусь етапі його побудови він являє собою множину з $N \\gg 1$ точок, якось розподілених у цій області. Ми будемо припускати, що врешті-решт $N \\to \\infty$. Прикладом такої множини може слугувати трикутник Серпінського, побудований методом випадкових ітерацій. Кожен крок ітераційної процедури додає до цієї множини одну нову точку.\n\nРозіб'ємо всю область $\\Omega$ на кубічні клітинки зі стороною $\\varepsilon \\ll L$ та об'ємом $\\varepsilon^{d}$. Далі нас будуть цікавити тільки зайняті клітинки, у яких міститься хоча б одна точка. Нехай номер зайнятих комірок $i$ змінюється в межах $і=1, 2,..., N(\\varepsilon)$, де $N(\\varepsilon)$ --- сумарна кількість зайнятих клітинок, яка, звісно, залежить від розміру клітинки $\\varepsilon$.\n\nНехай $n_{i}(\\varepsilon)$ представляє собою кількість точок у клітинці з номером $i$, тоді величина \n\n$$\np_{i}(\\varepsilon) = \\lim_{N\\to\\infty}\\frac{n_{i}(\\varepsilon)}{N}\n$$\n\nпредставляє собою ймовірність того, що навмання взята точка з нашої множини знаходиться в комірці $i$. Інакше кажучи, ймовірності $р_{i}$ характеризують відносну заселеність комірок. З умови нормування ймовірності випливає, що \n\n$$\n\\sum_{i=1}^{N(\\varepsilon)}p_{i}(\\varepsilon)=1.\n$$\n\n\nУведемо тепер у розгляд **узагальнену статистичну суму** $Z(q,\\varepsilon)$, що характеризується показником ступеня $q$, який може набувати будь-яких значень в інтервалі $-\\infty<q<+\\infty$\n\n$$\nZ(q,\\varepsilon)=\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon).\n$$\n\nСпектр **узагальнених фрактальних розмірностей** $D_{q}$, що характеризує даний розподіл точок в області $\\Omega$, визначається за допомогою співвідношення \n\n$$\nD_{q} = \\frac{\\tau(q)}{q-1}, \n$$\n\nде функція $\\tau(q)$ має вид \n\n$$\n\\tau(q)=\\lim_{\\varepsilon\\to 0}\\frac{\\ln{Z(q,\\varepsilon)}}{\\ln{\\varepsilon}}.\n$$\n\n\nЯк ми покажемо нижче, якщо $D_{q}=D=\\text{const}$, тобто не залежить від $q$, то дана множина точок являє собою звичайний, регулярний фрактал, який характеризується лише однією величиною --- фрактальною розмірністю $D$. Навпаки, якщо функція $D_{q}$ якось змінюється з $q$, то розглянута множина точок представляє мультифрактал.\n\nТаким чином, мультифрактал у загальному випадку характеризується деякою **нелінійною** функцією $\\tau(q)$, що визначає поведінку статистичної суми $Z(q,\\varepsilon)$ при $\\varepsilon\\to 0$\n\n$$\\tag{1}\nZ(q,\\varepsilon)=\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon) \\approx \\varepsilon^{\\tau(q)}.\n$$\n\n\nСлід мати на увазі, що в реальній ситуації ми завжди маємо скінченне, хоча й дуже велике число дискретних точок $N$, тому при комп'ютерному моделювані конкретної множини граничний перехід $\\varepsilon\\to 0$ треба виконувати з обережністю, пам'ятаючи, що йому завжди передує ліміт $N \\to 0$.\n\nПокажемо тепер, як поводиться узагальнена статистична сума у випадку звичайного регулярного фрактала з фрактальною розмірністю $D$. У цьому випадку в усіх зайнятих комірках міститься однакова кількість точок\n\n$$\nn_{i}(\\varepsilon)=\\frac{N}{N(\\varepsilon)}, \n$$\n\nтобто фрактал представляється **однорідним**. Тоді очевидно, що відносні населеності клітинок, $p_{i}(\\varepsilon)=1/N(\\varepsilon)$, також однакові, і узагальнена статистична сума набуває вигляду \n\n$$\\tag{2}\nZ(q,\\varepsilon) = N^{1-q}(\\varepsilon).\n$$\n\nВрахуємо тепер, що, згідно визначеню фрактальної розмірності $D$, кількість зайнятих клітинок при достатньо малому $\\varepsilon$ поводить себе наступним чином:\n\n$$\\tag{3}\nN(\\varepsilon) \\approx \\varepsilon^{-D}.\n$$\n\nПідставляючи (3) у формулу (2), і порівнюючи з (1), отримуємо\n\n$$\\tag{4}\n\\varepsilon^{\\tau(q)} = \\varepsilon^{-D(1-q)} \\to \\tau(q)=(q-1)D. \n$$\n\nМи приходимо до висновку, що у випадку звичайного фрактала функція (4) є лінійною. Тоді всі $D_{q}$ дійсно не залежать від $q$. Фрактал у якого всі узагальнені фрактальні розмірності $D_{q}$ співпадають називається **монофракталом**.\n\nЯкщо розподіл точок по клітинкам неоднаковий, тоді фрактал називається неоднорідним, тобто представляє із себе мультифрактал, і для його характеристики необхідний цілий спектр узагальнених фрактальних розмірностей $D_{q}$, кількість котрих, у загальному випадку, нескінченна. \n\nТак, наприклад, при $q \\to +\\infty$ основний внесок в узагальнену статистичну суму (1) вносять комірки, що містять найбільшу кількість частинок $n_{i}$ у них і, відповідно, що характеризуються найбільшою ймовірністю їх заповнення $p_{i}$. Навпаки, при $q \\to -\\infty$ основний внесок в узагальнену статистичну суму вносять найбільш розрідженні комірки з найменшою ймовірністю їх заповнення $p_{i}$. Таким чином, функція $D_{q}$ показує, наскільки неоднорідним представляється досліджувана множина точок $\\Omega$. \n\nУ подальшому для характеристики розподілу точок необхідно знати не тільки функцію $\\tau(q)$, але і її похідну:\n\n$$\n\\frac{d\\tau(q)}{dq} = \\lim_{\\varepsilon\\to 0}\\frac{\\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}\\ln{p_{i}}}{\\left( \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q} \\right)\\ln{\\varepsilon}}.\n$$\n\nЦя похідна має важливий фізичний зміст, який буде продемонстровано пізніше. Зараз знову зазначимо, що для мультифрактальної системи вона не залишається константною і змінюється з $q$. \n\n### Функція мультифрактального спектра $f(\\alpha)$\n\n#### Спектр фрактальних розмірностей\n\nУ попередньому пункті ми ввели поняття мультифрактала --- об'єкта, що представляє собою неоднорідний фрактал. Для його опису ми ввели множину узагальнених фрактальних розмірностей $D_{q}$, де $q$ приймає будь-які значення в інтервалі $-\\infty<q<+\\infty$. Однак величини $D_{q}$ не є, строго кажучи, фрактальними розмірностями в загальному розумінні цього слова. \n\n\nТому часто поряд із ними для характеристики мультифрактальної множини використовують так звану **функцію мультифрактального спектра** $f(\\alpha)$ (спектр сингулярностей мультифрактала), до якої, як ми побачимо надалі, більше підходить термін фрактальна розмірність. Ми покажемо, що величина $f(\\alpha)$ фактично дорівнює хаусдорфовій розмірності якоїсь однорідної фрактальної підмножини із вихідної множини $\\Omega$, що дає домінантний внесок у статистичну суму при заданій величині $q$.\n\nОднією з основних характеристик мультифрактала є набір імовірностей $р_{i}$, що показують відносну заселеність клітинок $\\varepsilon$, якими ми покриваємо цю множину. Чим менший розмір клітинки, тим менша величина її заселеності. Для самоподібних множин залежність $p_{i}$ від розміру клітинки $\\varepsilon$ має степеневий характер:\n\n$$\np_{i}(\\varepsilon) \\approx \\varepsilon^{\\alpha_{i}}, \n$$\n\nде $\\alpha_{i}$ являє собою деякий показник ступеня (різний для різнок клітинок $i$). Відомо, що для регулярного (однорідного) фрактала всі показники ступеня $\\alpha_{i}$ однакові й рівні фрактальній розмірності $D$:\n\n$$\np_{i} = \\frac{1}{N(\\varepsilon)} \\approx \\varepsilon^{D}.\n$$\n\nУ даному випадку статистична сума (1) приймає наступний вигляд:\n\n$$\nZ(q,\\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)}p_{i}^{q}(\\varepsilon) = N(\\varepsilon)\\varepsilon^{Dq}=\\varepsilon^{-D}\\varepsilon^{Dq} \\approx \\varepsilon^{D(q-1)}. \n$$\n\nТому $\\tau(q)=D(q-1)$ і всі узагальнені фрактальні розмірності $D_{q}=D$ у цьому випадку співпадають та не залежать від $q$. \n\nОднак, для такого складного об'єкта, як мультифрактал, унаслідок його неоднорідності, ймовірності заповнення клітинок $p_{i}$ у загальному випадку різняться, і показник ступеня $\\alpha_{i}$ для різних клітинок може приймати різні значення. Достатньо типовою є ситуація, коли ці значення неперервно заповнюють деякий закритий інтервал $\\left( \\alpha_{min}, \\alpha_{max} \\right)$, причому \n\n$$\np_{min} \\approx \\varepsilon^{\\alpha_{max}}, \\; \\text{a} \\; p_{max} \\approx \\varepsilon^{\\alpha_{min}}. \n$$\n\nТепер перейдемо до питання о розподілі ймовірностей різних значень $\\alpha_{i}$. Нехай $n(\\alpha)d\\alpha$ є ймовірністю того, що $\\alpha_{i}$ знаходиться в інтервалі від $\\alpha$ до $\\alpha+d\\alpha$. Іншими словами, $n(\\alpha)d\\alpha$ представляє собою відносну кількість клітинок $i$, що характеризуються однією і тією самою мірою $p_{i}$ з $\\alpha_{i}$, що лежать у цьому інтервалі. У випадку монофрактала, для котрого всі $\\alpha_{i}$ однакові (і рівні фрактальній розмірності $D$), це число, очевидно, пропорційно повній кількості клітинок $N(\\varepsilon) \\approx \\varepsilon^{-D}$, степеневим чином залежних від розміру клітинки $\\varepsilon$. Показник ступеня в цьому співвідношені визначається фрактальною розмірністю множини $D$. \n\nДля мультифрактала, однак, це не так, і різні значення $\\alpha_{i}$ зустрічаються з ймовірністю, що характеризується не однією і тією ж величиною $D$, а різними (в залежності від $\\alpha$) значеннями показниками ступеня $f(\\alpha)$, \n\n$$\\tag{5}\nn(\\alpha) \\approx \\varepsilon^{-f(\\alpha)}.\n$$\n\nТаким чином, фізичний сенс функції $f(\\alpha)$ полягає в тому, що вона представляє собою розмірність хаусдорфа деякої однорідної підмножини $\\Omega_{\\alpha}$ із вихідної множини $\\Omega$, що характеризується однаковими ймовірностями заповнення клітинок $p_{i} \\approx \\varepsilon^{\\alpha}$. Оскільки фрактальна розмірність підмножини очевидно завжди менша або рівна фрактальній розмірності вихідної множини $D_{0}$, має місце важлива нерівність для функції $f(\\alpha)$:\n\n$$\nf(\\alpha) \\leq D_{0}. \n$$\n\nУ результаті можна зробити висновок, що множина різних значень функції $f(\\alpha)$ (при різних $\\alpha$) представляє собою **спектр фрактальних розмірностей** однорідних підмножин $\\Omega_{\\alpha}$, на які можна розбити вихідну множину $\\Omega$, кожна з яких характеризується власним значенням фрактальної розмірності $f(\\alpha)$. \n\nОскільки будь-якій підмножині належить лише частина загальної кількості клітинок $N(\\varepsilon)$, на котрі ми розділили вихідну множину $\\Omega$, умова нормування ймовірностей, очевидно, не виконується при підсумовуванні тільки по цій підмножині. Сума цих імовірностей стає менше одиниці. Тому й самі ймовірності $p_i$ з одним і тим самим значенням $\\alpha_i$ очевидно менше (або в крайньому випадку одного порядку), ніж величина $\\varepsilon^{f(\\alpha_i)}$, яка обернено пропорційна кількості наявних клітинок, що покривають дану підмножину (нагадаємо, що у випадку монофрактала $p_i \\approx 1/N(\\varepsilon)$). У результаті ми приходимо до наступної важливої нерівності для функції $f(\\alpha)$. А саме, при всіх значеннях $\\alpha$\n\n$$\nf(\\alpha) \\leq \\alpha. \n$$\n\nЗнак рівності має місце, наприклад, для повністю однорідного фрактала, де $f(\\alpha)=\\alpha=D$. \n\n\n#### Перетворення Лежандра\n\nВстановимо зв'язок функції $f(\\alpha)$ із введенною раніше функцією $\\tau(q)$. Обчислимо для цього статистичну суму $Z(q,\\varepsilon)$. Підставляє у статистичну суму ймовірності $p_i \\approx \\varepsilon^{\\alpha_i}$, та переходячи від підсумовування по $i$ до інтегрування по $\\alpha$ з плотністю ймовірностей (5), ми отримаємо\n\n$$\\tag{6}\nZ(q,\\varepsilon) = \\sum_{i=1}^{N(\\varepsilon)} p_{i}^{q}(\\varepsilon) \\approx \\int d\\alpha n(\\alpha)\\varepsilon^{q\\alpha} \\approx \\int d\\alpha\\varepsilon^{q\\alpha-f(\\alpha)}. \n$$\n\nТак як величина $\\varepsilon$ дуже мала, основний внесок у цей інтеграл вноситимуть ті значення $\\alpha(q)$, при яких показник ступеня $q\\alpha-f(\\alpha)$ виявляється мінімальним (а підінтегральна функція --- максимальною). Цей вклад буде пропорційним значенню підінтегральної функції у точці максимума. Саме ж значення $\\alpha(q)$ визначається при цьому з наступної умови:\n\n$$\n\\left. \\frac{d}{d\\alpha}[ q\\alpha-f(\\alpha) ] \\right \\vert_{\\alpha=\\alpha(q)} = 0. \n$$\n\nТакож, з умови мінімуму ми маємо\n\n$$\n\\left. \\frac{d^{2}}{d\\alpha^{2}}[ q\\alpha-f(\\alpha) ] \\right \\vert_{\\alpha=\\alpha(q)} > 0. \n$$\n\nУ результаті отримуємо, що залежність $\\alpha(q)$ неявним чином визначається з рівняння \n\n$$\\tag{7}\nq = \\frac{df(\\alpha)}{d\\alpha}\n$$\n\nі що функція $f(\\alpha)$ усюди є випуклою\n\n$$\nf^{''}(\\alpha)>0.\n$$\n\nЦе значить, що величина $f(\\alpha(q))$ дійсно визначає фрактальну розмірність підмножини $\\Omega_{\\alpha(q)}$, що має найбільший домінуючий внесок у статистичну суму (6) при заданій величині показника ступеня $q$. \n\nОскільки $Z(q,\\varepsilon)=\\tau(q)$, приходимо до висновку, що \n\n$$\n\\tau(q) = q\\alpha(q) - f(\\alpha(q)). \n$$\n\nПам'ятаючи, що $\\tau(q)=D(q-1)$, можемо віднайти функцію $D_{q}$: \n\n$$\\tag{8}\nD_{q} = \\frac{1}{q-1}[ q\\alpha(q)-f(\\alpha(q)) ]. \n$$\n\nТаким чином, якщо ми знаємо функцію мультифрактального спектра $f(\\alpha)$, то з домомогою співвідношень (7) та (8) ми можемо знайти функцію $D_{q}$. Навпаки, знаючи $D_{q}$, ми можемо знайти залежність $\\alpha(q)$ з допомогою рівняння\n\n$$\\tag{9}\n\\alpha(q) = \\frac{d}{dq}[(q-1)D_{q}]\n$$\n\nі після цього знайти із (8) залежність $f(\\alpha(q))$. Ці два рівняння і визначають функцію $f(\\alpha)$. \n\n$$\n\\frac{d\\tau}{dq}\\frac{dq}{d\\alpha} = q + \\alpha\\frac{dq}{d\\alpha} - \\frac{df}{d\\alpha}.\n$$\n\nПриймаючи до уваги те, що $q=df/d\\alpha$, і скорочуючи це рівняння на $dq/d\\alpha$, приходимо до співвідношення \n\n$$\n\\alpha = \\frac{d\\tau(q)}{dq}, \n$$\n\nщо еквівалентне виразу (9). \n\nВирази для $\\tau(q)$ та $\\alpha(q)$ задають **перетворення Лежандра** від змінних $\\{ q, \\tau(q) \\}$ до змінних $\\{\\alpha, f(\\alpha)\\}$: \n\n$$\\tag{10}\n\\alpha = \\frac{d\\tau}{dq}\n$$\n\nта \n\n$$\\tag{11}\nf(\\alpha) = q\\frac{d\\tau}{dq} - \\tau.\n$$\n\nЯк відомо, для однорідного фрактала $D_{q}=D=\\text{const}$. Тому $\\alpha=d\\tau/dq=D$ і $f(\\alpha)=q\\alpha-\\tau(q)=qD-D(q-1)=D$. У цьому випадку \"графік\" функції $f(\\alpha)$ на площині $\\left( \\alpha, f(\\alpha) \\right)$ складається лише з однієї точки  $\\left( D, D \\right)$. \n\n### Мультифрактальний аналіз детрендованих флуктуацій\n\nМонофрактальні та мультифрактальні структури фінансових сигналів є особливим різновидом масштабно-інваріантних структур. Найчастіше монофрактальна структура фінансових часових рядів визначається одним степеневим показником і передбачає, що масштабо-інваріантність не залежить від часу і простору. Однак, часто ми маємо змогу спостерігати просторово-часову варіацію масштабно-інваріантної структури досліджуваної складної системи. Ці просторово-часові варіації вказують на мультифрактальність фінансового сигналу, яка визначається мультифрактальним спектром. Ширина і форма мультифрактального спектра можуть також допомогти диференціювати варіативність серцевого ритму у пацієнтів із серцевими захворюваннями, такими як шлуночкова тахікардія, фібриляція шлуночків і застійна серцева недостатність. Мультифрактальний спектр може допомогти кількісно визначити асиметрію підйомів та спадів на фондовому чи криптовалютному ринках, передбачити фінансову кризу, що поступово наближується, і, таким чином, сприяти успішності подальших торгівельних рішень. Основна мета цього розділу --- представити одну з найточніших процедур для визначення множини фрактальних показників --- **мультифрактальний аналіз детрендованих флуктуацій** (multifractal detrended fluctuation analysis, MFDFA).\n\nПобудова MFDFA складається з восьми кроків: Розділ *\"Шум і випадкові блукання у часовому ряді\"* представляє метод приведення часового ряду до такого, що подібний до випадкового блукання, що є попереднім кроком для MFDFA. Розділ *\"Обчислення середньоквадратичної варіації часового ряду\"* представляє середньоквадратичну варіацію, яка є основною процедурою для подальших обчислень в MFDFA і типовим способом обчислення середньої варіації часових рядів різної природи. Розділ *\"Локальна середньоквадратична варіація часового ряду\"* представляє обчислення локальної варіації часового ряду як середньоквадратичного відхилення часового ряду в межах сегментів, що можуть як перекриватися, так і не перекриватися. У розділі *\"Локальне детрендування часового ряду\"* таке ж локальне середньоквадратичне відхилення обчислюється навколо трендів, які часто зустрічаються у фінансових часових рядах. У розділі *\"Монофрактальний аналіз детрендованих флуктуацій\"* амплітуди локальних середніх квадратичних відхилень підсумовуються в узагальнене середнє квадратичне відхилення. У сумарному середньоквадратичному відхиленні для сегментів з малими розмірами вибірки переважають швидкі флуктуації часового ряду. На противагу цьому, у сумарному середньоквадратичному відхиленні для сегментів з великими розмірами вибірки переважають повільні коливання. Степенева залежність між загальним середнім квадратичним відхиленням для декількох розмірів вибірки (тобто масштабів) визначається за допомогою монофрактального аналізу дентрендованих флуктуацій (monofractal detrended fluctuation analysis, DFA) і називається показником Херста (Hurst exponent, $H$). У розділі *\"Мультифрактальний аналіз детрендованих флуктуацій\"* MFDFA отримують шляхом розширення на $q$-й порядок узагальненого середньоквадратичного відхилення. Середньоквадратичне відхилення $q$-го порядку може розрізняти сегменти з малими та великими флуктуаціями. Степенева залежність між середньоквадратичним відхиленням $q$-го порядку чисельно визначається як показник Херста $q$-го порядку. У розділі *\"Мультифрактальний спектр часових рядів\"* на основі показника Херста $q$-го порядку обчислено декілька мультифрактальних спектрів.\n\nДля подальшої візуалізації кожного кроку процедури MFDFA імпортуємо наступні модулі:\n\nІ виконаємо налаштування рисунків для виведення:\n\nЦього разу розглянему можливість побудови індикаторів або індикаторів-передвісників на прикладі індексу сирої нафти West Texas Intermediate (WTI). При описі процедури MFDFA порівнюватимемо мультифрактальність даного ряду зі штучно зненерованими монофрактальними рядами складність яких має представлятися меншою у порівняні з нафтою. \n\nСам сайт Yahoo! Finance містить досить коротку історію щодених цін на нафту даної марки. Цього разу, в якості альтернативного прикладу, будемо послуговуватись альтернативним джерелом фінансових даних --- [федеральним резервом економічних даних федерального резервного банку Сент-Луїса](https://fred.stlouisfed.org) (Federal Reserve Economic Data of the Federal Reserve Bank of St. Louis, FRED). На Python було створено бібліотеку для вивантаження даних із даного джерела --- `pandas-datareader`. Для її встановлення достатньо прописати наступну команду:\n\nТепер імпортуємо відповідну бібліотеку:\n\nта виконаємо зчитування індексу з FRED, використовуючи функціонал даної бібліотеки. Завантажимо дані за весь період, що нам буде доступний:\n\nВиведемо досліджуваний ряд:\n\nРозглянемо опис нашого масиву даних:\n\nНа представленому рисунку видно, що в значеннях досліджуваного індексу існують пропуски та негативні значення на ціну нафти. Для того, щоб позбутися від'ємного значення, можна виконати заміну значення на таке, що близьке до нуля. Для видалення значень `NaN` достатньо скористатися методом `dropna()` бібліотеки `pandas`.\n\nЗнову візуалізуємо результат:\n\nОстаннє, що нам залишається, це приведення вихідного ряду до прибутковостей. Для цього визначимо функцію `transformation()` та знайдемо з її допомогою прибутковості: \n\nЯк вже зазначалося, при описі процедури MFDFA, ми будемо послуговуватись для порівняння і монофрактальними сигналами. Для подальших розрахунків згенеруємо сигнал білого та рожевого шумів. У цьому нам може допомогти функція `signal_noise()` бібліотеки `neurokit2`. Ця функція генерує чистий гаусовий `(1/f)**beta` шум. Спектр потужності згенерованого шуму пропорційний `S(f) = (1/f)**beta`. Було описано наступні категорії шуму: \n\n- фіолетовий шум: beta = -2\n- синій шум: beta = -1\n- білий шум: beta = 0\n- флікер / рожевий шум: beta = 1\n- коричневий шум: beta = 2\n\nЇї синтаксис виглядає наступним чином:\n\n**`signal_noise(duration=10, sampling_rate=1000, beta=1, random_state=None)`**\n\n**Параметри**\n\n- **duration** (*float*) --- бажана тривалість (у секундах).\n- **sampling_rate** (*int*) --- бажана частота дискретизації (у Гц, тобто відліків на секунду).\n- **beta** (*float*) --- експонента шуму.\n- **random_state** (*None, int, numpy.random.RandomState або numpy.random.Generator*) --- початкове значення (зерно) для генератора випадкових чисел.\n\n**Повертає**\n\n- **noise** (*array*) --- сигнал чистого шуму.\n\nТепер можемо згенерувати 2 види шумів:\n\nІ тепер приступаємо до подальшої роботи. \n\n#### Шум і випадкові блукання у часовому ряді\n\nМультифрактальний аналіз детрендованих флуктуацій базується на класичному аналізі детрендованих флуктуацій (DFA). Класичний DFA застосовується до часових рядів зі структурою, подібною до випадкових блукань. Однак більшість фінансових часових рядів мають коливання, які більш схожі на прирости випадкових блукань. Якщо фінансовий часовий ряд має структуру, подібну до шуму, як у прибутковостей, його слід перетворити на випадково-блукаючий часовий ряд перед застосуванням DFA. Шуми можна перетворити на випадкові блукання шляхом віднімання середнього значення та інтегрування часового ряду (знаходження його кумулятивної суми). Часовий ряд з білим шумом, монофрактал (рожевий шум) і мультифрактал є шумовими часовими рядами і перетворюються на випадкові блукання за допомогою коду, що наведеного нижче:\n\n#### Обчислення середньоквадратичної варіації часового ряду \n\nТрадиційний аналіз варіації часових рядів полягає в обчисленні середнього значення варіації як середньоквадратичного відхилення. Читач може скористатися наведеним нижче кодом для обчислення середньоквадратичного відхилення для часових рядів з білим шумом, монофрактальних і мультифрактальних даних:\n\n@fig-step-2 ілюструє, що середня амплітуда варіації (тобто середньоквадратичне відхилення) є однаковою для всіх трьох часових рядів --- білого шуму, монофрактального та мультифрактального, навіть якщо вони мають досить різну структуру. MFDFA може розрізняти ці структури, як ми побачимо в наступних розділах.\n\n#### Локальна середньоквадратична варіація часового ряду\n\nМультифрактальні часові ряди на верхній панелі мають локальні флуктуації як з великими, так і з малими величинами. Середньоквадратичне відхилення (RMS) у попередньому коді можна обчислити для сегментів часового ряду, щоб розрізнити величини локальних флуктуацій. Проста процедура полягає в тому, щоб розділи часовий ряд на однакові за розміром сегменти, що не перекриваються, і обчислити локальне середнє квадратичне відхилення для кожного сегмента. Це можна зробити за допомогою коду наведеного нижче, і це є основною MFDFA:\n\nПерший рядок коду функції `calc_rms()` перетворює зашумлений часовий ряд, мультифрактал, на часовий ряд випадкового блукання $X$. Третій рядок коду задає масштаб параметра, який визначає розмір вибірки сегментів, що не перетинаються, для яких обчислюється локальне середнє квадратичне відхилення, `RMS`. П'ятий рядок --- це кількість сегментів, на які можна розбити часовий ряд $X$, де `len(X)` --- розмір вибірки часового ряду $X$. Таким чином, `segments = 6` при `len(X) = 9335` і `scale = 1335`. З дев'ятого по шістнадцятий рядок --- це цикл, який обчислює локальне середньоквадратичне значення навколо тренду `fit[v]` для кожного сегмента, оновлюючи часовий індекс. У першому циклі `v = 0`, `Index[0]` переходить від 0 до 1335 значення сегмента (не включно). У другому циклі $v = 1$, `Index[1]` переходить від 1335 до 2670 значення другого сегмента. В останньому циклі $v = 6$, `Index[6]` переходить від 8010-го до 9345-го значення (не включно).\n\n#### Локальне детрендування часового ряду\n\nУ складних системах наявні повільні мінливі тренди, тому для кількісної оцінки масштабо-інваріантності флуктуацій навколо цих трендів необхідно провести детрендування сигналу. У попередньому коді до $X$ на кожному сегменті $v$ підбирається поліноміальний тренд `fit[v]`. Параметр $m$ визначає порядок полінома. Поліноміальний тренд є лінійним, якщо $m = 1$, квадратичним, якщо $m = 2$, і кубічним, якщо $m = 3$. Рядок `C = np.polyfit(Index[v], X[Index[v]], m)` визначає коефіцієнти полінома `C`, які використовуються для створення поліноміальної залежності тренду `fit[v]` для кожного сегмента. Потім для залишкової варіації, `X(Index[v])-fit[v]`, обчислюється локальне середньоквадратичне відхилення, `RMS[v]`, в межах кожного сегмента $v$. Локальна середньоквадратична варіація, `RMS[v]`, представлено на наступному рисунку як відстань між червоними пунктирними трендами і червоними суцільними лініями.\n\n#### Монофрактальний аналіз детрендованих флуктуацій\n\nУ DFA варіації локального середньоквадратичного відхилення кількісно оцінюються загальним середньоквадратичним відхиленням ($F$).\n\nШвидкі коливання часового ряду $X$ впливатимуть на загальне середньоквадратичне відхилення, $F$, у сегментах малої довжини (масштабу), тоді як повільні коливання впливатимуть на $F$ у сегментах великої довжини (масштабу). Таким чином, функція флуктуацій, $F$, повинна бути обчислена для декількох масштабів, щоб виокремити вплив як швидкоплинних, так і повільних коливань, які у свою чергу визначають структурні перетворення часового ряду. Функція флуктуацій $F(ns)$ може бути обчислена для декількох масштабів шляхом модифікації попереднього коду:\n\nDFA визначає монофрактальну структуру часового ряду відповідно до степеневої залежність між загальним середнім квадратичним відхиленням (тобто $F$), обчисленим для декількох масштабів. Степенева залежність між загальним середнім квадратичним відхиленням позначається нахилом ($H$) лінії регресії, розрахованим за допомогою коду, що представлений нижче:\n\nМодифікуємо попередній код, додавши нові фрагменти:\n\nТепер розглянемо залежність загальної функції флуктуацій $F$ від різних довжин (масштабів) локальних сегментів ряду для досліджуваних нами рядів:\n\nЯк уже зазначалося в попередній лабораторній роботі, кут нахилу $H$ ліній регресії називається показником Херста. Показник Херста визначає монофрактальну структуру часового ряду, показуючи, наскільки швидко зростає загальне середньоквадратичне відхилення, $F$, локальних коливань, `RMS`, зі збільшенням розміру локальних сегментів ряду (тобто, масштабу). @fig-step-6 показує, що загальне середньоквадратичне значення локальних флуктуацій, $F$, зростає швидше зі збільшенням розміру вибірки сегментів для монофрактального рожевого шуму порівняно з індексом нафти та білим шумом. Більший показник Херста, $H$, візуально свідчить про повільнішу еволюцію варіацій (тобто більш стійку структуру) в рожевому шумі порівняно з нафтою та білим шумом. @fig-hurst ілюструє, що показник Херста визначає континуум між часовими рядами, подібними до шуму, і часовими рядами, подібними до випадкового блукання. Показник Херста знаходиться в інтервалі від 0 до 1 для часових рядів, подібних до шуму, тоді як для часових рядів, подібних до випадкових блукань, він перевищує 1. Часовий ряд має довгострокову залежну (тобто корельовану) структуру, коли показник Херста знаходиться в інтервалі 0.5-1, і антикорельовану структуру, коли показник Херста знаходиться в інтервалі 0-0.5. Часовий ряд має незалежну або короткострокову залежну структуру в окремому випадку, коли показник Херста дорівнює 0.5. Згідно з попереднім рисунком, часові ряди білого шуму та нафти представляються непередбачуваними, оскільки показник Херста близький до 0.5, тоді як рожевий шум довгостроково залежну структуру з показником Херста близьким до 1.\n\n#### Мультифрактальний аналіз детрендованих флуктуацій\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"highlight-style":"oblivion","css":["style.css"],"output-file":"lab_7.html"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рисунок","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"ru","fig-responsive":true,"quarto-version":"1.3.433","bibliography":["references.bib"],"callout-appearance":"default","page-layout":"full","theme":{"light":"cosmo","dark":"superhero"},"title":"Лабораторна робота № 7"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":true,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","toc":true,"number-sections":true,"output-file":"lab_7.pdf"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рисунок","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"block-headings":true,"lang":"ru","bibliography":["references.bib"],"callout-appearance":"default","documentclass":"report","title":"Лабораторна робота № 7"},"extensions":{"book":{"selfContainedOutput":true}}},"docx":{"identifier":{"display-name":"MS Word","target-format":"docx","base-format":"docx"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","toc":true,"number-sections":true,"output-file":"lab_7.docx"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рисунок","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"ru","bibliography":["references.bib"],"callout-appearance":"default","title":"Лабораторна робота № 7"},"extensions":{"book":{"selfContainedOutput":true}}},"epub":{"identifier":{"display-name":"ePub","target-format":"epub","base-format":"epub"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"epub","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":false,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"default-image-extension":"png","html-math-method":"mathml","to":"epub","toc":true,"number-sections":true,"output-file":"lab_7.epub"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Другие форматы","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Источник","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Авторские права","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","callout-tip-title":"Совет","callout-note-title":"Уведомление","callout-warning-title":"Предупреждение","callout-important-title":"Важное уведомление","callout-caution-title":"Осторожность","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","code-line":"Линия","code-lines":"Линии","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Наверх","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Поиск","toggle-section":"Переключить раздел","toggle-sidebar":"Переключить боковую панель навигации","toggle-dark-mode":"Переключить темный режим","toggle-reader-mode":"Переключить режим чтения","toggle-navigation":"Переключить навигацию","crossref-fig-title":"Рисунок","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів"},"metadata":{"lang":"ru","bibliography":["references.bib"],"callout-appearance":"default","title":"Лабораторна робота № 7"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf","docx","epub"]}