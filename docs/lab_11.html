<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Моделювання складних систем у Python - 8&nbsp; Лабораторна робота № 11</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab_12.html" rel="next">
<link href="./lab_6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Пошук не дав результату",
    "search-matching-documents-text": "Результати пошуку",
    "search-copy-link-title": "Скопіюйте посилання для пошуку",
    "search-hide-matches-text": "Приховати додаткові результати",
    "search-more-match-text": "Додатковий результат у цьому документі",
    "search-more-matches-text": "Додаткові результати у цьому документі",
    "search-clear-button-title": "Очистити",
    "search-detached-cancel-button-title": "Скасувати",
    "search-submit-button-title": "Надіслати",
    "search-label": "Поиск"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lab_11.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Лабораторна робота № 11</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Моделювання складних систем у Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Butman2099/Complex-systems-book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Переключить темный режим"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Поиск"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Передмова</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Вступ</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Лабораторна робота № 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Лабораторна робота № 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Лабораторна робота № 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Лабораторна робота № 4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Лабораторна робота № 5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_11.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Лабораторна робота № 11</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Лабораторна робота № 12</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Додатки</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Інструкція зі встановлення Anaconda Navigator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Вступ до мови програмування Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Основи Jupyter Notebook</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Зміст</h2>
   
  <ul>
  <li><a href="#незворотність-на-основі-діаграм-пуанкаре" id="toc-незворотність-на-основі-діаграм-пуанкаре" class="nav-link active" data-scroll-target="#незворотність-на-основі-діаграм-пуанкаре"><span class="header-section-number">8.1</span> Незворотність на основі діаграм Пуанкаре</a></li>
  <li><a href="#методи-складних-мереж" id="toc-методи-складних-мереж" class="nav-link" data-scroll-target="#методи-складних-мереж"><span class="header-section-number">8.2</span> Методи складних мереж</a></li>
  <li><a href="#незворотність-на-основі-пермутаційних-шаблонів" id="toc-незворотність-на-основі-пермутаційних-шаблонів" class="nav-link" data-scroll-target="#незворотність-на-основі-пермутаційних-шаблонів"><span class="header-section-number">8.3</span> Незворотність на основі пермутаційних шаблонів</a></li>
  <li><a href="#підключення-необхідних-бібліотек" id="toc-підключення-необхідних-бібліотек" class="nav-link" data-scroll-target="#підключення-необхідних-бібліотек"><span class="header-section-number">8.4</span> Підключення необхідних бібліотек</a></li>
  <li><a href="#встановлення-параметрів-для-побудови-графіків" id="toc-встановлення-параметрів-для-побудови-графіків" class="nav-link" data-scroll-target="#встановлення-параметрів-для-побудови-графіків"><span class="header-section-number">8.5</span> Встановлення параметрів для побудови графіків</a></li>
  <li><a href="#визначення-функції-для-побудови-рекурентного-графа" id="toc-визначення-функції-для-побудови-рекурентного-графа" class="nav-link" data-scroll-target="#визначення-функції-для-побудови-рекурентного-графа"><span class="header-section-number">8.6</span> Визначення функції для побудови рекурентного графа</a></li>
  <li><a href="#визначення-функції-для-розрахунку-індексу-кошти" id="toc-визначення-функції-для-розрахунку-індексу-кошти" class="nav-link" data-scroll-target="#визначення-функції-для-розрахунку-індексу-кошти"><span class="header-section-number">8.7</span> Визначення функції для розрахунку індексу Кошти</a></li>
  <li><a href="#оголошення-функцій-для-підрахунку-показників-незворотності" id="toc-оголошення-функцій-для-підрахунку-показників-незворотності" class="nav-link" data-scroll-target="#оголошення-функцій-для-підрахунку-показників-незворотності"><span class="header-section-number">8.8</span> Оголошення функцій для підрахунку показників незворотності</a>
  <ul class="collapse">
  <li><a href="#пермутаційна-незворотність" id="toc-пермутаційна-незворотність" class="nav-link" data-scroll-target="#пермутаційна-незворотність"><span class="header-section-number">8.8.1</span> Пермутаційна незворотність</a></li>
  <li><a href="#графо-динамічна-незворотність" id="toc-графо-динамічна-незворотність" class="nav-link" data-scroll-target="#графо-динамічна-незворотність"><span class="header-section-number">8.8.2</span> Графо-динамічна незворотність</a></li>
  <li><a href="#функція-для-отримання-ступеня-вершини" id="toc-функція-для-отримання-ступеня-вершини" class="nav-link" data-scroll-target="#функція-для-отримання-ступеня-вершини"><span class="header-section-number">8.8.3</span> Функція для отримання ступеня вершини</a></li>
  <li><a href="#функція-для-отримання-локальної-кластеризації" id="toc-функція-для-отримання-локальної-кластеризації" class="nav-link" data-scroll-target="#функція-для-отримання-локальної-кластеризації"><span class="header-section-number">8.8.4</span> Функція для отримання локальної кластеризації</a></li>
  </ul></li>
  <li><a href="#завантажуємо-дані-з-сайту-yahoo-finance" id="toc-завантажуємо-дані-з-сайту-yahoo-finance" class="nav-link" data-scroll-target="#завантажуємо-дані-з-сайту-yahoo-finance"><span class="header-section-number">8.9</span> Завантажуємо дані з сайту Yahoo! Finance</a></li>
  <li><a href="#виводимо-досліджувані-ряди" id="toc-виводимо-досліджувані-ряди" class="nav-link" data-scroll-target="#виводимо-досліджувані-ряди"><span class="header-section-number">8.10</span> Виводимо досліджувані ряди</a></li>
  <li><a href="#встановлення-параметрів-для-розрахунків" id="toc-встановлення-параметрів-для-розрахунків" class="nav-link" data-scroll-target="#встановлення-параметрів-для-розрахунків"><span class="header-section-number">8.11</span> Встановлення параметрів для розрахунків</a></li>
  <li><a href="#виводимо-діаграму-пуанкаре-та-розраховуємо-міри-на-її-основі" id="toc-виводимо-діаграму-пуанкаре-та-розраховуємо-міри-на-її-основі" class="nav-link" data-scroll-target="#виводимо-діаграму-пуанкаре-та-розраховуємо-міри-на-її-основі"><span class="header-section-number">8.12</span> Виводимо діаграму Пуанкаре та розраховуємо міри на її основі</a></li>
  <li><a href="#розрахунки-з-використання-ковзного-вікна" id="toc-розрахунки-з-використання-ковзного-вікна" class="nav-link" data-scroll-target="#розрахунки-з-використання-ковзного-вікна"><span class="header-section-number">8.13</span> Розрахунки з використання ковзного вікна</a>
  <ul class="collapse">
  <li><a href="#масив-для-збереження-результатів" id="toc-масив-для-збереження-результатів" class="nav-link" data-scroll-target="#масив-для-збереження-результатів"><span class="header-section-number">8.13.1</span> Масив для збереження результатів</a></li>
  <li><a href="#розрахунок-відповідних-мір" id="toc-розрахунок-відповідних-мір" class="nav-link" data-scroll-target="#розрахунок-відповідних-мір"><span class="header-section-number">8.13.2</span> Розрахунок відповідних мір</a></li>
  <li><a href="#збереження-значень-до-.txt-файлу" id="toc-збереження-значень-до-.txt-файлу" class="nav-link" data-scroll-target="#збереження-значень-до-.txt-файлу"><span class="header-section-number">8.13.3</span> Збереження значень до .txt файлу</a></li>
  <li><a href="#виведення-індексу-порти" id="toc-виведення-індексу-порти" class="nav-link" data-scroll-target="#виведення-індексу-порти"><span class="header-section-number">8.13.4</span> Виведення індексу Порти</a></li>
  <li><a href="#виведення-індексу-кошти" id="toc-виведення-індексу-кошти" class="nav-link" data-scroll-target="#виведення-індексу-кошти"><span class="header-section-number">8.13.5</span> Виведення індексу Кошти</a></li>
  <li><a href="#виведення-індексу-кута-нахилу" id="toc-виведення-індексу-кута-нахилу" class="nav-link" data-scroll-target="#виведення-індексу-кута-нахилу"><span class="header-section-number">8.13.6</span> Виведення індексу кута нахилу</a></li>
  <li><a href="#виведення-індексу-площі-секторів" id="toc-виведення-індексу-площі-секторів" class="nav-link" data-scroll-target="#виведення-індексу-площі-секторів"><span class="header-section-number">8.13.7</span> Виведення індексу площі секторів</a></li>
  <li><a href="#виведення-індексу-ейлера" id="toc-виведення-індексу-ейлера" class="nav-link" data-scroll-target="#виведення-індексу-ейлера"><span class="header-section-number">8.13.8</span> Виведення індексу Ейлера</a></li>
  <li><a href="#виведення-індексу-кошти-1" id="toc-виведення-індексу-кошти-1" class="nav-link" data-scroll-target="#виведення-індексу-кошти-1"><span class="header-section-number">8.13.9</span> Виведення індексу Кошти</a></li>
  </ul></li>
  <li><a href="#побудова-графу-досліджуваного-ряду" id="toc-побудова-графу-досліджуваного-ряду" class="nav-link" data-scroll-target="#побудова-графу-досліджуваного-ряду"><span class="header-section-number">8.14</span> Побудова графу досліджуваного ряду</a></li>
  <li><a href="#виводимо-звязки-видимості" id="toc-виводимо-звязки-видимості" class="nav-link" data-scroll-target="#виводимо-звязки-видимості"><span class="header-section-number">8.15</span> Виводимо зв’язки видимості</a></li>
  <li><a href="#виводимо-граф" id="toc-виводимо-граф" class="nav-link" data-scroll-target="#виводимо-граф"><span class="header-section-number">8.16</span> Виводимо граф</a></li>
  <li><a href="#побудова-мір-незворотності-на-основі-пермутаційних-шаблонів-та-графів" id="toc-побудова-мір-незворотності-на-основі-пермутаційних-шаблонів-та-графів" class="nav-link" data-scroll-target="#побудова-мір-незворотності-на-основі-пермутаційних-шаблонів-та-графів"><span class="header-section-number">8.17</span> Побудова мір незворотності на основі пермутаційних шаблонів та графів</a></li>
  <li><a href="#віконна-процедура" id="toc-віконна-процедура" class="nav-link" data-scroll-target="#віконна-процедура"><span class="header-section-number">8.18</span> Віконна процедура</a>
  <ul class="collapse">
  <li><a href="#масив-для-збереження-результатів-розрахунків" id="toc-масив-для-збереження-результатів-розрахунків" class="nav-link" data-scroll-target="#масив-для-збереження-результатів-розрахунків"><span class="header-section-number">8.18.1</span> Масив для збереження результатів розрахунків</a></li>
  <li><a href="#розрахунок-відповідних-мір-1" id="toc-розрахунок-відповідних-мір-1" class="nav-link" data-scroll-target="#розрахунок-відповідних-мір-1"><span class="header-section-number">8.18.2</span> Розрахунок відповідних мір</a></li>
  <li><a href="#збереження-результатів-до-.txt-файлів" id="toc-збереження-результатів-до-.txt-файлів" class="nav-link" data-scroll-target="#збереження-результатів-до-.txt-файлів"><span class="header-section-number">8.18.3</span> Збереження результатів до .txt файлів</a></li>
  <li><a href="#виведення-ступеня-незворотності-на-основі-степені-вершини" id="toc-виведення-ступеня-незворотності-на-основі-степені-вершини" class="nav-link" data-scroll-target="#виведення-ступеня-незворотності-на-основі-степені-вершини"><span class="header-section-number">8.18.4</span> Виведення ступеня незворотності на основі степені вершини</a></li>
  <li><a href="#виведення-ступеня-незворотності-на-основі-показника-локальної-кластеризації" id="toc-виведення-ступеня-незворотності-на-основі-показника-локальної-кластеризації" class="nav-link" data-scroll-target="#виведення-ступеня-незворотності-на-основі-показника-локальної-кластеризації"><span class="header-section-number">8.18.5</span> Виведення ступеня незворотності на основі показника локальної кластеризації</a></li>
  <li><a href="#виведення-ступеня-незворотності-на-основі-пермутаційних-шаблонів" id="toc-виведення-ступеня-незворотності-на-основі-пермутаційних-шаблонів" class="nav-link" data-scroll-target="#виведення-ступеня-незворотності-на-основі-пермутаційних-шаблонів"><span class="header-section-number">8.18.6</span> Виведення ступеня незворотності на основі пермутаційних шаблонів</a></li>
  </ul></li>
  <li><a href="#висновок" id="toc-висновок" class="nav-link" data-scroll-target="#висновок"><span class="header-section-number">9</span> Висновок</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/Butman2099/Complex-systems-book/blob/main/lab_11.ipynb" class="toc-action">Редагувати сторінку</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Лабораторна робота № 11</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>Тема.</strong> Аналіз незворотності часового ряду</p>
<p><strong>Мета.</strong> Навчитись розраховувати значення індексів незворотності часу для складних сигналів та досліджувати їх динаміку у випадку незворотних змін, побудови передвісників критичних і кризових явищ</p>
<p>Незворотність часу є фундаментальною властивістю нерівноважних дисипативних систем, і її втрата може свідчити про розвиток деструктивних процесів.</p>
<p>З огляду на статистичні властивості досліджуваного сигналу, його еволюцію можна було б назвати незворотною, якби була відсутня інваріантність, тобто був би отриманий той же сигнал, якби ми виміряли його в протилежному напрямку. Функція <span class="math inline">\(f\)</span> може бути застосована для знаходження характеристик, які відрізняються прямою і зворотною версіями, тобто часові ряди незворотні, якщо <span class="math inline">\(f(X^d) \neq f(X^r)\)</span>. Основна ідея цього визначення полягає в тому, що немає ніяких обмежень на <span class="math inline">\(f(\cdot )\)</span>.</p>
<p>Передбачається, що стаціонарний процес <span class="math inline">\(X\)</span> називається статистично зворотним у часі, якщо розподіл ймовірностей прямої та зворотної систем приблизно однаковий. Незворотність часових рядів вказує на наявність нелінійних залежностей (пам’яті) в динаміці системи, далекій від рівноваги, включаючи негауссові випадкові процеси та дисипативний хаос.</p>
<section id="незворотність-на-основі-діаграм-пуанкаре" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="незворотність-на-основі-діаграм-пуанкаре"><span class="header-section-number">8.1</span> Незворотність на основі діаграм Пуанкаре</h2>
<p>Діаграма Пуанкаре для часового ряду являє собою графік, на осі <span class="math inline">\(x\)</span> якого розташовані значення для поточного часу <span class="math inline">\(t\)</span>, а на осі <span class="math inline">\(y\)</span> — його наступні значення в часі <span class="math inline">\(t+\tau\)</span>. Усі наступні значення, які рівні один одному (<span class="math inline">\(x(t) = x(t+\tau)\)</span>), розташовані на лінії ідентичності (line of identity, LI). Інтервали, що представляють зростаючу тендецію, відмічені вище LI (<span class="math inline">\(x(t)&lt;x(t+\tau)\)</span>), тоді як спадна тенденція характеризуватиметься скупченням точок нижче LI (<span class="math inline">\(x(t)&gt;x(t+\tau)\)</span>). Оцінюючи асиметрію точок на діаграмі, ми можемо вивести різні кількісні показники незворотності (асиметрії) досліджуваних систем.</p>
<p><strong>Індекс Гузіка (GIx)</strong></p>
<p>GIx можна визначити як відношення відстаней точок вище LI до відстаней усіх точок на діаграмі:</p>
<p><span class="math display">\[
GIx = \frac{\sum_{i=1}^{a} \left( D_{i}^{+} \right)^{2}}{\sum_{i=1}^{m} \left( D_{i} \right)^{2} },
\]</span></p>
<p>де <span class="math inline">\(a = C(P_{i}^{+})\)</span> позначає кількість точок над LI; <span class="math inline">\(m = C(P_{i}^{+}) + C(P_{i}^{-})\)</span> позначає кількість точок на графіку Пуанкаре; <span class="math inline">\(D_{i}^{+}\)</span> це відстань від точки над LI до самої LI. Відстань точки до LI можна визначити як</p>
<p><span class="math display">\[
D_{i} = \frac{|x(i+\tau) - x(i)|}{\sqrt{2}}.
\]</span></p>
<p><strong>Індекс Порти</strong></p>
<p>Індекс Порти (PIx) визначається як кількість точок нижче LI, поділена на загальну кількість точок на графіку Пуанкаре, за винятком тих, що знаходяться на LI:</p>
<p><span class="math display">\[
PIx = \frac{b}{m},
\]</span></p>
<p>де <span class="math inline">\(b = C(P_{i}^{-})\)</span> кількість точок нижче LI.</p>
<p><strong>Індекс Кошти</strong></p>
<p>Індекс Кошти бере до уваги кількість інкриментів (<span class="math inline">\(x(i+1)-x(i) &gt; 0\)</span>) та декриментів (<span class="math inline">\(x(i+1)-x(i) &lt; 0\)</span>). Вони представляються симетричними, якщо рівні один одному. Даний індекс розраховується для двовимірної мультимасштабної площини (<span class="math inline">\(x(i), x(i+L)\)</span>), де новий крос-гранульований ряд <span class="math inline">\(y_{\tau}(i) = x(i+L)-x(i)\)</span> для <span class="math inline">\(1 \leq i \leq N-\tau\)</span> відображає асиметрію інкриментів та декриментів ряду, і індекс незворотності для діапазону масштабів <span class="math inline">\(\tau\)</span> визначається наступним виразом:</p>
<p><span class="math display">\[
CIx_{\tau} = \frac{\sum_{y_{\tau}&lt;0} H[y_{\tau}] - \sum_{y_{\tau}&gt;0} H[y_{\tau}]}{N-\tau}.
\]</span></p>
<p>Узагальнений індекс Кошти для діапазону мастабів <span class="math inline">\(\tau\)</span> може бути визначений як</p>
<p><span class="math display">\[
CIx = \frac{1}{L} \sum_{\tau=1}^{L} |CIx_{\tau}|,
\]</span></p>
<p>де <span class="math inline">\(L\)</span> — це максимальний масштаб.</p>
<p><strong>Індекс Ейлера</strong></p>
<p>Опираючись на асиметрію розподілу точок нижче та вище LI, Ейлер запропонував індекс асиметрії:</p>
<p><span class="math display">\[
EIx = \frac{\sum_{i=1}^{N-1} \left[ x(i)-x(i+\tau) \right]^{3}}{\left[ \sum_{i=1}^{N-1} \left[ x(i)-x(i+\tau) \right]^{2} \right]^{\frac{3}{2}}}.
\]</span></p>
<p>Значне відхилення <span class="math inline">\(EIx\)</span> від 0 вказує на асиметрію системи. Якщо <span class="math inline">\(EIx&gt;0\)</span>, розподіл точок на діаграмі Пуанкаре значно зміщений у сторону вище LI. Зворотня ситуація спостерігається для <span class="math inline">\(EIx&lt;0\)</span>. Для <span class="math inline">\(EIx \approx 0\)</span> досліджувані сегменти представляються зворотніми в часі.</p>
<p><strong>Індекс площі</strong></p>
<p>Індекс площі (AIx) визначається як сукупна площа секторів, що сформовані точками над LI поділена на сукупну площу секторів, що відповідають усім точкам на графіку Пуанкаре (крім тих, що розташовані точно на LI). Площа сектора, що відповідає певній точці <span class="math inline">\(P_{i}\)</span> на графіку Пуанкаре, обчислюється як</p>
<p><span class="math display">\[
S_{i} = \frac{1}{2} \times R\theta_{i} \times r^{2},
\]</span></p>
<p>де <span class="math inline">\(r\)</span> — це радіус сектора; $R<em>{i} = </em>{LI} - <em>{i} $; $ </em>{LI}$ — це фазовий кут, і <span class="math inline">\(\theta_{i} = \arctan{\left[ \frac{x(i+\tau)}{x(i)} \right]}\)</span>, що визначає фазовий кут <span class="math inline">\(i\)</span>-ої точки. Далі, <span class="math inline">\(AIx\)</span> визначається за наступною формулою:</p>
<p><span class="math display">\[
AIx = \frac{\sum_{i=1}^{a}|S_{i}|}{\sum_{i=1}^{m}|S_{i}|}.
\]</span></p>
<p><strong>Індекс кута нахилу</strong></p>
<p>На додачу до представлених вище мір, було запропоновано розраховувати незворотність сигналу з відношення кутів нахилу точок над LI до нахилу всіх точок на діаграмі:</p>
<p><span class="math display">\[
SIx = \frac{\sum_{i=1}^{a}|R\theta_{i}|}{\sum_{i=1}^{m}|R\theta_{i}|}.
\]</span></p>
</section>
<section id="методи-складних-мереж" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="методи-складних-мереж"><span class="header-section-number">8.2</span> Методи складних мереж</h2>
<p>Графи видимості (VG) базуються на простому відображенні часових рядів у мережеву область, використовуючи локальну опуклість скалярно-позначених часових рядів, де кожне спостереження є вершиною в складній мережі. Дві вершини і пов’язані ребром, якщо для всіх вершин застосовується наступна умова:</p>
<p><span class="math display">\[
x_{k} &lt; x_{j} + \left( x_{i} - x_{j} \right) \frac{t_{j}-t_{k}}{t_{j}-t_{i}}.
\]</span></p>
<p>Матрицю суміжності (<span class="math inline">\(A_{ij}\)</span>) представленого ненаправленого та незваженого VG можна представити як:</p>
<p><span class="math display">\[
A_{ij}^{VG} = A_{ji}^{VG} = \prod_{k=i+1}^{j-1} H \left( x_{k} &lt; x_{j} + \left( x_{i} - x_{j} \right) \frac{t_{j}-t_{k}}{t_{j}-t_{i}} \right),
\]</span></p>
<p>де <span class="math inline">\(H( \cdot )\)</span> — це функція Гевісайда.</p>
<p>Граф горизонтальної видимості (HVG) є спрощеною версією цього алгоритму. Для досліджуваного часового ряду набори вершин VG і HVG однакові, тоді як набір ребер HVG відображає взаємну горизонтальну видимість двох спостережень $x_{i} $ та $ x_{j}$. Тобто можна побудувати ребро <span class="math inline">\((i,j)\)</span>, якщо <span class="math inline">\(x_{k} &lt; \min(x_{i}, x_{j})\)</span> для всіх <span class="math inline">\(k\)</span> при <span class="math inline">\(t_{i} &lt; t_{k} &lt; t_{j}\)</span> так що</p>
<p><span class="math display">\[
A_{ij}^{VG} = A_{ji}^{VG} = \prod_{k=i+1}^{j-1} H \left( x_{i} - x_{k} \right) H \left( x_{j} - x_{k} \right).
\]</span></p>
<p>VG і HVG фіксують по суті одні й ті ж властивості досліджуваної системи, оскільки HVG є підграфом VG з тим же набором вершин, але володіє тільки підмножиною ребер VG. Зверніть увагу, що VG інваріантний щодо суперпозиції лінійних трендів, тоді як HVG — ні.</p>
<p>Оскільки визначення VGs та HVGs чітко враховує часовий порядок спостережень, напрямок часу нерозривно пов’язаний з отриманою структурою мережі. Щоб врахувати цей факт, ми визначаємо набір нових статистичних мережевих показників на основі двох простих характеристик вершин:</p>
<ul>
<li>Оскільки кількість ребер інцидентних вершині <span class="math inline">\(i\)</span> можна визначити як <span class="math inline">\(k_{i}^{r} = \sum_{j} A_{ij}\)</span>, для (H)VG ми можемо переписати дану кількісну характеристику для вершини в час <span class="math inline">\(t_{i}\)</span> відносно її минулих та майбутніх вершин:</li>
</ul>
<p><span class="math display">\[
k_{i}^{r} = \sum_{j&lt;i} A_{ij} \quad \mathrm{and} \quad k_{i}^{a} \sum_{j&gt;i} A_{ij},
\]</span></p>
<p>де $k_{i} = k_{i}^{r} + k_{i}^{a} $, і $ k_{i}^{r} $ та $ k_{i}^{a}$ сприймаються як вхідні (минулі) та вихідні (майбутні) вершини.</p>
<ul>
<li>Локальний коефіцієнт кластеризації <span class="math inline">\(C_{i} = \left( \begin{matrix} k_{i}\\ 2 \end{matrix} \right)^{-1} \sum_{j,k} A_{ij}A_{jk}A_{ki}\)</span> інша властивість старшного порядку структурного сусідства вершини <span class="math inline">\(i\)</span>. Для дослідження незворотності, ми можемо переписати дані характеристики наступним чином:</li>
</ul>
<p><span class="math display">\[
C_{i}^{r} = \left( \begin{matrix} k_{i}^{r}\\ 2 \end{matrix} \right)^{-1} \sum_{j&lt;i,k&lt;i} A_{ij}A_{jk}A_{ki} \quad \textrm{and} \quad C_{i}^{a} = \left( \begin{matrix} k_{i}^{a}\\ 2 \end{matrix} \right)^{-1} \sum_{j&gt;i,k&gt;i} A_{ij}A_{jk}A_{ki}.
\]</span></p>
<p>Якщо уявити нашу систему зворотною в часі, ми припускаємо, що розподілу ймовірностей прямих і зворотних за часом характеристик повинні бути однаковими. Для незворотних процесів ми очікуємо виявити статистичну нееквівалентність. Ця нееквівалентність буде визначатися через дивергенцію Кульбака-Лейблера:</p>
<p><span class="math display">\[
D_{KL}(p||q) = \sum_{i=1}^{N} p(x_{i}) \cdot \log{\left[ \frac{p(x_{i})}{q(x_{i})} \right]},
\]</span></p>
<p>де <span class="math inline">\(p(\cdot)\)</span> відповідатиме розподілу вхідних характеристикам, а <span class="math inline">\(q(\cdot)\)</span> відповідатиме зворотнім.</p>
</section>
<section id="незворотність-на-основі-пермутаційних-шаблонів" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="незворотність-на-основі-пермутаційних-шаблонів"><span class="header-section-number">8.3</span> Незворотність на основі пермутаційних шаблонів</h2>
<p>Ідея аналізу пермутаційних шаблонів (PP — permutation patterns) спочатку була запропонована Бандтом і Помпе, щоб надати дослідникам простий та ефективний інструмент для характеристики складності динаміки реальних систем. Він уникає порогу амплітуди і замість цього має справу з порядковими шаблонами перестановок. Їх частоти дозволяють відрізнити детерміновані процеси від абсолютно випадкових. Розрахунки PP припускають, що часовий ряд розбивається на пересічні підвектори довжини <span class="math inline">\(d_{E}\)</span>:</p>
<p><span class="math display">\[
\vec{X}(i) = \left\{ x(i), x(i+\tau), ... , x(i+[d_{E}-1]\tau) \right\},
\]</span></p>
<p>де часова затримка <span class="math inline">\(\tau\)</span> відповідає часу розділення між елементами.</p>
<p>Після цього кожен вектор представляється у вигляді порядкового шаблону <span class="math inline">\(\pi = \{ r_0, r_1, ... , r_{d_{E}-1} \}\)</span>, що має задовільняти наступній умові:</p>
<p><span class="math display">\[
x(i+r_0) \leq x(i+r_1) \leq ... \leq x(i+r_{d_{E}-1}).
\]</span></p>
<p>Цікава для нас міра незворотності часу на основі PP може бути отримана шляхом врахування їх відносної частоти як для початкового, так і для оберненого часового ряду. Відповідно, якщо обидва типи мають приблизно однакові розподіли ймовірностей своїх патернів, часові ряди представляються зворотними, а для іншого випадку робиться протилежний висновок.</p>
<p>Різницю між розподілами прямих часових рядів (<span class="math inline">\(P^{d}\)</span>) та зворотних (<span class="math inline">\(P^{r}\)</span>) можна оцінити за допомогою дивергенції Кульбака-Лейблера.</p>
</section>
<section id="підключення-необхідних-бібліотек" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="підключення-необхідних-бібліотек"><span class="header-section-number">8.4</span> Підключення необхідних бібліотек</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.dates <span class="im">as</span> mdates</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ts2vg <span class="im">import</span> NaturalVG, HorizontalVG</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> entropy</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> jit</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ordpy <span class="im">import</span> ordinal_distribution</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> quad</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> gaussian_kde</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial <span class="im">import</span> distance</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> KDEpy <span class="im">import</span> FFTKDE</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> neuralkit2 <span class="im">as</span> nk</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="встановлення-параметрів-для-побудови-графіків" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="встановлення-параметрів-для-побудови-графіків"><span class="header-section-number">8.5</span> Встановлення параметрів для побудови графіків</h2>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'classic'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'legend.fontsize'</span>: <span class="dv">26</span>})</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'lines.linewidth'</span>] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.facecolor'</span>] <span class="op">=</span> <span class="st">'white'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">"figure.facecolor"</span>] <span class="op">=</span> <span class="st">'white'</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="st">'26'</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">'Times New Roman'</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'savefig.dpi'</span>] <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> <span class="st">'time, days'</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="визначення-функції-для-побудови-рекурентного-графа" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="визначення-функції-для-побудови-рекурентного-графа"><span class="header-section-number">8.6</span> Визначення функції для побудови рекурентного графа</h2>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recurrence_net(time_ser, rec_thr, dim, tau, dist_type<span class="op">=</span><span class="st">'euclidien'</span>):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    time_series <span class="op">=</span> nk.complexity_embedding(time_ser, dimension<span class="op">=</span>dim, delay<span class="op">=</span>tau)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    rp <span class="op">=</span> (distance.cdist(time_series, time_series, dist_type) <span class="op">&lt;=</span> rec_thr).astype(<span class="bu">int</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    adj_matrix_RN <span class="op">=</span> rp</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(adj_matrix_RN, <span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    rec_nw <span class="op">=</span> nx.from_numpy_matrix(adj_matrix_RN)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rec_nw</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> node_positions_recurrence_net(ts, xs):</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {i: (xs[i], ts[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(ts))}</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="визначення-функції-для-розрахунку-індексу-кошти" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="визначення-функції-для-розрахунку-індексу-кошти"><span class="header-section-number">8.7</span> Визначення функції для розрахунку індексу Кошти</h2>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Costa_1(time_ser, taus):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    Cst <span class="op">=</span> []</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> tau <span class="kw">in</span> taus:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        fragm_Costa <span class="op">=</span> np.array([time_ser[tau:], time_ser[:<span class="op">-</span>tau]])</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        DiffCosta <span class="op">=</span> np.diff(fragm_Costa,axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        IncCosta <span class="op">=</span> np.<span class="bu">sum</span>(DiffCosta<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        DecCosta <span class="op">=</span> np.<span class="bu">sum</span>(DiffCosta<span class="op">&lt;</span><span class="dv">0</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        C <span class="op">=</span> (IncCosta<span class="op">-</span>DecCosta)<span class="op">/</span>(<span class="bu">len</span>(time_ser)<span class="op">-</span>tau)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        Cst.append(C)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    Costa <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(Cst))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Costa</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="оголошення-функцій-для-підрахунку-показників-незворотності" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="оголошення-функцій-для-підрахунку-показників-незворотності"><span class="header-section-number">8.8</span> Оголошення функцій для підрахунку показників незворотності</h2>
<section id="пермутаційна-незворотність" class="level3" data-number="8.8.1">
<h3 data-number="8.8.1" class="anchored" data-anchor-id="пермутаційна-незворотність"><span class="header-section-number">8.8.1</span> Пермутаційна незворотність</h3>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> PermIrrever(time_ser, d_e, tau, delta<span class="op">=</span><span class="fl">1e-10</span>, distance_irr<span class="op">=</span><span class="st">"kullback"</span>):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    pattern, dist <span class="op">=</span> ordinal_distribution(time_ser, dx<span class="op">=</span>d_e, taux<span class="op">=</span>tau, return_missing<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    m, n <span class="op">=</span> pattern.shape</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    pf <span class="op">=</span> []</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    pb <span class="op">=</span> []</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    is_used <span class="op">=</span> np.zeros((m))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(m):</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_used[i] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        is_used[i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        pf.append(i)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        permb <span class="op">=</span> pattern[i,::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(m<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> np.<span class="bu">sum</span>(pattern[j,:] <span class="op">==</span> permb) <span class="op">==</span> n: </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                is_used[j] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                pb.append(j)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> distance_irr <span class="op">==</span> <span class="st">"kullback"</span>:</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        KLD_perm <span class="op">=</span> dist[pf] <span class="op">*</span> np.log((dist[pf] <span class="op">+</span> delta) <span class="op">/</span> (dist[pb] <span class="op">+</span> delta))</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.<span class="bu">sum</span>(KLD_perm)   </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> distance.jensenshannon(dist[pf] <span class="op">+</span> delta, dist[pb] <span class="op">+</span> delta)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="графо-динамічна-незворотність" class="level3" data-number="8.8.2">
<h3 data-number="8.8.2" class="anchored" data-anchor-id="графо-динамічна-незворотність"><span class="header-section-number">8.8.2</span> Графо-динамічна незворотність</h3>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> GraphIrrever(fragm_1, graph_type<span class="op">=</span><span class="st">'classic'</span>, delta<span class="op">=</span><span class="fl">1e-10</span>, d_e_rec<span class="op">=</span><span class="dv">3</span>, tau_rec<span class="op">=</span><span class="dv">1</span>, eps_rec<span class="op">=</span><span class="fl">0.1</span>, dist_rec<span class="op">=</span><span class="st">'chebyshev'</span>, distance_irr<span class="op">=</span><span class="st">'kullback'</span>):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># будуємо граф </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> graph_type <span class="op">==</span> <span class="st">'classic'</span>:</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        g <span class="op">=</span> NaturalVG(directed<span class="op">=</span><span class="va">None</span>).build(fragm_1)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> graph_type <span class="op">==</span> <span class="st">'horizontal'</span>:</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        g <span class="op">=</span> HorizontalVG(directed<span class="op">=</span><span class="va">None</span>).build(fragm_1)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        g <span class="op">=</span> recurrence_net(fragm_1, rec_thr<span class="op">=</span>eps_rec<span class="op">*</span>np.<span class="bu">abs</span>(np.std(fragm_1)), dim<span class="op">=</span>d_e_rec, tau<span class="op">=</span>tau_rec, dist_type<span class="op">=</span>dist_rec)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо вхідні та вихідні характеристики </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    adjacency_mat <span class="op">=</span> g.adjacency_matrix()</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    ret_deg, adv_deg <span class="op">=</span> GetDegree(adjacency_mat)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    ret_clust, adv_clust <span class="op">=</span> GetLocalClusteringCoefficient(adjacency_mat, ret_deg, adv_deg)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># використовуємо kde для знаходження функції щільності ймовірностей </span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    pdf_ret_deg <span class="op">=</span> gaussian_kde(<span class="bu">sorted</span>(ret_deg), bw_method<span class="op">=</span><span class="st">'scott'</span>)       </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    pdf_adv_deg <span class="op">=</span> gaussian_kde(<span class="bu">sorted</span>(adv_deg), bw_method<span class="op">=</span><span class="st">'scott'</span>)    </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    pdf_ret_clust <span class="op">=</span> gaussian_kde(<span class="bu">sorted</span>(ret_clust), bw_method<span class="op">=</span><span class="st">'scott'</span>)    </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    pdf_adv_clust <span class="op">=</span> gaussian_kde(<span class="bu">sorted</span>(adv_clust), bw_method<span class="op">=</span><span class="st">'scott'</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    a_deg <span class="op">=</span> <span class="bu">min</span>(<span class="bu">min</span>(ret_deg), <span class="bu">min</span>(adv_deg))  </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    b_deg <span class="op">=</span> <span class="bu">max</span>(<span class="bu">max</span>(ret_deg), <span class="bu">max</span>(adv_deg))  </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    a_clust <span class="op">=</span> <span class="bu">min</span>(<span class="bu">min</span>(ret_clust), <span class="bu">min</span>(adv_clust))</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    b_clust <span class="op">=</span> <span class="bu">max</span>(<span class="bu">max</span>(ret_clust), <span class="bu">max</span>(adv_clust))</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> distance_irr <span class="op">==</span> <span class="st">'kullback'</span>:</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        dkl_deg <span class="op">=</span> <span class="kw">lambda</span> x: pdf_ret_deg.pdf(x) <span class="op">*</span> np.log((pdf_ret_deg.pdf(x) <span class="op">+</span> delta)<span class="op">/</span>(pdf_adv_deg.pdf(x) <span class="op">+</span> delta))        </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        dkl_clust <span class="op">=</span> <span class="kw">lambda</span> x: pdf_ret_clust.pdf(x) <span class="op">*</span> np.log((pdf_ret_clust.pdf(x) <span class="op">+</span> delta)<span class="op">/</span>(pdf_adv_clust.pdf(x) <span class="op">+</span> delta))</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>        distance_deg <span class="op">=</span> quad(dkl_deg, a_deg, b_deg)[<span class="dv">0</span>]       </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        distance_clust <span class="op">=</span> quad(dkl_clust, a_clust, b_clust)[<span class="dv">0</span>]</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> distance_irr <span class="op">==</span> <span class="st">'shannon'</span>:                                 </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        width_deg <span class="op">=</span> (b_deg<span class="op">-</span>a_deg)<span class="op">/</span><span class="bu">len</span>(ret_deg)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>        width_clust <span class="op">=</span> (b_clust<span class="op">-</span>a_clust)<span class="op">/</span><span class="bu">len</span>(ret_clust)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        lin_deg <span class="op">=</span> np.arange(a_deg, b_deg, width_deg) </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>        lin_clust <span class="op">=</span> np.arange(a_clust, b_clust, width_clust)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>        p_ret_deg <span class="op">=</span> pdf_ret_deg.pdf(lin_deg) </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>        p_adv_deg <span class="op">=</span> pdf_adv_deg.pdf(lin_deg) </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>        p_ret_clust <span class="op">=</span> pdf_ret_clust.pdf(lin_clust) </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>        p_adv_clust <span class="op">=</span> pdf_adv_clust.pdf(lin_clust)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>        distance_deg <span class="op">=</span> distance.jensenshannon(p_ret_deg <span class="op">+</span> delta, p_adv_deg <span class="op">+</span> delta)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>        distance_clust <span class="op">=</span> distance.jensenshannon(p_ret_clust <span class="op">+</span> delta, p_adv_clust <span class="op">+</span> delta)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_deg, distance_clust</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="функція-для-отримання-ступеня-вершини" class="level3" data-number="8.8.3">
<h3 data-number="8.8.3" class="anchored" data-anchor-id="функція-для-отримання-ступеня-вершини"><span class="header-section-number">8.8.3</span> Функція для отримання ступеня вершини</h3>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="at">@jit</span>(nopython<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> GetDegree(AM):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    numNodes <span class="op">=</span> AM.shape[<span class="dv">0</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    retarded_degree <span class="op">=</span> np.zeros((numNodes))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    advanced_degree <span class="op">=</span> np.zeros((numNodes))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(numNodes):</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        retarded_degree[i] <span class="op">=</span> AM[i, :i].<span class="bu">sum</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(numNodes):</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        advanced_degree[i] <span class="op">=</span> AM[i, i:].<span class="bu">sum</span>()</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> retarded_degree, advanced_degree</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="функція-для-отримання-локальної-кластеризації" class="level3" data-number="8.8.4">
<h3 data-number="8.8.4" class="anchored" data-anchor-id="функція-для-отримання-локальної-кластеризації"><span class="header-section-number">8.8.4</span> Функція для отримання локальної кластеризації</h3>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="at">@jit</span>(nopython<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>) </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> GetLocalClusteringCoefficient(AM, ret_deg, adv_deg):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    numNodes <span class="op">=</span> AM.shape[<span class="dv">0</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    retardedCC <span class="op">=</span> np.zeros( (numNodes) )</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    advancedCC <span class="op">=</span> np.zeros( (numNodes) )</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    ret_norm <span class="op">=</span> ret_deg <span class="op">*</span> (ret_deg <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    adv_norm <span class="op">=</span> adv_deg <span class="op">*</span> (adv_deg <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(numNodes):</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ret_norm[i] <span class="op">!=</span> <span class="dv">0</span>: </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i):</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(j): </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> AM[i, j] <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> AM[j, k] <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> AM[k, i] <span class="op">==</span> <span class="dv">1</span>: </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                        counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>            retardedCC[i] <span class="op">=</span> counter <span class="op">/</span> ret_norm[i]</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(numNodes<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> adv_norm[i] <span class="op">!=</span> <span class="dv">0</span>: </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>            counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, numNodes):</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, j): </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> AM[i, j] <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> AM[j, k] <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> AM[k, i] <span class="op">==</span> <span class="dv">1</span>: </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                        counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>            advancedCC[i] <span class="op">=</span> counter <span class="op">/</span> adv_norm[i]</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> retardedCC, advancedCC</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="завантажуємо-дані-з-сайту-yahoo-finance" class="level2" data-number="8.9">
<h2 data-number="8.9" class="anchored" data-anchor-id="завантажуємо-дані-з-сайту-yahoo-finance"><span class="header-section-number">8.9</span> Завантажуємо дані з сайту Yahoo! Finance</h2>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>name_1 <span class="op">=</span> <span class="st">"^N225"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>name_2 <span class="op">=</span> <span class="st">"^N225"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> <span class="st">"1980-01-01"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> <span class="st">"2022-12-13"</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> yf.download(name_1, start, end)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>time_ser_1 <span class="op">=</span> data[<span class="st">'Adj Close'</span>].copy()</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>for_graph <span class="op">=</span> data[<span class="st">'Adj Close'</span>].copy()</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>date_in_num <span class="op">=</span> mdates.date2num(time_ser_1.index)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f'</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_initial_time_series.txt'</span>, time_ser_1.values)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[*********************100%***********************]  1 of 1 completed</code></pre>
</div>
</div>
</section>
<section id="виводимо-досліджувані-ряди" class="level2" data-number="8.10">
<h2 data-number="8.10" class="anchored" data-anchor-id="виводимо-досліджувані-ряди"><span class="header-section-number">8.10</span> Виводимо досліджувані ряди</h2>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>time_ser_1.plot(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>), xlabel<span class="op">=</span>xlabel, ylabel<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_1<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'ts1.jpg'</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>for_graph.plot(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>), xlabel<span class="op">=</span>xlabel, ylabel<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'ts2.jpg'</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="встановлення-параметрів-для-розрахунків" class="level2" data-number="8.11">
<h2 data-number="8.11" class="anchored" data-anchor-id="встановлення-параметрів-для-розрахунків"><span class="header-section-number">8.11</span> Встановлення параметрів для розрахунків</h2>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">500</span> <span class="co"># розмір ковзного вікна</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span> <span class="co"># часовий крок</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">1</span> <span class="co"># тип ряду: 1 - вихідний, 2 - детрендований</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 3 - стандартні прибутковості, </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 6 - стандартизований вихідний часовий ряд</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># параметри для рекурентного графу</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>d_e_rec <span class="op">=</span> <span class="dv">3</span> <span class="co"># розмірність вкладень</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>tau_rec <span class="op">=</span> <span class="dv">1</span> <span class="co"># часова затримка</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>eps_rec <span class="op">=</span> <span class="fl">1.3</span> <span class="co"># радіус</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>dist_rec <span class="op">=</span> <span class="st">'chebyshev'</span> <span class="co"># відстань між траєкторіями: canberra’, ‘chebyshev’, ‘cityblock’, ‘correlation’, </span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                                                        <span class="co"># ‘cosine’, ‘dice’, ‘euclidean’, ‘hamming’, ‘jaccard’, </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                                                        <span class="co"># ‘jensenshannon’, ‘kulsinski’, ‘kulczynski1’, ‘mahalanobis’, </span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>                                                        <span class="co"># ‘matching’, ‘minkowski’, ‘rogerstanimoto’, ‘russellrao’, ‘seuclidean’, </span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                                                        <span class="co"># ‘sokalmichener’, ‘sokalsneath’, ‘sqeuclidean’, ‘yule’.</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># параметри для мір незворотності</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>d_e_perm <span class="op">=</span> <span class="dv">3</span> <span class="co"># розмірність вкладень для пермутаційних патернів </span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>tau_perm  <span class="op">=</span> <span class="dv">1</span> <span class="co"># часова затримка для пермутаційних патернів</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>distance_irr <span class="op">=</span> <span class="st">'kullback'</span> <span class="co"># відстань між розподілами: kullback, shannon</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>graph_type <span class="op">=</span> <span class="st">'classic'</span> <span class="co"># тип графу: classic, horizontal, recurrent</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># параметри для мір асиметрії</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>tau_assym <span class="op">=</span> <span class="dv">1</span> <span class="co"># часова затримка для діаграми Пуанкаре</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>tau_Costa_begin <span class="op">=</span> <span class="dv">1</span> <span class="co"># початковий часовий масштаб для індексу Кошти</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>tau_Costa_end <span class="op">=</span> <span class="dv">20</span> <span class="co"># кінцевий часовий масштаб для індексу Кошти</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>taus_Costa <span class="op">=</span> np.arange(tau_Costa_begin, tau_Costa_end<span class="op">+</span><span class="dv">1</span>) <span class="co"># формуємо масив масштабів</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser_1)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="виводимо-діаграму-пуанкаре-та-розраховуємо-міри-на-її-основі" class="level2" data-number="8.12">
<h2 data-number="8.12" class="anchored" data-anchor-id="виводимо-діаграму-пуанкаре-та-розраховуємо-міри-на-її-основі"><span class="header-section-number">8.12</span> Виводимо діаграму Пуанкаре та розраховуємо міри на її основі</h2>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>for_puank <span class="op">=</span> time_ser_1.copy()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ret_type <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">=</span> for_puank.diff()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">=</span> for_puank.pct_change()</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">=</span> for_puank.pct_change()</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">-=</span> for_puank.mean()</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">/=</span> for_puank.std()</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">5</span>: </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">=</span> for_puank.pct_change()</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">-=</span> for_puank.mean()</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">/=</span> for_puank.std()</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">=</span> for_puank.<span class="bu">abs</span>()</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">-=</span> for_puank.mean()</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    for_puank <span class="op">/=</span> for_puank.std()</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>for_puank <span class="op">=</span> for_puank.dropna().values</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">10</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ax1.scatter(for_puank[:<span class="op">-</span>tau_assym],for_puank[tau_assym:], marker<span class="op">=</span><span class="st">"X"</span>, s<span class="op">=</span><span class="dv">180</span>, c<span class="op">=</span><span class="st">"g"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>low_x, high_x <span class="op">=</span> ax1.get_xlim()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>low_y, high_y <span class="op">=</span> ax1.get_ylim()</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>ax1.axline([low_x, low_y], [high_x, high_y])</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>ax1.set_aspect(<span class="st">'equal'</span>, <span class="st">'box'</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="vs">r'$g(t)$'</span>, fontsize<span class="op">=</span><span class="dv">26</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="vs">r'$g(t+\tau)$'</span>, fontsize<span class="op">=</span><span class="dv">26</span>) </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>ax1.set_xlim(left<span class="op">=</span>low_x, right<span class="op">=</span>high_x)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(bottom<span class="op">=</span>low_y, top<span class="op">=</span>high_y)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>plt.locator_params(axis<span class="op">=</span><span class="st">'y'</span>, nbins<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"Poincare_plot_</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Виходячи з даної діаграми для прибутковостей N225 видно, що значення даного індексу розподілені відносно рівномірно. Тут $ = 1 $, тому можемо сказати, що у короткостроковій перспективі значення прибутковостей мають рівну ймовірність як для спадання, так і для зростання.</p>
</section>
<section id="розрахунки-з-використання-ковзного-вікна" class="level2" data-number="8.13">
<h2 data-number="8.13" class="anchored" data-anchor-id="розрахунки-з-використання-ковзного-вікна"><span class="header-section-number">8.13</span> Розрахунки з використання ковзного вікна</h2>
<section id="масив-для-збереження-результатів" class="level3" data-number="8.13.1">
<h3 data-number="8.13.1" class="anchored" data-anchor-id="масив-для-збереження-результатів"><span class="header-section-number">8.13.1</span> Масив для збереження результатів</h3>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>PIx <span class="op">=</span> []</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>GIx <span class="op">=</span> []</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>SIx <span class="op">=</span> []</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>AIx <span class="op">=</span> []</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>EIx <span class="op">=</span> []</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>CIx <span class="op">=</span> []</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="розрахунок-відповідних-мір" class="level3" data-number="8.13.2">
<h3 data-number="8.13.2" class="anchored" data-anchor-id="розрахунок-відповідних-мір"><span class="header-section-number">8.13.2</span> Розрахунок відповідних мір</h3>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    fragm_1 <span class="op">=</span> time_ser_1.iloc[i:i<span class="op">+</span>window].copy() <span class="co">#відбираємо фрагмент та в подальшому відбираємо потрібний тип ряду</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ret_type <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.diff()</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.pct_change()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.pct_change()</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">-=</span> fragm_1.mean()</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">/=</span> fragm_1.std()</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">5</span>: </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.pct_change()</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">-=</span> fragm_1.mean()</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">/=</span> fragm_1.std()</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.<span class="bu">abs</span>()</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">-=</span> fragm_1.mean()</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">/=</span> fragm_1.std()</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    fragm_1 <span class="op">=</span> fragm_1.dropna().values </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    Temp_fragm <span class="op">=</span> np.array([fragm_1[:<span class="op">-</span>tau_assym], fragm_1[tau_assym:]])</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    T2   <span class="op">=</span> np.transpose(np.arctan(Temp_fragm[<span class="dv">1</span>,:]<span class="op">/</span>Temp_fragm[<span class="dv">0</span>,:])<span class="op">*</span><span class="dv">180</span><span class="op">/</span>np.pi)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    Dup  <span class="op">=</span> <span class="bu">abs</span>(np.diff(Temp_fragm[:,T2<span class="op">&gt;</span><span class="dv">45</span>],axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    Dtot <span class="op">=</span> <span class="bu">abs</span>(np.diff(Temp_fragm[:,T2<span class="op">!=</span><span class="dv">45</span>],axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    Sup  <span class="op">=</span> np.<span class="bu">sum</span>(<span class="bu">abs</span>(T2[T2<span class="op">&gt;</span><span class="dv">45</span>]<span class="op">-</span><span class="dv">45</span>))</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    Stot <span class="op">=</span> np.<span class="bu">sum</span>(<span class="bu">abs</span>(T2[T2<span class="op">!=</span><span class="dv">45</span>]<span class="op">-</span><span class="dv">45</span>))</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    Aup  <span class="op">=</span> np.<span class="bu">sum</span>(<span class="bu">abs</span>(np.transpose(((T2[T2<span class="op">&gt;</span><span class="dv">45</span>]<span class="op">-</span><span class="dv">45</span>))<span class="op">*</span>np.sqrt(np.<span class="bu">sum</span>(Temp_fragm[:,T2<span class="op">&gt;</span><span class="dv">45</span>]<span class="op">**</span><span class="dv">2</span>,axis<span class="op">=</span><span class="dv">0</span>)))))</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    Atot <span class="op">=</span> np.<span class="bu">sum</span>(<span class="bu">abs</span>(np.transpose(((T2[T2<span class="op">!=</span><span class="dv">45</span>]<span class="op">-</span><span class="dv">45</span>))<span class="op">*</span>np.sqrt(np.<span class="bu">sum</span>(Temp_fragm[:,T2<span class="op">!=</span><span class="dv">45</span>]<span class="op">**</span><span class="dv">2</span>,axis<span class="op">=</span><span class="dv">0</span>)))))</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    Ethird <span class="op">=</span> np.<span class="bu">sum</span>(np.transpose(Temp_fragm[<span class="dv">0</span>,:]<span class="op">-</span>Temp_fragm[<span class="dv">1</span>,:])<span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    Etot <span class="op">=</span> (np.<span class="bu">sum</span>(np.transpose(Temp_fragm[<span class="dv">0</span>,:]<span class="op">-</span>Temp_fragm[<span class="dv">1</span>,:])<span class="op">**</span><span class="dv">2</span>))<span class="op">**</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    Porta <span class="op">=</span> <span class="bu">sum</span>(T2<span class="op">&lt;</span><span class="dv">45</span>)<span class="op">/</span><span class="bu">sum</span>(T2<span class="op">!=</span><span class="dv">45</span>)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    Gudzik <span class="op">=</span> np.<span class="bu">sum</span>(Dup<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>np.<span class="bu">sum</span>(Dtot<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    Slope <span class="op">=</span> Sup<span class="op">/</span>Stot</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    Area <span class="op">=</span> Aup<span class="op">/</span>Atot</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    Eiler <span class="op">=</span> Ethird<span class="op">/</span>Etot</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    Costa <span class="op">=</span> Costa_1(fragm_1, taus_Costa)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    PIx.append(Porta)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    GIx.append(Gudzik)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    SIx.append(Slope)</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>    AIx.append(Area)</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    EIx.append(Eiler)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    CIx.append(Costa)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="збереження-значень-до-.txt-файлу" class="level3" data-number="8.13.3">
<h3 data-number="8.13.3" class="anchored" data-anchor-id="збереження-значень-до-.txt-файлу"><span class="header-section-number">8.13.3</span> Збереження значень до .txt файлу</h3>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"Porta_idx_</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">.txt"</span>, PIx)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"Gudzik_idx_</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">.txt"</span>, GIx)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"Slope_idx_</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">.txt"</span>, SIx)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"Area_idx_</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">.txt"</span>, AIx)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"Eiler_idx_</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">.txt"</span>, EIx)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"Costa_idx_</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">.txt"</span>, CIx)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="виведення-індексу-порти" class="level3" data-number="8.13.4">
<h3 data-number="8.13.4" class="anchored" data-anchor-id="виведення-індексу-порти"><span class="header-section-number">8.13.4</span> Виведення індексу Порти</h3>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser_1.index[window:length:tstep], for_graph[window:length:tstep], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ax2.plot(time_ser_1.index[window:length:tstep], PIx, label<span class="op">=</span><span class="vs">r"$ PIx $"</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>), bbox_transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">$,$"</span> <span class="op">+</span> <span class="st">"$PIx$"</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"PIx_</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="виведення-індексу-кошти" class="level3" data-number="8.13.5">
<h3 data-number="8.13.5" class="anchored" data-anchor-id="виведення-індексу-кошти"><span class="header-section-number">8.13.5</span> Виведення індексу Кошти</h3>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser_1.index[window:length:tstep], for_graph[window:length:tstep], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ax2.plot(time_ser_1.index[window:length:tstep], GIx, label<span class="op">=</span><span class="vs">r"$ GIx $"</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>), bbox_transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">$,$"</span> <span class="op">+</span> <span class="st">"$GIx$"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"GIx_</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="виведення-індексу-кута-нахилу" class="level3" data-number="8.13.6">
<h3 data-number="8.13.6" class="anchored" data-anchor-id="виведення-індексу-кута-нахилу"><span class="header-section-number">8.13.6</span> Виведення індексу кута нахилу</h3>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser_1.index[window:length:tstep], for_graph[window:length:tstep], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>ax2.plot(time_ser_1.index[window:length:tstep], SIx, label<span class="op">=</span><span class="vs">r"$ SIx $"</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>), bbox_transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">$,$"</span> <span class="op">+</span> <span class="st">"$SIx$"</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"SIx_</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="виведення-індексу-площі-секторів" class="level3" data-number="8.13.7">
<h3 data-number="8.13.7" class="anchored" data-anchor-id="виведення-індексу-площі-секторів"><span class="header-section-number">8.13.7</span> Виведення індексу площі секторів</h3>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser_1.index[window:length:tstep], for_graph[window:length:tstep], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ax2.plot(time_ser_1.index[window:length:tstep], AIx, label<span class="op">=</span><span class="vs">r"$ AIx $"</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>), bbox_transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">$,$"</span> <span class="op">+</span> <span class="st">"$AIx$"</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"AIx_</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="виведення-індексу-ейлера" class="level3" data-number="8.13.8">
<h3 data-number="8.13.8" class="anchored" data-anchor-id="виведення-індексу-ейлера"><span class="header-section-number">8.13.8</span> Виведення індексу Ейлера</h3>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser_1.index[window:length:tstep], for_graph[window:length:tstep], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>ax2.plot(time_ser_1.index[window:length:tstep], EIx, label<span class="op">=</span><span class="vs">r"$ EIx $"</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>), bbox_transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">$,$"</span> <span class="op">+</span> <span class="st">"$EIx$"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"EIx_</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="виведення-індексу-кошти-1" class="level3" data-number="8.13.9">
<h3 data-number="8.13.9" class="anchored" data-anchor-id="виведення-індексу-кошти-1"><span class="header-section-number">8.13.9</span> Виведення індексу Кошти</h3>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser_1.index[window:length:tstep], for_graph[window:length:tstep], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ax2.plot(time_ser_1.index[window:length:tstep], CIx, label<span class="op">=</span><span class="vs">r"$ CIx $"</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>), bbox_transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">$,$"</span> <span class="op">+</span> <span class="st">"$CIx$"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"CIx_</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tau_assym<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="побудова-графу-досліджуваного-ряду" class="level2" data-number="8.14">
<h2 data-number="8.14" class="anchored" data-anchor-id="побудова-графу-досліджуваного-ряду"><span class="header-section-number">8.14</span> Побудова графу досліджуваного ряду</h2>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>index_begin <span class="op">=</span> <span class="dv">500</span> <span class="co"># початковий індекс для графу</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>index_end <span class="op">=</span> <span class="dv">2000</span> <span class="co"># кінцевий індекс для графу</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>for_graph_plot <span class="op">=</span> time_ser_1.copy()</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ret_type <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">=</span> for_graph_plot.diff()</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">=</span> for_graph_plot.pct_change()</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">=</span> for_graph_plot.pct_change()</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">-=</span> for_graph_plot.mean()</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">/=</span> for_graph_plot.std()</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">5</span>: </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">=</span> for_graph_plot.pct_change()</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">-=</span> for_graph_plot.mean()</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">/=</span> for_graph_plot.std()</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">=</span> for_graph_plot.<span class="bu">abs</span>()</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">-=</span> for_graph_plot.mean()</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    for_graph_plot <span class="op">/=</span> for_graph_plot.std()</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>for_graph_plot <span class="op">=</span> for_graph_plot.copy().dropna().values</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>date <span class="op">=</span> date_in_num[index_begin:index_end] <span class="co"># вилучаємо необхідні по індексам дати</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="co"># будуємо граф у залежності від типу графа</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> graph_type <span class="op">==</span> <span class="st">'classic'</span>:</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> NaturalVG(directed<span class="op">=</span><span class="va">None</span>).build(for_graph_plot[index_begin:index_end], xs<span class="op">=</span>date)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> g.node_positions()</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    nxg <span class="op">=</span> g.as_networkx()</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> graph_type <span class="op">==</span> <span class="st">'horizontal'</span>:</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> HorizontalVG(directed<span class="op">=</span><span class="va">None</span>).build(for_graph_plot[index_begin:index_end], xs<span class="op">=</span>date)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> g.node_positions()</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    nxg <span class="op">=</span> g.as_networkx()</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> recurrence_net(for_graph_plot[index_begin:index_end], </span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>                       rec_thr<span class="op">=</span>eps_rec <span class="op">*</span> np.<span class="bu">abs</span>(np.std(for_graph_plot[index_begin:index_end])), </span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>                       dim<span class="op">=</span>d_e_rec, </span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>                       tau<span class="op">=</span>tau_rec, </span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>                       dist_type<span class="op">=</span>dist_rec)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> node_positions_recurrence_net(for_graph_plot[index_begin:index_end], date)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>    nxg <span class="op">=</span> g</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a><span class="co"># встановлення параметрів для побудови графів</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>graph_plot_options <span class="op">=</span> {</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">'with_labels'</span>: <span class="va">False</span>,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">'node_size'</span>: <span class="dv">2</span>,</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">'node_color'</span>: [(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)],</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">'edge_color'</span>: [(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.15</span>)],</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="виводимо-звязки-видимості" class="level2" data-number="8.15">
<h2 data-number="8.15" class="anchored" data-anchor-id="виводимо-звязки-видимості"><span class="header-section-number">8.15</span> Виводимо зв’язки видимості</h2>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx(nxg, ax<span class="op">=</span>ax1, pos<span class="op">=</span>pos, <span class="op">**</span>graph_plot_options)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>ax1.tick_params(bottom<span class="op">=</span><span class="va">True</span>, labelbottom<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>ax1.plot(time_ser_1.index[index_begin:index_end], for_graph_plot[index_begin:index_end], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Visibility Connections'</span>, fontsize<span class="op">=</span><span class="dv">22</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(xlabel)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"Time_ser_connections_symbol=</span><span class="sc">{</span>name_2<span class="sc">}</span><span class="ss">_idx_beg=</span><span class="sc">{</span>index_begin<span class="sc">}</span><span class="ss">_idx_end=</span><span class="sc">{</span>index_end<span class="sc">}</span><span class="ss">_sertype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_network_type=</span><span class="sc">{</span>graph_type<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Виходячи з графу взятого нами фрагменту видно, що крах поблизу 1988 року характеризується високою концентрацією вузлів, які охоплюють проміжок до 1982 року. Це вказує на високий ступінь довготривалої пам’яті для кризових явищ фондового ринку, що в свою чергу впливає і на їх незворотність.</p>
</section>
<section id="виводимо-граф" class="level2" data-number="8.16">
<h2 data-number="8.16" class="anchored" data-anchor-id="виводимо-граф"><span class="header-section-number">8.16</span> Виводимо граф</h2>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(nxg,k<span class="op">=</span><span class="fl">0.15</span>,iterations<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># знаходимо вузол близький до центру графа (0.5,0.5)</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>dmin <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ncenter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> pos: </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> pos[n]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> (x <span class="op">-</span> <span class="fl">0.5</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (y <span class="op">-</span> <span class="fl">0.5</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> d <span class="op">&lt;</span> dmin:</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        ncenter <span class="op">=</span> n</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        dmin <span class="op">=</span> d</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># розфарбовуємо в залежності від ступеня вершини</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="bu">dict</span>(nx.degree(nxg))</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>fig, ax2 <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Graph representation'</span>, fontsize<span class="op">=</span><span class="dv">22</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_edges(nxg, ax<span class="op">=</span>ax2, pos<span class="op">=</span>pos, nodelist<span class="op">=</span>[ncenter], alpha<span class="op">=</span><span class="fl">0.4</span>,width<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_nodes(nxg, ax<span class="op">=</span>ax2, pos<span class="op">=</span>pos, nodelist<span class="op">=</span><span class="bu">list</span>(p.keys()),</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>                       node_size<span class="op">=</span><span class="dv">10</span>, edgecolors<span class="op">=</span><span class="st">'r'</span>, linewidths<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>                       node_color<span class="op">=</span><span class="bu">list</span>(p.values()),</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>                       cmap<span class="op">=</span>plt.cm.Blues_r)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>vmin <span class="op">=</span> np.asarray(<span class="bu">list</span>(p.values())).<span class="bu">min</span>()</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>vmax <span class="op">=</span> np.asarray(<span class="bu">list</span>(p.values())).<span class="bu">max</span>()</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>sm <span class="op">=</span> plt.cm.ScalarMappable(cmap<span class="op">=</span>plt.cm.Blues_r, norm<span class="op">=</span>plt.Normalize(vmin<span class="op">=</span>vmin, vmax<span class="op">=</span>vmax))</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>cb <span class="op">=</span> plt.colorbar(sm, ax<span class="op">=</span>ax2)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>cb.set_label(<span class="st">'degree'</span>)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"Graph_representation_symbol=</span><span class="sc">{</span>name_2<span class="sc">}</span><span class="ss">_idx_beg=</span><span class="sc">{</span>index_begin<span class="sc">}</span><span class="ss">_idx_end=</span><span class="sc">{</span>index_end<span class="sc">}</span><span class="ss">_sertype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_network_type=</span><span class="sc">{</span>graph_type<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="побудова-мір-незворотності-на-основі-пермутаційних-шаблонів-та-графів" class="level2" data-number="8.17">
<h2 data-number="8.17" class="anchored" data-anchor-id="побудова-мір-незворотності-на-основі-пермутаційних-шаблонів-та-графів"><span class="header-section-number">8.17</span> Побудова мір незворотності на основі пермутаційних шаблонів та графів</h2>
</section>
<section id="віконна-процедура" class="level2" data-number="8.18">
<h2 data-number="8.18" class="anchored" data-anchor-id="віконна-процедура"><span class="header-section-number">8.18</span> Віконна процедура</h2>
<section id="масив-для-збереження-результатів-розрахунків" class="level3" data-number="8.18.1">
<h3 data-number="8.18.1" class="anchored" data-anchor-id="масив-для-збереження-результатів-розрахунків"><span class="header-section-number">8.18.1</span> Масив для збереження результатів розрахунків</h3>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Degree <span class="op">=</span> []</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Clust <span class="op">=</span> []</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>Perm <span class="op">=</span> []</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="розрахунок-відповідних-мір-1" class="level3" data-number="8.18.2">
<h3 data-number="8.18.2" class="anchored" data-anchor-id="розрахунок-відповідних-мір-1"><span class="header-section-number">8.18.2</span> Розрахунок відповідних мір</h3>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    fragm_1 <span class="op">=</span> time_ser_1.iloc[i:i<span class="op">+</span>window].copy() <span class="co">#відбираємо фрагмент та в подальшому відбираємо потрібний тип ряду</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ret_type <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.diff()</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.pct_change()</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.pct_change()</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">-=</span> fragm_1.mean()</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">/=</span> fragm_1.std()</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">5</span>: </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.pct_change()</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">-=</span> fragm_1.mean()</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">/=</span> fragm_1.std()</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">=</span> fragm_1.<span class="bu">abs</span>()</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">-=</span> fragm_1.mean()</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>        fragm_1 <span class="op">/=</span> fragm_1.std()</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    fragm_1 <span class="op">=</span> fragm_1.dropna().values</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    deg, clust <span class="op">=</span> GraphIrrever(fragm_1, </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>                                    graph_type<span class="op">=</span>graph_type, </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>                                    delta<span class="op">=</span><span class="fl">1e-10</span>, </span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>                                    d_e_rec<span class="op">=</span>d_e_rec, </span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>                                    tau_rec<span class="op">=</span>tau_rec, </span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>                                    eps_rec<span class="op">=</span>eps_rec, </span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>                                    dist_rec<span class="op">=</span>dist_rec, </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>                                    distance_irr<span class="op">=</span>distance_irr)  </span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    perm <span class="op">=</span> PermIrrever(fragm_1, </span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>                          d_e<span class="op">=</span>d_e_perm, </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>                          tau<span class="op">=</span>tau_perm, </span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>                          delta<span class="op">=</span><span class="fl">1e-10</span>, </span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>                          distance_irr<span class="op">=</span>distance_irr)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    Degree.append(deg)</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    Clust.append(clust)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    Perm.append(perm)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="збереження-результатів-до-.txt-файлів" class="level3" data-number="8.18.3">
<h3 data-number="8.18.3" class="anchored" data-anchor-id="збереження-результатів-до-.txt-файлів"><span class="header-section-number">8.18.3</span> Збереження результатів до .txt файлів</h3>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"</span><span class="sc">{</span>distance_irr<span class="sc">}</span><span class="ss">_deg_symbol=</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ret_type=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_graph_type=</span><span class="sc">{</span>graph_type<span class="sc">}</span><span class="ss">.txt"</span>,Degree)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"</span><span class="sc">{</span>distance_irr<span class="sc">}</span><span class="ss">_clust_symbol=</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ret_type=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_graph_type=</span><span class="sc">{</span>graph_type<span class="sc">}</span><span class="ss">.txt"</span>,Clust)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"</span><span class="sc">{</span>distance_irr<span class="sc">}</span><span class="ss">_perm_symbol=</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ret_type=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_d_e=</span><span class="sc">{</span>d_e_perm<span class="sc">}</span><span class="ss">_tau=</span><span class="sc">{</span>tau_perm<span class="sc">}</span><span class="ss">.txt"</span>,Perm)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="виведення-ступеня-незворотності-на-основі-степені-вершини" class="level3" data-number="8.18.4">
<h3 data-number="8.18.4" class="anchored" data-anchor-id="виведення-ступеня-незворотності-на-основі-степені-вершини"><span class="header-section-number">8.18.4</span> Виведення ступеня незворотності на основі степені вершини</h3>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser_1.index[window:length:tstep], for_graph[window:length:tstep], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ax2.plot(time_ser_1.index[window:length:tstep], Degree, label<span class="op">=</span><span class="vs">r"$ Dist_</span><span class="sc">{deg}</span><span class="vs"> $"</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>), bbox_transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">$,$"</span> <span class="op">+</span> <span class="st">"$Dist_</span><span class="sc">{deg}</span><span class="st">$"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"</span><span class="sc">{</span>distance_irr<span class="sc">}</span><span class="ss">_Degree_symbol=</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ret_type=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_graph_type=</span><span class="sc">{</span>graph_type<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="виведення-ступеня-незворотності-на-основі-показника-локальної-кластеризації" class="level3" data-number="8.18.5">
<h3 data-number="8.18.5" class="anchored" data-anchor-id="виведення-ступеня-незворотності-на-основі-показника-локальної-кластеризації"><span class="header-section-number">8.18.5</span> Виведення ступеня незворотності на основі показника локальної кластеризації</h3>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser_1.index[window:length:tstep], for_graph[window:length:tstep], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>ax2.plot(time_ser_1.index[window:length:tstep], Clust, label<span class="op">=</span><span class="vs">r"$ Dist_</span><span class="sc">{clust}</span><span class="vs"> $"</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>), bbox_transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">$,$"</span> <span class="op">+</span> <span class="vs">r"$Dist_</span><span class="sc">{Clust}</span><span class="vs">$"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"</span><span class="sc">{</span>distance_irr<span class="sc">}</span><span class="ss">_Clust_symbol=</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ret_type=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_graph_type=</span><span class="sc">{</span>graph_type<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="виведення-ступеня-незворотності-на-основі-пермутаційних-шаблонів" class="level3" data-number="8.18.6">
<h3 data-number="8.18.6" class="anchored" data-anchor-id="виведення-ступеня-незворотності-на-основі-пермутаційних-шаблонів"><span class="header-section-number">8.18.6</span> Виведення ступеня незворотності на основі пермутаційних шаблонів</h3>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser_1.index[window:length:tstep], for_graph[window:length:tstep], label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>ax2.plot(time_ser_1.index[window:length:tstep], Perm, label<span class="op">=</span><span class="vs">r"$ Dist_{\pi} $"</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>), bbox_transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>name_2<span class="sc">.</span>split(<span class="st">'.'</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">$,$"</span> <span class="op">+</span> <span class="vs">r"$Dist_{\pi}$"</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"</span><span class="sc">{</span>distance_irr<span class="sc">}</span><span class="ss">_Perm_symbol=</span><span class="sc">{</span>name_1<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ret_type=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_d_e=</span><span class="sc">{</span>d_e_perm<span class="sc">}</span><span class="ss">_tau=</span><span class="sc">{</span>tau_perm<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_11_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="висновок" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Висновок</h1>
<p>У даній роботі було розглянуто показники незворотності (асиметрії) системи на основі діаграм Пуанкаре, графу видимості та пермутаційних шаблонів. Було продемонстровано побудову діграми Пуанкаре та зв’язків видимості як для всього ряду так і для деяких із його фрагментів. Видно, що значення на діаграмі Пуанкаре характеризуються розподілом точок, що виходять за межі нормального Гаусового розподілу. Для графу видимості видно, що кризові стани характеризуються значною концентрацією зв’язків, що є довгостроковими. Граф прибутковостей виглядає рівномірнорозподіленим. Таким чином, поставало актуальним проводити розрахунок показників незворотності графового типу для вихідного ряду.</p>
<p>Показники на основі діаграми Пуанкаре демонструють зріст або спад у кризові періоди, що вказує на зростання асиметрії у даний період часу. Дані показники можуть слугувати в якості індикаторів кризових явищ.</p>
<p>Виходячи з 3 показників незворотності, що представлені вище, видно, що дані показники починають зростати в передкризовий період, вказуючи на стартовий період хаосу. Найгірше серед них себе поводить $ Dist_{deg} $. Найращим чином $ Dist_{clust} $ та $ Dist_{perm} $. Їх і варто використовувати в якості індикаторів-передвісників крахів.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопійовано!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопійовано!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lab_6.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 6</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab_12.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Лабораторна робота № 12</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>