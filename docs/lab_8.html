<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Моделювання складних систем у Python - 8&nbsp; Дослідження процесів самоорганізації в складних системах із використання теорії випадкових матриць</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab_11.html" rel="next">
<link href="./lab_7.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Пошук не дав результату",
    "search-matching-documents-text": "Результати пошуку",
    "search-copy-link-title": "Скопіюйте посилання для пошуку",
    "search-hide-matches-text": "Приховати додаткові результати",
    "search-more-match-text": "Додатковий результат у цьому документі",
    "search-more-matches-text": "Додаткові результати у цьому документі",
    "search-clear-button-title": "Очистити",
    "search-detached-cancel-button-title": "Скасувати",
    "search-submit-button-title": "Надіслати",
    "search-label": "Поиск"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lab_8.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Дослідження процесів самоорганізації в складних системах із використання теорії випадкових матриць</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Моделювання складних систем у Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Butman2099/Complex-systems-book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Переключить темный режим"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Поиск"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Передмова</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Лабораторна робота № 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Лабораторна робота № 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Лабораторна робота № 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Лабораторна робота № 4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Лабораторна робота № 5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Лабораторна робота № 6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 7</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_8.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Дослідження процесів самоорганізації в складних системах із використання теорії випадкових матриць</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Лабораторна робота № 11</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Лабораторна робота № 12</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Додатки</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Інструкція зі встановлення Anaconda Navigator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Вступ до мови програмування Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Основи Jupyter Notebook</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Зміст</h2>
   
  <ul>
  <li><a href="#теоретичні-відомості" id="toc-теоретичні-відомості" class="nav-link active" data-scroll-target="#теоретичні-відомості"><span class="header-section-number">8.1</span> Теоретичні відомості</a>
  <ul class="collapse">
  <li><a href="#знаходження-коефіцієнтів-матриці-крос-кореляцій" id="toc-знаходження-коефіцієнтів-матриці-крос-кореляцій" class="nav-link" data-scroll-target="#знаходження-коефіцієнтів-матриці-крос-кореляцій"><span class="header-section-number">8.1.1</span> Знаходження коефіцієнтів матриці крос-кореляцій</a></li>
  <li><a href="#розподіл-власних-значень" id="toc-розподіл-власних-значень" class="nav-link" data-scroll-target="#розподіл-власних-значень"><span class="header-section-number">8.1.2</span> Розподіл власних значень</a></li>
  <li><a href="#обернене-відношення-участі" id="toc-обернене-відношення-участі" class="nav-link" data-scroll-target="#обернене-відношення-участі"><span class="header-section-number">8.1.3</span> Обернене відношення участі</a></li>
  </ul></li>
  <li><a href="#хід-роботи" id="toc-хід-роботи" class="nav-link" data-scroll-target="#хід-роботи"><span class="header-section-number">8.2</span> Хід роботи</a>
  <ul class="collapse">
  <li><a href="#знаходження-коефіцієнтів-матриці-крос-кореляцій-1" id="toc-знаходження-коефіцієнтів-матриці-крос-кореляцій-1" class="nav-link" data-scroll-target="#знаходження-коефіцієнтів-матриці-крос-кореляцій-1"><span class="header-section-number">8.2.1</span> Знаходження коефіцієнтів матриці крос-кореляцій</a></li>
  <li><a href="#розподіл-власних-значень-та-векторів" id="toc-розподіл-власних-значень-та-векторів" class="nav-link" data-scroll-target="#розподіл-власних-значень-та-векторів"><span class="header-section-number">8.2.2</span> Розподіл власних значень та векторів</a></li>
  <li><a href="#обернене-відношення-участі-1" id="toc-обернене-відношення-участі-1" class="nav-link" data-scroll-target="#обернене-відношення-участі-1"><span class="header-section-number">8.2.3</span> Обернене відношення участі</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/Butman2099/Complex-systems-book/blob/main/lab_8.ipynb" class="toc-action">Редагувати сторінку</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Дослідження процесів самоорганізації в складних системах із використання теорії випадкових матриць</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>Мета.</strong> Навчитись використовувати методи теорії випадкових матриць для отримання «прихованої» інформації в складних економічних системах.</p>
<section id="теоретичні-відомості" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="теоретичні-відомості"><span class="header-section-number">8.1</span> Теоретичні відомості</h2>
<p>Вивчення статистичних властивостей матриць з незалежними випадковими елементами — випадкових матриць — має багату історію, що починається з ядерної фізики, де проблема з’явилася 50 років тому при дослідженні енергетичних рівнів складних ядер, що існуючі на той час моделі були не в змозі пояснити. Теорія випадкової матриці (ТВМ) була розвинена в цьому контексті Вігнером (Wigner), Дайсоном (Dyson), Метою (Mehta) та іншими для пояснення статистики рівнів енергії складних квантових систем. Дослідники постулювали, що функція Гамільтона, яка описує важкі ядра, може бути задана матрицею <span class="math inline">\(H\)</span> з незалежними випадковими елементами <span class="math inline">\(H_{ij}\)</span>, отриманими з розподілу імовірності. Відштовхуючись від цього припущення було зроблено низку вражаючих передбачень, які було підтверджено експериментально. Для складних квантових систем передбачення на основі ТВМ представляють середнє за всіма можливими взаємодіями. Відхилення від універсальних передбачень ТВМ відображують системну специфіку, невипадкові властивості системи, забезпечуючи ключові підходи до розуміння базової взаємодії системи. Недавні дослідження, що використовували методи аналізу ТВМ до аналізу властивостей матриці взаємних кореляцій <span class="math inline">\(C\)</span>, показують, що близько 98% власних значень матриці C співпадають зі значеннями, отримуваними з використанням ТВМ, таким чином пропонуючи задовільний рівень хаотичності у вимірюваних крос-кореляціях. Також було знайдено, що існують відхилення від передбачень за допомогою ТВМ у близько 2% найбільших власних значень. Ці результати викликають наступні питання:</p>
<ol type="1">
<li>Яка можлива інтерпретація для відхилень від ТВМ?</li>
<li>Що можна сказати про структуру C з цих результатів?</li>
<li>Яке практичне значення отриманих результатів?</li>
</ol>
<p>Шляхом комп’ютерного моделювання виявлено, що найбільше власне значення матриці <span class="math inline">\(C\)</span> представляє вплив усього ринку, що є звичайним для всіх акцій. Аналіз змісту власних значень, що відхиляються від ТВМ, показує існування взаємних кореляцій між акціями того ж самого типу промисловості, найбільш капіталізованими акціями, і акціями фірм, що мають бізнес у певному географічному секторі (локалізовані територіально). Обчислюючи скалярний добуток власних векторів від одного періоду часу до наступного, можна побачити, що “власні вектори, що відхиляються”, мають різні ступені стабільності в часі, визначеному кількісно величиною скалярного добутку. Найбільші два-три власних вектори стійкі протягом тривалих періодів часу, у той час як для іншої частини власних векторів, що відхиляються, стабільність у часі зменшується як тільки відповідні власні значення наближаються до верхньої межі ТВМ.</p>
<section id="знаходження-коефіцієнтів-матриці-крос-кореляцій" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="знаходження-коефіцієнтів-матриці-крос-кореляцій"><span class="header-section-number">8.1.1</span> Знаходження коефіцієнтів матриці крос-кореляцій</h3>
<p>Визначення кореляцій між різними акціями — тема, цікава не лише з точки зору наукових причин розуміння економіки як складної динамічної системи, але також і з практичних поглядів, зокрема, з точки зору розміщення активів і оцінки портфельного ризику. Ми будемо аналізувати взаємні кореляції між акціями, застосовуючи поняття і методи теорії випадкових матриць, що використовуються в контексті складних квантових систем, де точний характер взаємодій між підодиницями невідомий.</p>
<p>Для визначення кількісно кореляцій спочатку обчислюється зміна цін (прибутковості) акції <span class="math inline">\(i=1,...,N\)</span> за час <span class="math inline">\(\Delta t\)</span>,</p>
<p><span id="eq-8-1"><span class="math display">\[
G_{i}(t) = \ln S_i(t+\Delta t) - \ln S_i(t),
\tag{8.1}\]</span></span></p>
<p>де <span class="math inline">\(S_i(t)\)</span> позначає ціну акції <span class="math inline">\(i\)</span>. Оскільки різні ціни мають різні рівні змінюванності (стандартні відхилення), визначатимемо стандартизовану прибутковість</p>
<p><span id="eq-8-2"><span class="math display">\[
g_i(t) \equiv \frac{G_i(t) - \left\langle G_i \right\rangle}{\sigma_i},
\tag{8.2}\]</span></span></p>
<p>де <span class="math inline">\(\sigma_i \equiv \sqrt{\left\langle G_{i}^{2} \right\rangle - \left\langle G_i \right\rangle^{2}}\)</span> — стандартне відхилення <span class="math inline">\(G_i\)</span>, а <span class="math inline">\(\left\langle...\right\rangle\)</span> позначає середнє значення за досліджуваний період часу. Тобі обчислення кореляцій <span class="math inline">\(C\)</span> зводиться до обчислення формули:</p>
<p><span id="eq-8-3"><span class="math display">\[
C_{ij} \equiv \left\langle g_i(t)g_j(t) \right\rangle.
\tag{8.3}\]</span></span></p>
<p>Згідно з побудовою елементи <span class="math inline">\(C_{ij}\)</span> обмежені областю <span class="math inline">\(−1 \leq C_{ij} \leq 1\)</span>, де <span class="math inline">\(C_{ij} = 1\)</span> відповідає повним кореляціям, <span class="math inline">\(C_{ij} = -1\)</span> — повним антикореляціям, і <span class="math inline">\(C_{ij} = 0\)</span> свідчить про некорельованність пар акцій.</p>
<p>Труднощі в аналізі важливості та значення коефіцієнтів крос-кореляції <span class="math inline">\(C_{ij}\)</span> виникають внаслідок кількох причин, що полягають в наступному:</p>
<ol type="1">
<li>ринкові умови з часом змінюються і взаємна кореляція, що існує між будь-якою парою акцій, може бути не постійною (нестаціонарною);</li>
<li>скінчена довжина досліджуваного ряду, доступного для оцінювання взаємних кореляцій, додає так званий “шум вимірювання” — чим коротший досліджуваний ряд — тим менш точними будуть отримувані значення.</li>
</ol>
<p>Якщо буде використано довгий ряд для вилучення проблеми скінченної довжини, на отримані значення буде впливати нестаціонарність крос-кореляцій. З цих причин, емпірично виміряні крос-кореляції будуть містити “випадкові” складові, і найбільш важливою (і одночасно важкою проблемою) є оцінка в складі матриці <span class="math inline">\(C\)</span> таких взаємних кореляцій, що не є результатом випадковості.</p>
<p>Яким же чином можна виділяти з <span class="math inline">\(C_{ij}\)</span> ті акції, що залишилися корельованими на розглядуваному періоді часу? Щоб відповісти на це питання, перевіримо статистику <span class="math inline">\(C\)</span> у порівнянні із так званою “нульовою гіпотезою” випадкової кореляційної матриці — матриці кореляцій, побудованої із взаємно некорельованих часових рядів. Якщо властивості <span class="math inline">\(C\)</span> відповідають властивостям для випадкової матриці кореляцій, тоді можна говорити про те, що значення емпірично вимірюваних властивостей <span class="math inline">\(C\)</span> випадкові. Навпаки, відхилення властивостей <span class="math inline">\(C\)</span> від таких же властивостей для випадкової кореляційної матриці передає інформацію про “справжні” кореляції. Таким чином, нашою метою є порівняння властивостей <span class="math inline">\(C\)</span> з такими ж властивостями випадкової матриці кореляцій і розділ властивостей <span class="math inline">\(C\)</span> на дві групи: (a) частина <span class="math inline">\(C\)</span>, що відповідає властивостям випадкової кореляційної матриці (“шум”) і (b) частина <span class="math inline">\(C\)</span>, що відхиляється (“інформація”).</p>
</section>
<section id="розподіл-власних-значень" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="розподіл-власних-значень"><span class="header-section-number">8.1.2</span> Розподіл власних значень</h3>
<p>Для отримання інформації про взаємні кореляції <span class="math inline">\(C\)</span> необхідно порівняти властивості <span class="math inline">\(C\)</span> з такими ж властивостями випадкової матриці крос-кореляцій. У матричній нотації така матриця може бути виражена як</p>
<p><span id="eq-8-4"><span class="math display">\[
C = \frac{1}{L} GG^{T},
\tag{8.4}\]</span></span></p>
<p>де <span class="math inline">\(G\)</span> — матриця розміру <span class="math inline">\(N \times L\)</span> з елементами <span class="math inline">\(g_{im}=g_i(m\Delta t), i=1,...,N; m=0,...,L-1\)</span> і <span class="math inline">\(G^{T}\)</span> позначає транспонування <span class="math inline">\(G\)</span>. Розглянемо випадкову кореляційну матрицю</p>
<p><span id="eq-8-5"><span class="math display">\[
R = \frac{1}{L} AA^{T},
\tag{8.5}\]</span></span></p>
<p>де <span class="math inline">\(A\)</span> — матриця розміру <span class="math inline">\(N \times L\)</span>, що містить <span class="math inline">\(N\)</span> часових рядів із <span class="math inline">\(L\)</span> випадковими елементів <span class="math inline">\(a_{im}\)</span> з нульовим середнім і одиничним відхиленням, що означають взаємну некорельованість.</p>
<p>Статистичні властивості випадкових матриць <span class="math inline">\(R\)</span> відомі. Зокрема, у наближенні <span class="math inline">\(N \to \infty\)</span>, <span class="math inline">\(L \to \infty\)</span>, такому, що <span class="math inline">\(Q \equiv \frac{L}{N}(&gt;1)\)</span> фіксоване, показано аналітично, що функція розподілу щільності імовірності <span class="math inline">\(P_{rm}(\lambda)\)</span> власних значень <span class="math inline">\(\lambda\)</span> випадкової матриці кореляції <span class="math inline">\(R\)</span> визначається як</p>
<p><span id="eq-8-6"><span class="math display">\[
P_{rm}(\lambda) = \frac{Q}{2\pi}\frac{\sqrt{(\lambda_{+} - \lambda)(\lambda - \lambda_{-})}}{\lambda}
\tag{8.6}\]</span></span></p>
<p>де <span class="math inline">\(\lambda\)</span> в межах границь <span class="math inline">\(\lambda_{-} \leq \lambda_{i} \leq \lambda_{+}\)</span>, де <span class="math inline">\(\lambda_{-}\)</span> і <span class="math inline">\(\lambda_{+}\)</span> — найменше та найбільше власні значення <span class="math inline">\(R\)</span>, які можна визначити аналітично як</p>
<p><span id="eq-8-7"><span class="math display">\[
\lambda_{\pm} = 1 + \frac{1}{Q} \pm 2\sqrt{\frac{1}{Q}}.
\tag{8.7}\]</span></span></p>
<p>Звертаємо вашу увагу, що вираз (<a href="#eq-8-6">Рівняння&nbsp;<span>8.6</span></a>) є точним для випадку розподілених за Гаусом матричних елементів <span class="math inline">\(a_{im}\)</span>.</p>
<p>Порівняємо розподіл власних значень <span class="math inline">\(P(\lambda)\)</span> для <span class="math inline">\(C\)</span> з <span class="math inline">\(P_{rm}(\lambda)\)</span>. Для цього обчислимо власні значення <span class="math inline">\(\lambda_i\)</span> матриці <span class="math inline">\(C\)</span>, причому <span class="math inline">\(\lambda_i\)</span> впорядкуємо за зростанням (<span class="math inline">\(\lambda_{i+1} &gt; \lambda_{i}\)</span>). При дослідженнях зверніть увагу на присутність чіткої “великої частини” власних значень, що спадають у межах границь <span class="math inline">\([\lambda_{-}, \lambda_{+}]\)</span> для <span class="math inline">\(P_{rm}(\lambda)\)</span>. Також зверніть увагу на відхилення для деяких найбільших і найменших власних значень власних значень отриманих за допомогою ТВМ.</p>
<p>Оскільки рівняння (<a href="#eq-8-6">Рівняння&nbsp;<span>8.6</span></a>) є таким, що строго відповідає лише для <span class="math inline">\(L \to \infty\)</span> і <span class="math inline">\(N \to \infty\)</span>, необхідно перевірити також відхилення від ідеального випадку, оскільки робота проводиться завжди із <strong>скінченими</strong> рядами. При дослідженнях виявляється, що для кількох найбільших (найменших) власних значень ефект впливу скінчених величин <span class="math inline">\(L\)</span> і <span class="math inline">\(N\)</span> відсутній.</p>
</section>
<section id="обернене-відношення-участі" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="обернене-відношення-участі"><span class="header-section-number">8.1.3</span> Обернене відношення участі</h3>
<p>Вивчивши інтерпретацію найбільшого власного значення, що значно відхиляється від результатів ТВМ, зосередимось на власних значеннях, що залишаються. Відхилення розподілу компонентів власного вектора <span class="math inline">\(u_k\)</span> від ТВМ Гаусового передбачення більш явне, коли відстань від верхньої границі ТВМ <span class="math inline">\(\lambda_k --- \lambda_{+}\)</span> збільшується. Оскільки близькість до <span class="math inline">\(\lambda_{+}\)</span> збільшує ефекти хаотичності визначаємо кількість компонентів, що беруть значну участь в кожному власному векторі, що, у свою чергу, відображає ступінь відхилення від ТВМ для розподілу компонентів власного вектора. Для цього використовується поняття оберненого відношення участі (ОВУ), що часто застосовується в теорії локалізації. ОВУ власного вектора <span class="math inline">\(u_k\)</span> визначається як</p>
<p><span id="eq-8-8"><span class="math display">\[
I^{k} \equiv \sum_{l=1}^{N}\left[ u_{l}^{k} \right]^4,
\tag{8.8}\]</span></span></p>
<p>де <span class="math inline">\(u_{l}^{k}\)</span>, <span class="math inline">\(l=1,...,N\)</span> — компоненти власного вектора <span class="math inline">\(u^{k}\)</span>. Значення <span class="math inline">\(I^{k}\)</span> може бути проілюстровано двома граничними випадками:</p>
<ol type="1">
<li>вектор з ідентичними компонентами <span class="math inline">\(u_{l}^{k} \equiv \frac{1}{\sqrt{N}}\)</span> має <span class="math inline">\(I^{k}=\frac{1}{N}\)</span>;<br>
</li>
<li>вектор з одним компонентом <span class="math inline">\(u_{1}^{k}=1\)</span> і нульовими іншими має <span class="math inline">\(I^{k}=1\)</span>.</li>
</ol>
<p>Таким чином, ОВУ визначає кількість даних з числа компонентів власного вектора, що значний впливають на ринок, заданий системою часових рядів. Наявність векторів з великими значеннями <span class="math inline">\(I^{k}\)</span> також виникає в теорії локалізації Андерсона. У контексті теорії локалізації часто знаходять “випадкову смугу матриць”, що містять узагальнені стани з маленьким <span class="math inline">\(I^{k}\)</span> в більшій частині спектра власних значень, тоді як основні стани локалізовані і мають великі <span class="math inline">\(I^{k}\)</span>. Виявлення локалізованих станів для маленьких і великих власних значень матриці крос-кореляцій <span class="math inline">\(C\)</span> нагадує про локалізацію Андерсона і припускає, що C може мати випадкову зону матричної структури.</p>
</section>
</section>
<section id="хід-роботи" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="хід-роботи"><span class="header-section-number">8.2</span> Хід роботи</h2>
<p>Імпортуємо необхідні бібліотеки:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.gridspec <span class="im">as</span> gridspec</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scienceplots</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Визначаємо стиль рисунків:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plt.style.use([<span class="st">'science'</span>, <span class="st">'notebook'</span>, <span class="st">'grid'</span>]) <span class="co"># стиль, що використовуватиметься</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                                               <span class="co"># для виведення рисунків</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: (<span class="dv">8</span>, <span class="dv">6</span>),         <span class="co"># встановлюємо ширину та висоту рисунків за замовчуванням</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: <span class="dv">22</span>,                  <span class="co"># розмір фонтів рисунку</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lines.linewidth'</span>: <span class="dv">2</span>,             <span class="co"># товщина ліній</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.titlesize'</span>: <span class="st">'small'</span>,        <span class="co"># розмір титулки над рисунком</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"font.family"</span>: <span class="st">"sans-serif"</span>,      <span class="co"># сімейство стилів підписів </span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"font.serif"</span>: [<span class="st">"Times"</span>],          <span class="co"># стиль підпису</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'savefig.dpi'</span>: <span class="dv">300</span>                <span class="co"># якість збережених зображень</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update(params)           <span class="co"># оновлення стилю згідно налаштувань</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виконуємо парсинг та фільтрацію заголовків акцій компаній:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'authority'</span>: <span class="st">'api.nasdaq.com'</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'accept'</span>: <span class="st">'application/json, text/plain, */*'</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'user-agent'</span>: <span class="st">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'origin'</span>: <span class="st">'https://www.nasdaq.com'</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sec-fetch-site'</span>: <span class="st">'same-site'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sec-fetch-mode'</span>: <span class="st">'cors'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sec-fetch-dest'</span>: <span class="st">'empty'</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'referer'</span>: <span class="st">'https://www.nasdaq.com/'</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'accept-language'</span>: <span class="st">'en-US,en;q=0.9'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> (</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'tableonly'</span>, <span class="st">'true'</span>),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'limit'</span>, <span class="st">'25'</span>),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'offset'</span>, <span class="st">'0'</span>),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'download'</span>, <span class="st">'true'</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> requests.get(<span class="st">'https://api.nasdaq.com/api/screener/stocks'</span>, headers<span class="op">=</span>headers, params<span class="op">=</span>params)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> r.json()[<span class="st">'data'</span>]</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data[<span class="st">'rows'</span>], columns<span class="op">=</span>data[<span class="st">'headers'</span>])</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>{<span class="st">'marketCap'</span>})</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">'symbol'</span>].<span class="bu">str</span>.contains(<span class="st">"\/|\.|\^"</span>)]</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">symbol</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">lastsale</th>
<th data-quarto-table-cell-role="th">netchange</th>
<th data-quarto-table-cell-role="th">pctchange</th>
<th data-quarto-table-cell-role="th">marketCap</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">ipoyear</th>
<th data-quarto-table-cell-role="th">volume</th>
<th data-quarto-table-cell-role="th">sector</th>
<th data-quarto-table-cell-role="th">industry</th>
<th data-quarto-table-cell-role="th">url</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A</td>
<td>Agilent Technologies Inc. Common Stock</td>
<td>$103.68</td>
<td>-1.96</td>
<td>-1.855%</td>
<td>30335448465.00</td>
<td>United States</td>
<td>1999</td>
<td>2255378</td>
<td>Industrials</td>
<td>Electrical Products</td>
<td>/market-activity/stocks/a</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>AA</td>
<td>Alcoa Corporation Common Stock</td>
<td>$23.86</td>
<td>0.42</td>
<td>1.792%</td>
<td>4257807575.00</td>
<td>United States</td>
<td>2016</td>
<td>4466232</td>
<td>Industrials</td>
<td>Aluminum</td>
<td>/market-activity/stocks/aa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>AAC</td>
<td>Ares Acquisition Corporation Class A Ordinary ...</td>
<td>$10.77</td>
<td>-0.01</td>
<td>-0.093%</td>
<td>760407880.00</td>
<td></td>
<td>2021</td>
<td>62409</td>
<td>Industrials</td>
<td>Metal Fabrications</td>
<td>/market-activity/stocks/aac</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>AACG</td>
<td>ATA Creativity Global American Depositary Shares</td>
<td>$1.02</td>
<td>-0.0089</td>
<td>-0.865%</td>
<td>32254613.00</td>
<td>China</td>
<td>2008</td>
<td>2205</td>
<td>Real Estate</td>
<td>Other Consumer Services</td>
<td>/market-activity/stocks/aacg</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>AACIW</td>
<td>Armada Acquisition Corp. I Warrant</td>
<td>$0.0869</td>
<td>-0.0011</td>
<td>-1.25%</td>
<td>0.00</td>
<td>United States</td>
<td>2021</td>
<td>1100</td>
<td>Finance</td>
<td>Blank Checks</td>
<td>/market-activity/stocks/aaciw</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Фільтруємо та сортуємо заголовків акцій за їх капіталізацією:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cust_filter(mkt_cap):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'M'</span> <span class="kw">in</span> mkt_cap:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">float</span>(mkt_cap[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">'B'</span> <span class="kw">in</span> mkt_cap:</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">float</span>(mkt_cap[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">*</span> <span class="dv">1000</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> mkt_cap <span class="op">==</span> <span class="st">''</span>:</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0.0</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">float</span>(mkt_cap[<span class="dv">1</span>:]) <span class="op">/</span> <span class="fl">1e6</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'marketCap'</span>] <span class="op">=</span> df[<span class="st">'marketCap'</span>].<span class="bu">apply</span>(cust_filter)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.sort_values(<span class="st">'marketCap'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">symbol</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">lastsale</th>
<th data-quarto-table-cell-role="th">netchange</th>
<th data-quarto-table-cell-role="th">pctchange</th>
<th data-quarto-table-cell-role="th">marketCap</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">ipoyear</th>
<th data-quarto-table-cell-role="th">volume</th>
<th data-quarto-table-cell-role="th">sector</th>
<th data-quarto-table-cell-role="th">industry</th>
<th data-quarto-table-cell-role="th">url</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>AAPL</td>
<td>Apple Inc. Common Stock</td>
<td>$171.13</td>
<td>-2.31</td>
<td>-1.332%</td>
<td>675486.122160</td>
<td>United States</td>
<td>1980</td>
<td>42331738</td>
<td>Technology</td>
<td>Computer Manufacturing</td>
<td>/market-activity/stocks/aapl</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2995</td>
<td>GOOG</td>
<td>Alphabet Inc. Class C Capital Stock</td>
<td>$126.83</td>
<td>-13.29</td>
<td>-9.485%</td>
<td>599199.470000</td>
<td>United States</td>
<td>2004</td>
<td>53289059</td>
<td>Technology</td>
<td>Computer Software: Programming Data Processing</td>
<td>/market-activity/stocks/goog</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2996</td>
<td>GOOGL</td>
<td>Alphabet Inc. Class A Common Stock</td>
<td>$125.74</td>
<td>-13.07</td>
<td>-9.416%</td>
<td>585455.660000</td>
<td>United States</td>
<td>2004</td>
<td>74470572</td>
<td>Technology</td>
<td>Computer Software: Programming Data Processing</td>
<td>/market-activity/stocks/googl</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4477</td>
<td>MSFT</td>
<td>Microsoft Corporation Common Stock</td>
<td>$340.64</td>
<td>10.11</td>
<td>3.059%</td>
<td>530874.714262</td>
<td>United States</td>
<td>1986</td>
<td>47823790</td>
<td>Technology</td>
<td>Computer Software: Prepackaged Software</td>
<td>/market-activity/stocks/msft</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">408</td>
<td>AMZN</td>
<td>Amazon.com Inc. Common Stock</td>
<td>$121.35</td>
<td>-7.21</td>
<td>-5.608%</td>
<td>252059.059095</td>
<td>United States</td>
<td>1997</td>
<td>64091789</td>
<td>Consumer Discretionary</td>
<td>Catalog/Specialty Distribution</td>
<td>/market-activity/stocks/amzn</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Визначаємо найпередовіші акцій за їх капіталізацією:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>top <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tickers_list <span class="op">=</span> df.iloc[:top][<span class="st">'symbol'</span>].tolist()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tickers_list[:<span class="dv">10</span>]</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>['AAPL', 'GOOG', 'GOOGL', 'MSFT', 'AMZN', 'ACN', 'JNJ', 'UNH', 'CRM', 'CVX']</code></pre>
</div>
</div>
<p>Зчитуємо дані з Yahoo Finance згідно створенного списку акцій:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> <span class="st">"2001-12-31"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> <span class="st">"2023-10-25"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> yf.download(tickers_list, start, end)[<span class="st">"Adj Close"</span>]</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>perc <span class="op">=</span> <span class="fl">15.0</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>min_count <span class="op">=</span>  <span class="bu">int</span>(((<span class="dv">100</span><span class="op">-</span>perc)<span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>data.shape[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.dropna(axis<span class="op">=</span><span class="dv">1</span>, thresh<span class="op">=</span>min_count)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">AAPL</th>
<th data-quarto-table-cell-role="th">ABEV</th>
<th data-quarto-table-cell-role="th">ABT</th>
<th data-quarto-table-cell-role="th">ACN</th>
<th data-quarto-table-cell-role="th">ADBE</th>
<th data-quarto-table-cell-role="th">ADI</th>
<th data-quarto-table-cell-role="th">ADM</th>
<th data-quarto-table-cell-role="th">AEP</th>
<th data-quarto-table-cell-role="th">AJG</th>
<th data-quarto-table-cell-role="th">ALGN</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">UMC</th>
<th data-quarto-table-cell-role="th">UNH</th>
<th data-quarto-table-cell-role="th">UNP</th>
<th data-quarto-table-cell-role="th">UPS</th>
<th data-quarto-table-cell-role="th">USB</th>
<th data-quarto-table-cell-role="th">VZ</th>
<th data-quarto-table-cell-role="th">WAB</th>
<th data-quarto-table-cell-role="th">WBA</th>
<th data-quarto-table-cell-role="th">WMT</th>
<th data-quarto-table-cell-role="th">XOM</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2001-12-31</td>
<td>0.331940</td>
<td>0.284807</td>
<td>14.984421</td>
<td>19.391699</td>
<td>15.452659</td>
<td>28.258896</td>
<td>8.876992</td>
<td>17.383923</td>
<td>17.229757</td>
<td>4.500000</td>
<td>...</td>
<td>5.445520</td>
<td>14.341557</td>
<td>9.328089</td>
<td>30.550997</td>
<td>10.333235</td>
<td>14.899984</td>
<td>5.713787</td>
<td>21.294720</td>
<td>38.050945</td>
<td>19.562269</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2002-01-02</td>
<td>0.353160</td>
<td>0.308827</td>
<td>15.008622</td>
<td>18.880259</td>
<td>15.845818</td>
<td>28.870066</td>
<td>8.765649</td>
<td>17.551651</td>
<td>16.954994</td>
<td>4.300000</td>
<td>...</td>
<td>5.502246</td>
<td>14.270626</td>
<td>9.262628</td>
<td>30.528564</td>
<td>10.145625</td>
<td>15.223347</td>
<td>5.709141</td>
<td>20.927788</td>
<td>38.381516</td>
<td>19.711603</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-03</td>
<td>0.357404</td>
<td>0.308827</td>
<td>15.022054</td>
<td>18.289566</td>
<td>16.462925</td>
<td>30.340626</td>
<td>8.672853</td>
<td>17.427837</td>
<td>16.635281</td>
<td>4.480000</td>
<td>...</td>
<td>5.655399</td>
<td>14.110528</td>
<td>9.603023</td>
<td>31.089142</td>
<td>10.194989</td>
<td>15.728803</td>
<td>5.685913</td>
<td>21.769201</td>
<td>38.335255</td>
<td>19.741465</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2002-01-04</td>
<td>0.359072</td>
<td>0.308827</td>
<td>14.995178</td>
<td>19.953571</td>
<td>17.866358</td>
<td>30.525229</td>
<td>8.351183</td>
<td>17.280088</td>
<td>16.395493</td>
<td>4.500000</td>
<td>...</td>
<td>5.604348</td>
<td>14.185517</td>
<td>9.819044</td>
<td>31.756222</td>
<td>10.387536</td>
<td>15.888925</td>
<td>5.690561</td>
<td>21.864094</td>
<td>38.083977</td>
<td>19.910711</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-07</td>
<td>0.347097</td>
<td>0.308827</td>
<td>14.890349</td>
<td>19.053135</td>
<td>17.995752</td>
<td>29.824961</td>
<td>8.307875</td>
<td>17.551651</td>
<td>15.915917</td>
<td>5.010000</td>
<td>...</td>
<td>5.485228</td>
<td>14.094323</td>
<td>9.807585</td>
<td>32.014091</td>
<td>10.362858</td>
<td>15.791589</td>
<td>5.597654</td>
<td>22.066544</td>
<td>37.945133</td>
<td>19.736490</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-10-18</td>
<td>175.839996</td>
<td>2.450000</td>
<td>95.559998</td>
<td>303.769989</td>
<td>557.869995</td>
<td>171.270004</td>
<td>74.519997</td>
<td>75.169998</td>
<td>234.339996</td>
<td>272.399994</td>
<td>...</td>
<td>7.400000</td>
<td>536.059998</td>
<td>205.919998</td>
<td>153.820007</td>
<td>33.369999</td>
<td>31.049999</td>
<td>101.660004</td>
<td>21.250000</td>
<td>161.539993</td>
<td>112.949997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023-10-19</td>
<td>175.460007</td>
<td>2.450000</td>
<td>95.440002</td>
<td>302.940002</td>
<td>555.739990</td>
<td>168.720001</td>
<td>73.839996</td>
<td>74.419998</td>
<td>231.029999</td>
<td>270.290009</td>
<td>...</td>
<td>7.550000</td>
<td>531.630005</td>
<td>210.330002</td>
<td>152.059998</td>
<td>32.750000</td>
<td>31.580000</td>
<td>100.080002</td>
<td>20.959999</td>
<td>160.770004</td>
<td>113.019997</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-10-20</td>
<td>172.880005</td>
<td>2.460000</td>
<td>96.779999</td>
<td>297.000000</td>
<td>540.960022</td>
<td>166.520004</td>
<td>72.849998</td>
<td>73.349998</td>
<td>227.570007</td>
<td>269.880005</td>
<td>...</td>
<td>7.430000</td>
<td>527.030029</td>
<td>211.339996</td>
<td>151.960007</td>
<td>30.930000</td>
<td>31.570000</td>
<td>99.699997</td>
<td>21.260000</td>
<td>158.759995</td>
<td>111.080002</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023-10-23</td>
<td>173.000000</td>
<td>2.450000</td>
<td>95.779999</td>
<td>294.940002</td>
<td>540.409973</td>
<td>163.869995</td>
<td>72.400002</td>
<td>73.349998</td>
<td>227.699997</td>
<td>265.720001</td>
<td>...</td>
<td>7.420000</td>
<td>521.570007</td>
<td>207.759995</td>
<td>148.160004</td>
<td>31.260000</td>
<td>31.389999</td>
<td>98.739998</td>
<td>21.959999</td>
<td>161.009995</td>
<td>109.449997</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-10-24</td>
<td>173.440002</td>
<td>2.500000</td>
<td>94.809998</td>
<td>296.089996</td>
<td>539.559998</td>
<td>164.929993</td>
<td>69.470001</td>
<td>74.739998</td>
<td>231.210007</td>
<td>265.459991</td>
<td>...</td>
<td>7.440000</td>
<td>525.000000</td>
<td>205.440002</td>
<td>149.320007</td>
<td>31.389999</td>
<td>34.299999</td>
<td>99.940002</td>
<td>21.370001</td>
<td>163.250000</td>
<td>108.389999</td>
</tr>
</tbody>
</table>

<p>5492 rows × 142 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.dropna(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">AAPL</th>
<th data-quarto-table-cell-role="th">ABEV</th>
<th data-quarto-table-cell-role="th">ABT</th>
<th data-quarto-table-cell-role="th">ACN</th>
<th data-quarto-table-cell-role="th">ADBE</th>
<th data-quarto-table-cell-role="th">ADI</th>
<th data-quarto-table-cell-role="th">ADM</th>
<th data-quarto-table-cell-role="th">AEP</th>
<th data-quarto-table-cell-role="th">AJG</th>
<th data-quarto-table-cell-role="th">ALGN</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">UMC</th>
<th data-quarto-table-cell-role="th">UNH</th>
<th data-quarto-table-cell-role="th">UNP</th>
<th data-quarto-table-cell-role="th">UPS</th>
<th data-quarto-table-cell-role="th">USB</th>
<th data-quarto-table-cell-role="th">VZ</th>
<th data-quarto-table-cell-role="th">WAB</th>
<th data-quarto-table-cell-role="th">WBA</th>
<th data-quarto-table-cell-role="th">WMT</th>
<th data-quarto-table-cell-role="th">XOM</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-11-19</td>
<td>0.836216</td>
<td>0.891186</td>
<td>13.159102</td>
<td>18.311184</td>
<td>28.898273</td>
<td>25.516338</td>
<td>13.569958</td>
<td>16.210627</td>
<td>15.971463</td>
<td>10.660000</td>
<td>...</td>
<td>2.426260</td>
<td>33.161335</td>
<td>10.805549</td>
<td>48.411308</td>
<td>16.340147</td>
<td>14.549393</td>
<td>9.954161</td>
<td>24.456373</td>
<td>37.230267</td>
<td>27.068447</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2004-11-22</td>
<td>0.929887</td>
<td>0.891186</td>
<td>13.196038</td>
<td>18.181520</td>
<td>29.717941</td>
<td>25.196583</td>
<td>13.628675</td>
<td>16.572975</td>
<td>15.960764</td>
<td>10.530000</td>
<td>...</td>
<td>2.386915</td>
<td>33.266834</td>
<td>10.863768</td>
<td>48.889122</td>
<td>16.428463</td>
<td>14.510458</td>
<td>10.188372</td>
<td>24.552650</td>
<td>37.520027</td>
<td>27.353210</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-11-23</td>
<td>0.928674</td>
<td>0.881304</td>
<td>13.005194</td>
<td>18.152706</td>
<td>30.322697</td>
<td>24.947168</td>
<td>13.700435</td>
<td>16.606346</td>
<td>16.030344</td>
<td>10.370000</td>
<td>...</td>
<td>2.393473</td>
<td>33.481903</td>
<td>10.882599</td>
<td>48.830856</td>
<td>16.555431</td>
<td>14.503373</td>
<td>10.075955</td>
<td>24.526987</td>
<td>37.499813</td>
<td>27.509014</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2004-11-24</td>
<td>0.970811</td>
<td>0.885795</td>
<td>13.048287</td>
<td>18.620935</td>
<td>30.422657</td>
<td>24.883221</td>
<td>13.811342</td>
<td>16.782764</td>
<td>16.383600</td>
<td>10.240000</td>
<td>...</td>
<td>2.413146</td>
<td>33.380447</td>
<td>10.874038</td>
<td>48.825005</td>
<td>16.505745</td>
<td>14.475060</td>
<td>10.118112</td>
<td>24.738817</td>
<td>37.398727</td>
<td>27.664825</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-11-26</td>
<td>0.978389</td>
<td>0.888490</td>
<td>13.109851</td>
<td>18.685766</td>
<td>30.317698</td>
<td>24.748922</td>
<td>13.843967</td>
<td>16.787535</td>
<td>16.394304</td>
<td>10.300000</td>
<td>...</td>
<td>2.354128</td>
<td>34.037830</td>
<td>10.856913</td>
<td>48.901012</td>
<td>16.527834</td>
<td>14.524616</td>
<td>10.207114</td>
<td>24.790161</td>
<td>37.277443</td>
<td>27.750805</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-10-09</td>
<td>178.990005</td>
<td>2.530000</td>
<td>96.227318</td>
<td>310.721283</td>
<td>529.289978</td>
<td>173.320007</td>
<td>73.900002</td>
<td>73.660004</td>
<td>233.110001</td>
<td>283.940002</td>
<td>...</td>
<td>7.090000</td>
<td>526.510010</td>
<td>204.300003</td>
<td>154.339996</td>
<td>32.009998</td>
<td>31.450001</td>
<td>103.370003</td>
<td>22.270000</td>
<td>155.839996</td>
<td>110.919998</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023-10-10</td>
<td>178.389999</td>
<td>2.600000</td>
<td>97.022911</td>
<td>311.029999</td>
<td>532.719971</td>
<td>175.970001</td>
<td>74.150002</td>
<td>74.230003</td>
<td>233.490005</td>
<td>286.510010</td>
<td>...</td>
<td>7.170000</td>
<td>524.239990</td>
<td>206.350006</td>
<td>155.550003</td>
<td>32.590000</td>
<td>31.760000</td>
<td>104.940002</td>
<td>22.379999</td>
<td>157.600006</td>
<td>110.449997</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-10-11</td>
<td>179.800003</td>
<td>2.600000</td>
<td>92.129997</td>
<td>312.540009</td>
<td>549.909973</td>
<td>174.919998</td>
<td>73.699997</td>
<td>75.279999</td>
<td>234.899994</td>
<td>277.519989</td>
<td>...</td>
<td>7.250000</td>
<td>524.130005</td>
<td>209.479996</td>
<td>155.300003</td>
<td>32.509998</td>
<td>31.459999</td>
<td>105.739998</td>
<td>22.600000</td>
<td>158.229996</td>
<td>106.489998</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023-10-12</td>
<td>180.710007</td>
<td>2.540000</td>
<td>90.190002</td>
<td>304.359985</td>
<td>559.630005</td>
<td>173.600006</td>
<td>72.769997</td>
<td>73.480003</td>
<td>233.440002</td>
<td>268.000000</td>
<td>...</td>
<td>7.210000</td>
<td>525.539978</td>
<td>207.990005</td>
<td>155.380005</td>
<td>32.259998</td>
<td>30.910000</td>
<td>104.010002</td>
<td>24.190001</td>
<td>158.949997</td>
<td>106.470001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-10-13</td>
<td>178.850006</td>
<td>2.550000</td>
<td>90.870003</td>
<td>301.829987</td>
<td>548.760010</td>
<td>171.070007</td>
<td>73.320000</td>
<td>74.470001</td>
<td>233.880005</td>
<td>265.989990</td>
<td>...</td>
<td>7.100000</td>
<td>539.400024</td>
<td>207.750000</td>
<td>155.080002</td>
<td>32.169998</td>
<td>30.670000</td>
<td>102.570000</td>
<td>23.250000</td>
<td>159.830002</td>
<td>109.870003</td>
</tr>
</tbody>
</table>

<p>4757 rows × 142 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.T</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">2004-11-19</th>
<th data-quarto-table-cell-role="th">2004-11-22</th>
<th data-quarto-table-cell-role="th">2004-11-23</th>
<th data-quarto-table-cell-role="th">2004-11-24</th>
<th data-quarto-table-cell-role="th">2004-11-26</th>
<th data-quarto-table-cell-role="th">2004-11-29</th>
<th data-quarto-table-cell-role="th">2004-11-30</th>
<th data-quarto-table-cell-role="th">2004-12-01</th>
<th data-quarto-table-cell-role="th">2004-12-02</th>
<th data-quarto-table-cell-role="th">2004-12-03</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">2023-10-02</th>
<th data-quarto-table-cell-role="th">2023-10-03</th>
<th data-quarto-table-cell-role="th">2023-10-04</th>
<th data-quarto-table-cell-role="th">2023-10-05</th>
<th data-quarto-table-cell-role="th">2023-10-06</th>
<th data-quarto-table-cell-role="th">2023-10-09</th>
<th data-quarto-table-cell-role="th">2023-10-10</th>
<th data-quarto-table-cell-role="th">2023-10-11</th>
<th data-quarto-table-cell-role="th">2023-10-12</th>
<th data-quarto-table-cell-role="th">2023-10-13</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">AAPL</td>
<td>0.836216</td>
<td>0.929887</td>
<td>0.928674</td>
<td>0.970811</td>
<td>0.978389</td>
<td>1.037351</td>
<td>1.016282</td>
<td>1.027499</td>
<td>0.988393</td>
<td>0.950046</td>
<td>...</td>
<td>173.750000</td>
<td>172.399994</td>
<td>173.660004</td>
<td>174.910004</td>
<td>177.490005</td>
<td>178.990005</td>
<td>178.389999</td>
<td>179.800003</td>
<td>180.710007</td>
<td>178.850006</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABEV</td>
<td>0.891186</td>
<td>0.891186</td>
<td>0.881304</td>
<td>0.885795</td>
<td>0.888490</td>
<td>0.888490</td>
<td>0.880405</td>
<td>0.880405</td>
<td>0.872140</td>
<td>0.872140</td>
<td>...</td>
<td>2.550000</td>
<td>2.500000</td>
<td>2.550000</td>
<td>2.490000</td>
<td>2.540000</td>
<td>2.530000</td>
<td>2.600000</td>
<td>2.600000</td>
<td>2.540000</td>
<td>2.550000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABT</td>
<td>13.159102</td>
<td>13.196038</td>
<td>13.005194</td>
<td>13.048287</td>
<td>13.109851</td>
<td>13.060599</td>
<td>12.915928</td>
<td>13.313013</td>
<td>13.442290</td>
<td>13.368418</td>
<td>...</td>
<td>95.202988</td>
<td>95.262657</td>
<td>95.123428</td>
<td>95.670395</td>
<td>96.346657</td>
<td>96.227318</td>
<td>97.022911</td>
<td>92.129997</td>
<td>90.190002</td>
<td>90.870003</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ACN</td>
<td>18.311184</td>
<td>18.181520</td>
<td>18.152706</td>
<td>18.620935</td>
<td>18.685766</td>
<td>18.685766</td>
<td>18.685766</td>
<td>19.312466</td>
<td>19.514151</td>
<td>19.463741</td>
<td>...</td>
<td>306.986786</td>
<td>304.965179</td>
<td>308.112122</td>
<td>308.380981</td>
<td>310.900543</td>
<td>310.721283</td>
<td>311.029999</td>
<td>312.540009</td>
<td>304.359985</td>
<td>301.829987</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ADBE</td>
<td>28.898273</td>
<td>29.717941</td>
<td>30.322697</td>
<td>30.422657</td>
<td>30.317698</td>
<td>30.357683</td>
<td>30.267721</td>
<td>30.782511</td>
<td>31.142366</td>
<td>31.467232</td>
<td>...</td>
<td>521.130005</td>
<td>507.029999</td>
<td>518.419983</td>
<td>516.440002</td>
<td>526.679993</td>
<td>529.289978</td>
<td>532.719971</td>
<td>549.909973</td>
<td>559.630005</td>
<td>548.760010</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VZ</td>
<td>14.549393</td>
<td>14.510458</td>
<td>14.503373</td>
<td>14.475060</td>
<td>14.524616</td>
<td>14.581252</td>
<td>14.595415</td>
<td>14.726393</td>
<td>14.839680</td>
<td>14.875080</td>
<td>...</td>
<td>31.096254</td>
<td>31.311655</td>
<td>30.880852</td>
<td>31.154999</td>
<td>30.850000</td>
<td>31.450001</td>
<td>31.760000</td>
<td>31.459999</td>
<td>30.910000</td>
<td>30.670000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">WAB</td>
<td>9.954161</td>
<td>10.188372</td>
<td>10.075955</td>
<td>10.118112</td>
<td>10.207114</td>
<td>9.977583</td>
<td>9.635630</td>
<td>9.523204</td>
<td>9.659050</td>
<td>9.354569</td>
<td>...</td>
<td>105.239998</td>
<td>104.500000</td>
<td>105.000000</td>
<td>102.099998</td>
<td>102.930000</td>
<td>103.370003</td>
<td>104.940002</td>
<td>105.739998</td>
<td>104.010002</td>
<td>102.570000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">WBA</td>
<td>24.456373</td>
<td>24.552650</td>
<td>24.526987</td>
<td>24.738817</td>
<td>24.790161</td>
<td>24.687454</td>
<td>24.507723</td>
<td>25.021250</td>
<td>24.982733</td>
<td>25.021250</td>
<td>...</td>
<td>22.420000</td>
<td>22.549999</td>
<td>22.290001</td>
<td>22.180000</td>
<td>21.809999</td>
<td>22.270000</td>
<td>22.379999</td>
<td>22.600000</td>
<td>24.190001</td>
<td>23.250000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">WMT</td>
<td>37.230267</td>
<td>37.520027</td>
<td>37.499813</td>
<td>37.398727</td>
<td>37.277443</td>
<td>35.815193</td>
<td>35.080688</td>
<td>35.592808</td>
<td>35.714092</td>
<td>35.666939</td>
<td>...</td>
<td>160.100006</td>
<td>159.089996</td>
<td>161.000000</td>
<td>159.080002</td>
<td>156.410004</td>
<td>155.839996</td>
<td>157.600006</td>
<td>158.229996</td>
<td>158.949997</td>
<td>159.830002</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">XOM</td>
<td>27.068447</td>
<td>27.353210</td>
<td>27.509014</td>
<td>27.664825</td>
<td>27.750805</td>
<td>27.600348</td>
<td>27.535883</td>
<td>27.482151</td>
<td>26.955626</td>
<td>27.009338</td>
<td>...</td>
<td>115.629997</td>
<td>115.830002</td>
<td>111.500000</td>
<td>108.989998</td>
<td>107.169998</td>
<td>110.919998</td>
<td>110.449997</td>
<td>106.489998</td>
<td>106.470001</td>
<td>109.870003</td>
</tr>
</tbody>
</table>

<p>142 rows × 4757 columns</p>
</div>
</div>
</div>
<section id="знаходження-коефіцієнтів-матриці-крос-кореляцій-1" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="знаходження-коефіцієнтів-матриці-крос-кореляцій-1"><span class="header-section-number">8.2.1</span> Знаходження коефіцієнтів матриці крос-кореляцій</h3>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>log_ret <span class="op">=</span> data.pct_change(axis<span class="op">=</span><span class="dv">1</span>).iloc[:,<span class="dv">1</span>:]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>log_ret <span class="op">=</span> log_ret.values</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>log_ret <span class="op">=</span> (log_ret <span class="op">-</span> np.mean(log_ret, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)) <span class="op">/</span> np.std(log_ret, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>N, T <span class="op">=</span> log_ret.shape</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>T)<span class="op">*</span>np.dot(log_ret, log_ret.T)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>di <span class="op">=</span> np.diag_indices(N)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ccoef <span class="op">=</span> np.ma.asarray(C)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ccoef[di] <span class="op">=</span> np.ma.masked</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ccoef_flat <span class="op">=</span> ccoef.compressed()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1234</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>random_stocks <span class="op">=</span> np.random.normal(size<span class="op">=</span>(N,T))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>T)<span class="op">*</span>np.dot(random_stocks, random_stocks.T)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>di_rand <span class="op">=</span> np.diag_indices(N)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ccoef_rand <span class="op">=</span> np.ma.asarray(R)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>ccoef_rand[di_rand] <span class="op">=</span> np.ma.masked</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>ccoef_flat_rand <span class="op">=</span> ccoef_rand.compressed()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> gridspec.GridSpec(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(C, cmap<span class="op">=</span><span class="st">'hot'</span>, interpolation<span class="op">=</span><span class="st">'nearest'</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>fig.colorbar(im1, ax<span class="op">=</span>ax1)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(R, cmap<span class="op">=</span><span class="st">'hot'</span>, interpolation<span class="op">=</span><span class="st">'nearest'</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>fig.colorbar(im2, ax<span class="op">=</span>ax2)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, :])</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>ax3.hist(ccoef_flat, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$P^</span><span class="sc">{init}</span><span class="vs">(C_</span><span class="sc">{ij}</span><span class="vs">)$'</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>ax3.hist(ccoef_flat_rand, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$P^</span><span class="sc">{rand}</span><span class="vs">(C_</span><span class="sc">{ij}</span><span class="vs">)$'</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="vs">r'$C_</span><span class="sc">{ij}</span><span class="vs">$'</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="vs">r'$P(C_</span><span class="sc">{ij}</span><span class="vs">)$'</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>fig.align_labels()</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_8_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="розподіл-власних-значень-та-векторів" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="розподіл-власних-значень-та-векторів"><span class="header-section-number">8.2.2</span> Розподіл власних значень та векторів</h3>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>w, v <span class="op">=</span> np.linalg.eig(C)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>w_rand, v_rand <span class="op">=</span> np.linalg.eig(R)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> T<span class="op">/</span>N</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lambda_plus <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>Q <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>np.sqrt(<span class="dv">1</span><span class="op">/</span>Q)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>lambda_minus <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>Q <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>np.sqrt(<span class="dv">1</span><span class="op">/</span>Q)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lambda_plus</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>1.3754407185513393</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lambda_minus</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>0.6245592814486605</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>lambda_random <span class="op">=</span> np.linspace(lambda_minus, lambda_plus, <span class="dv">1000</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> (Q<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))<span class="op">*</span>np.sqrt((lambda_plus<span class="op">-</span>lambda_random)<span class="op">*</span>(lambda_random<span class="op">-</span>lambda_minus))<span class="op">/</span>lambda_random</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>lambda_max <span class="op">=</span> w.<span class="bu">max</span>()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>lambda_max</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>57.18871610030752</code></pre>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">10</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(w, bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"skyblue"</span>, label<span class="op">=</span><span class="st">'$P^</span><span class="sc">{init}</span><span class="st">_{\it</span><span class="sc">{empiric}</span><span class="st">}$'</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(w_rand, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">'$P^</span><span class="sc">{rand}</span><span class="st">_{\it</span><span class="sc">{empiric}</span><span class="st">}$'</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'$\lambda_</span><span class="sc">{i}</span><span class="st">$'</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'$P(\lambda_</span><span class="sc">{i}</span><span class="st">)$'</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].text(<span class="dv">20</span>, <span class="fl">0.5</span>, <span class="st">'$\lambda_</span><span class="sc">{max}</span><span class="st">=$'</span><span class="op">+</span><span class="ss">f'</span><span class="sc">{</span>lambda_max<span class="sc">:.2f}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend()</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(w, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"skyblue"</span>, label<span class="op">=</span><span class="st">'$P^</span><span class="sc">{init}</span><span class="st">_{\it</span><span class="sc">{empiric}</span><span class="st">}$'</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(w_rand, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">'$P^</span><span class="sc">{rand}</span><span class="st">_{\it</span><span class="sc">{empiric}</span><span class="st">}$'</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'$\lambda_</span><span class="sc">{i}</span><span class="st">$'</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">'$P(\lambda_</span><span class="sc">{i}</span><span class="st">)$'</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlim(lambda_minus<span class="op">-</span><span class="dv">3</span><span class="op">*</span>np.std(w_rand), lambda_plus<span class="op">+</span><span class="dv">3</span><span class="op">*</span>np.std(w_rand))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].scatter(lambda_random, P, label<span class="op">=</span><span class="st">'$P_{\it</span><span class="sc">{RMT}</span><span class="st">}$'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].legend()</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_8_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(v[:,<span class="dv">0</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{init}</span><span class="vs">$'</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(v_rand[:,<span class="dv">0</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{rand}</span><span class="vs">$'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'$u_</span><span class="sc">{1}</span><span class="st">$'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'$P(u)$'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Eigenvector components of $ \lambda_</span><span class="sc">{1}</span><span class="st"> $'</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend()</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(v[:,<span class="dv">30</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{init}</span><span class="vs">$'</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(v_rand[:,<span class="dv">30</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{rand}</span><span class="vs">$'</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'$u_</span><span class="sc">{30}</span><span class="st">$'</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">'$P(u)$'</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Eigenvector components of $ \lambda_</span><span class="sc">{30}</span><span class="st"> $'</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].legend()</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].hist(v[:,<span class="dv">70</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{init}</span><span class="vs">$'</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].hist(v_rand[:,<span class="dv">70</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{rand}</span><span class="vs">$'</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">'$u_</span><span class="sc">{70}</span><span class="st">$'</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_ylabel(<span class="st">'$P(u)$'</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_title(<span class="st">'Eigenvector components of $ \lambda_</span><span class="sc">{70}</span><span class="st"> $'</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].legend()</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_8_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="обернене-відношення-участі-1" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="обернене-відношення-участі-1"><span class="header-section-number">8.2.3</span> Обернене відношення участі</h3>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>IPR <span class="op">=</span> np.<span class="bu">sum</span>(v<span class="op">**</span><span class="dv">4</span>, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>IPR_rand <span class="op">=</span> np.<span class="bu">sum</span>(v_rand<span class="op">**</span><span class="dv">4</span>, axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(w, IPR, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="vs">r'$IPR_{\it</span><span class="sc">{init}</span><span class="vs">}$'</span>, s<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">2</span>, marker<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>ax.scatter(w_rand, IPR_rand, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="vs">r'$IPR_{\it</span><span class="sc">{rand}</span><span class="vs">}$'</span>, s<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">2</span>, marker<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r'$\lambda_</span><span class="sc">{i}</span><span class="vs">$'</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$IPR$'</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span> </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab_8_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопійовано!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопійовано!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./lab_7.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 7</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab_11.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Лабораторна робота № 11</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>